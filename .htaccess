# 性能优化 - 缓存策略
# 设置静态资源的缓存头

# 图片文件缓存1年
<FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
    Header set Cache-Control "public, immutable, max-age=31536000"
    Header set Vary "Accept-Encoding"
</FilesMatch>

# CSS和JS文件缓存1个月
<FilesMatch "\.(css|js)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 month"
    Header set Cache-Control "public, max-age=2592000"
    Header set Vary "Accept-Encoding"
</FilesMatch>

# 字体文件缓存1年
<FilesMatch "\.(woff|woff2|ttf|eot)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
    Header set Cache-Control "public, immutable, max-age=31536000"
    Header set Vary "Accept-Encoding"
</FilesMatch>

# HTML文件缓存1小时
<FilesMatch "\.(html|htm)$">
    ExpiresActive On
    ExpiresDefault "access plus 1 hour"
    Header set Cache-Control "public, max-age=3600"
    Header set Vary "Accept-Encoding"
</FilesMatch>

# 优化资源提示
<FilesMatch "\.(html|htm)$">
    Header add Link "</assets/main-D62YCris.css>; rel=preload; as=style"
    Header add Link "</assets/main-zDHBVADl.js>; rel=preload; as=script"
    Header add Link "</assets/fontawesome-webfont-B-jkhYfk.woff2>; rel=preload; as=font; type=font/woff2; crossorigin"
</FilesMatch>

# 启用Gzip压缩
<IfModule mod_deflate.c>
    # 压缩HTML, CSS, JavaScript, Text, XML和字体
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
</IfModule>

# 启用Brotli压缩（如果支持）
<IfModule mod_brotli.c>
    AddOutputFilterByType BROTLI_COMPRESS text/plain
    AddOutputFilterByType BROTLI_COMPRESS text/css
    AddOutputFilterByType BROTLI_COMPRESS text/xml
    AddOutputFilterByType BROTLI_COMPRESS text/javascript
    AddOutputFilterByType BROTLI_COMPRESS application/javascript
    AddOutputFilterByType BROTLI_COMPRESS application/xml
    AddOutputFilterByType BROTLI_COMPRESS application/xhtml+xml
    AddOutputFilterByType BROTLI_COMPRESS application/rss+xml
    AddOutputFilterByType BROTLI_COMPRESS application/atom+xml
    AddOutputFilterByType BROTLI_COMPRESS image/svg+xml
</IfModule>

# 安全头
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# 预加载关键资源
<IfModule mod_headers.c>
    <FilesMatch "\.html$">
        Header add Link "</assets/main-D62YCris.css>; rel=preload; as=style"
        Header add Link "</assets/main-zDHBVADl.js>; rel=preload; as=script"
    </FilesMatch>
</IfModule>
