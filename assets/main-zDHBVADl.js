var fd=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var N0=fd((Bf,Ji)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();/*! jQuery v3.5.1 | (c) JS Foundation and other contributors | jquery.org/license */(function(t,e){typeof Ji=="object"&&typeof Ji.exports=="object"?Ji.exports=t.document?e(t,!0):function(n){if(!n.document)throw new Error("jQuery requires a window with a document");return e(n)}:e(t)})(typeof window<"u"?window:void 0,function(t,e){var n=[],i=Object.getPrototypeOf,r=n.slice,s=n.flat?function(c){return n.flat.call(c)}:function(c){return n.concat.apply([],c)},o=n.push,a=n.indexOf,u={},l=u.toString,d=u.hasOwnProperty,h=d.toString,g=h.call(Object),m={},y=function(c){return typeof c=="function"&&typeof c.nodeType!="number"},w=function(c){return c!=null&&c===c.window},M=t.document,_={type:!0,src:!0,nonce:!0,noModule:!0};function v(c,f,x){var b,S,T=(x=x||M).createElement("script");if(T.text=c,f)for(b in _)(S=f[b]||f.getAttribute&&f.getAttribute(b))&&T.setAttribute(b,S);x.head.appendChild(T).parentNode.removeChild(T)}function E(c){return c==null?c+"":typeof c=="object"||typeof c=="function"?u[l.call(c)]||"object":typeof c}var R="3.5.1",p=function(c,f){return new p.fn.init(c,f)};function A(c){var f=!!c&&"length"in c&&c.length,x=E(c);return!y(c)&&!w(c)&&(x==="array"||f===0||typeof f=="number"&&0<f&&f-1 in c)}p.fn=p.prototype={jquery:R,constructor:p,length:0,toArray:function(){return r.call(this)},get:function(c){return c==null?r.call(this):c<0?this[c+this.length]:this[c]},pushStack:function(c){var f=p.merge(this.constructor(),c);return f.prevObject=this,f},each:function(c){return p.each(this,c)},map:function(c){return this.pushStack(p.map(this,function(f,x){return c.call(f,x,f)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(p.grep(this,function(c,f){return(f+1)%2}))},odd:function(){return this.pushStack(p.grep(this,function(c,f){return f%2}))},eq:function(c){var f=this.length,x=+c+(c<0?f:0);return this.pushStack(0<=x&&x<f?[this[x]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:n.sort,splice:n.splice},p.extend=p.fn.extend=function(){var c,f,x,b,S,T,L=arguments[0]||{},z=1,U=arguments.length,W=!1;for(typeof L=="boolean"&&(W=L,L=arguments[z]||{},z++),typeof L=="object"||y(L)||(L={}),z===U&&(L=this,z--);z<U;z++)if((c=arguments[z])!=null)for(f in c)b=c[f],f!=="__proto__"&&L!==b&&(W&&b&&(p.isPlainObject(b)||(S=Array.isArray(b)))?(x=L[f],T=S&&!Array.isArray(x)?[]:S||p.isPlainObject(x)?x:{},S=!1,L[f]=p.extend(W,T,b)):b!==void 0&&(L[f]=b));return L},p.extend({expando:"jQuery"+(R+Math.random()).replace(/\D/g,""),isReady:!0,error:function(c){throw new Error(c)},noop:function(){},isPlainObject:function(c){var f,x;return!(!c||l.call(c)!=="[object Object]")&&(!(f=i(c))||typeof(x=d.call(f,"constructor")&&f.constructor)=="function"&&h.call(x)===g)},isEmptyObject:function(c){var f;for(f in c)return!1;return!0},globalEval:function(c,f,x){v(c,{nonce:f&&f.nonce},x)},each:function(c,f){var x,b=0;if(A(c))for(x=c.length;b<x&&f.call(c[b],b,c[b])!==!1;b++);else for(b in c)if(f.call(c[b],b,c[b])===!1)break;return c},makeArray:function(c,f){var x=f||[];return c!=null&&(A(Object(c))?p.merge(x,typeof c=="string"?[c]:c):o.call(x,c)),x},inArray:function(c,f,x){return f==null?-1:a.call(f,c,x)},merge:function(c,f){for(var x=+f.length,b=0,S=c.length;b<x;b++)c[S++]=f[b];return c.length=S,c},grep:function(c,f,x){for(var b=[],S=0,T=c.length,L=!x;S<T;S++)!f(c[S],S)!==L&&b.push(c[S]);return b},map:function(c,f,x){var b,S,T=0,L=[];if(A(c))for(b=c.length;T<b;T++)(S=f(c[T],T,x))!=null&&L.push(S);else for(T in c)(S=f(c[T],T,x))!=null&&L.push(S);return s(L)},guid:1,support:m}),typeof Symbol=="function"&&(p.fn[Symbol.iterator]=n[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(c,f){u["[object "+f+"]"]=f.toLowerCase()});var O=(function(c){var f,x,b,S,T,L,z,U,W,K,he,J,te,Ie,Ge,Fe,Ft,Xt,wn,Mt="sizzle"+1*new Date,et=c.document,yn=0,yt=0,zt=_o(),bs=_o(),yo=_o(),Mn=_o(),sr=function(C,F){return C===F&&(he=!0),0},Rr={}.hasOwnProperty,vn=[],Pr=vn.pop,Nn=vn.push,kt=vn.push,Sn=vn.slice,Tn=function(C,F){for(var V=0,ae=C.length;V<ae;V++)if(C[V]===F)return V;return-1},ii="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",xt="(?:\\\\[\\da-fA-F]{1,6}"+nt+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Yt="\\["+nt+"*("+xt+")(?:"+nt+"*([*^$|!~]?=)"+nt+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+xt+"))|)"+nt+"*\\]",En=":("+xt+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Yt+")*)|.*)\\)|)",jt=new RegExp(nt+"+","g"),An=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),Dr=new RegExp("^"+nt+"*,"+nt+"*"),vo=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),td=new RegExp(nt+"|>"),nd=new RegExp(En),id=new RegExp("^"+xt+"$"),xo={ID:new RegExp("^#("+xt+")"),CLASS:new RegExp("^\\.("+xt+")"),TAG:new RegExp("^("+xt+"|[*])"),ATTR:new RegExp("^"+Yt),PSEUDO:new RegExp("^"+En),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+ii+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},rd=/HTML$/i,sd=/^(?:input|select|textarea|button)$/i,od=/^h\d$/i,ws=/^[^{]+\{\s*\[native \w/,ad=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$a=/[+~]/,xi=new RegExp("\\\\[\\da-fA-F]{1,6}"+nt+"?|\\\\([^\\r\\n\\f])","g"),_i=function(C,F){var V="0x"+C.slice(1)-65536;return F||(V<0?String.fromCharCode(V+65536):String.fromCharCode(V>>10|55296,1023&V|56320))},Ql=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Kl=function(C,F){return F?C==="\0"?"ï¿½":C.slice(0,-1)+"\\"+C.charCodeAt(C.length-1).toString(16)+" ":"\\"+C},eu=function(){J()},cd=wo(function(C){return C.disabled===!0&&C.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{kt.apply(vn=Sn.call(et.childNodes),et.childNodes),vn[et.childNodes.length].nodeType}catch{kt={apply:vn.length?function(F,V){Nn.apply(F,Sn.call(V))}:function(F,V){for(var ae=F.length,q=0;F[ae++]=V[q++];);F.length=ae-1}}}function Tt(C,F,V,ae){var q,pe,ye,Te,De,Qe,qe,Xe=F&&F.ownerDocument,mt=F?F.nodeType:9;if(V=V||[],typeof C!="string"||!C||mt!==1&&mt!==9&&mt!==11)return V;if(!ae&&(J(F),F=F||te,Ge)){if(mt!==11&&(De=ad.exec(C)))if(q=De[1]){if(mt===9){if(!(ye=F.getElementById(q)))return V;if(ye.id===q)return V.push(ye),V}else if(Xe&&(ye=Xe.getElementById(q))&&wn(F,ye)&&ye.id===q)return V.push(ye),V}else{if(De[2])return kt.apply(V,F.getElementsByTagName(C)),V;if((q=De[3])&&x.getElementsByClassName&&F.getElementsByClassName)return kt.apply(V,F.getElementsByClassName(q)),V}if(x.qsa&&!Mn[C+" "]&&(!Fe||!Fe.test(C))&&(mt!==1||F.nodeName.toLowerCase()!=="object")){if(qe=C,Xe=F,mt===1&&(td.test(C)||vo.test(C))){for((Xe=$a.test(C)&&Ka(F.parentNode)||F)===F&&x.scope||((Te=F.getAttribute("id"))?Te=Te.replace(Ql,Kl):F.setAttribute("id",Te=Mt)),pe=(Qe=L(C)).length;pe--;)Qe[pe]=(Te?"#"+Te:":scope")+" "+bo(Qe[pe]);qe=Qe.join(",")}try{return kt.apply(V,Xe.querySelectorAll(qe)),V}catch{Mn(C,!0)}finally{Te===Mt&&F.removeAttribute("id")}}}return U(C.replace(An,"$1"),F,V,ae)}function _o(){var C=[];return function F(V,ae){return C.push(V+" ")>b.cacheLength&&delete F[C.shift()],F[V+" "]=ae}}function Vn(C){return C[Mt]=!0,C}function Wn(C){var F=te.createElement("fieldset");try{return!!C(F)}catch{return!1}finally{F.parentNode&&F.parentNode.removeChild(F),F=null}}function Qa(C,F){for(var V=C.split("|"),ae=V.length;ae--;)b.attrHandle[V[ae]]=F}function tu(C,F){var V=F&&C,ae=V&&C.nodeType===1&&F.nodeType===1&&C.sourceIndex-F.sourceIndex;if(ae)return ae;if(V){for(;V=V.nextSibling;)if(V===F)return-1}return C?1:-1}function ld(C){return function(F){return F.nodeName.toLowerCase()==="input"&&F.type===C}}function ud(C){return function(F){var V=F.nodeName.toLowerCase();return(V==="input"||V==="button")&&F.type===C}}function nu(C){return function(F){return"form"in F?F.parentNode&&F.disabled===!1?"label"in F?"label"in F.parentNode?F.parentNode.disabled===C:F.disabled===C:F.isDisabled===C||F.isDisabled!==!C&&cd(F)===C:F.disabled===C:"label"in F&&F.disabled===C}}function or(C){return Vn(function(F){return F=+F,Vn(function(V,ae){for(var q,pe=C([],V.length,F),ye=pe.length;ye--;)V[q=pe[ye]]&&(V[q]=!(ae[q]=V[q]))})})}function Ka(C){return C&&typeof C.getElementsByTagName<"u"&&C}for(f in x=Tt.support={},T=Tt.isXML=function(C){var F=C.namespaceURI,V=(C.ownerDocument||C).documentElement;return!rd.test(F||V&&V.nodeName||"HTML")},J=Tt.setDocument=function(C){var F,V,ae=C?C.ownerDocument||C:et;return ae!=te&&ae.nodeType===9&&ae.documentElement&&(Ie=(te=ae).documentElement,Ge=!T(te),et!=te&&(V=te.defaultView)&&V.top!==V&&(V.addEventListener?V.addEventListener("unload",eu,!1):V.attachEvent&&V.attachEvent("onunload",eu)),x.scope=Wn(function(q){return Ie.appendChild(q).appendChild(te.createElement("div")),typeof q.querySelectorAll<"u"&&!q.querySelectorAll(":scope fieldset div").length}),x.attributes=Wn(function(q){return q.className="i",!q.getAttribute("className")}),x.getElementsByTagName=Wn(function(q){return q.appendChild(te.createComment("")),!q.getElementsByTagName("*").length}),x.getElementsByClassName=ws.test(te.getElementsByClassName),x.getById=Wn(function(q){return Ie.appendChild(q).id=Mt,!te.getElementsByName||!te.getElementsByName(Mt).length}),x.getById?(b.filter.ID=function(q){var pe=q.replace(xi,_i);return function(ye){return ye.getAttribute("id")===pe}},b.find.ID=function(q,pe){if(typeof pe.getElementById<"u"&&Ge){var ye=pe.getElementById(q);return ye?[ye]:[]}}):(b.filter.ID=function(q){var pe=q.replace(xi,_i);return function(ye){var Te=typeof ye.getAttributeNode<"u"&&ye.getAttributeNode("id");return Te&&Te.value===pe}},b.find.ID=function(q,pe){if(typeof pe.getElementById<"u"&&Ge){var ye,Te,De,Qe=pe.getElementById(q);if(Qe){if((ye=Qe.getAttributeNode("id"))&&ye.value===q)return[Qe];for(De=pe.getElementsByName(q),Te=0;Qe=De[Te++];)if((ye=Qe.getAttributeNode("id"))&&ye.value===q)return[Qe]}return[]}}),b.find.TAG=x.getElementsByTagName?function(q,pe){return typeof pe.getElementsByTagName<"u"?pe.getElementsByTagName(q):x.qsa?pe.querySelectorAll(q):void 0}:function(q,pe){var ye,Te=[],De=0,Qe=pe.getElementsByTagName(q);if(q==="*"){for(;ye=Qe[De++];)ye.nodeType===1&&Te.push(ye);return Te}return Qe},b.find.CLASS=x.getElementsByClassName&&function(q,pe){if(typeof pe.getElementsByClassName<"u"&&Ge)return pe.getElementsByClassName(q)},Ft=[],Fe=[],(x.qsa=ws.test(te.querySelectorAll))&&(Wn(function(q){var pe;Ie.appendChild(q).innerHTML="<a id='"+Mt+"'></a><select id='"+Mt+"-\r\\' msallowcapture=''><option selected=''></option></select>",q.querySelectorAll("[msallowcapture^='']").length&&Fe.push("[*^$]="+nt+`*(?:''|"")`),q.querySelectorAll("[selected]").length||Fe.push("\\["+nt+"*(?:value|"+ii+")"),q.querySelectorAll("[id~="+Mt+"-]").length||Fe.push("~="),(pe=te.createElement("input")).setAttribute("name",""),q.appendChild(pe),q.querySelectorAll("[name='']").length||Fe.push("\\["+nt+"*name"+nt+"*="+nt+`*(?:''|"")`),q.querySelectorAll(":checked").length||Fe.push(":checked"),q.querySelectorAll("a#"+Mt+"+*").length||Fe.push(".#.+[+~]"),q.querySelectorAll("\\\f"),Fe.push("[\\r\\n\\f]")}),Wn(function(q){q.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var pe=te.createElement("input");pe.setAttribute("type","hidden"),q.appendChild(pe).setAttribute("name","D"),q.querySelectorAll("[name=d]").length&&Fe.push("name"+nt+"*[*^$|!~]?="),q.querySelectorAll(":enabled").length!==2&&Fe.push(":enabled",":disabled"),Ie.appendChild(q).disabled=!0,q.querySelectorAll(":disabled").length!==2&&Fe.push(":enabled",":disabled"),q.querySelectorAll("*,:x"),Fe.push(",.*:")})),(x.matchesSelector=ws.test(Xt=Ie.matches||Ie.webkitMatchesSelector||Ie.mozMatchesSelector||Ie.oMatchesSelector||Ie.msMatchesSelector))&&Wn(function(q){x.disconnectedMatch=Xt.call(q,"*"),Xt.call(q,"[s!='']:x"),Ft.push("!=",En)}),Fe=Fe.length&&new RegExp(Fe.join("|")),Ft=Ft.length&&new RegExp(Ft.join("|")),F=ws.test(Ie.compareDocumentPosition),wn=F||ws.test(Ie.contains)?function(q,pe){var ye=q.nodeType===9?q.documentElement:q,Te=pe&&pe.parentNode;return q===Te||!(!Te||Te.nodeType!==1||!(ye.contains?ye.contains(Te):q.compareDocumentPosition&&16&q.compareDocumentPosition(Te)))}:function(q,pe){if(pe){for(;pe=pe.parentNode;)if(pe===q)return!0}return!1},sr=F?function(q,pe){if(q===pe)return he=!0,0;var ye=!q.compareDocumentPosition-!pe.compareDocumentPosition;return ye||(1&(ye=(q.ownerDocument||q)==(pe.ownerDocument||pe)?q.compareDocumentPosition(pe):1)||!x.sortDetached&&pe.compareDocumentPosition(q)===ye?q==te||q.ownerDocument==et&&wn(et,q)?-1:pe==te||pe.ownerDocument==et&&wn(et,pe)?1:K?Tn(K,q)-Tn(K,pe):0:4&ye?-1:1)}:function(q,pe){if(q===pe)return he=!0,0;var ye,Te=0,De=q.parentNode,Qe=pe.parentNode,qe=[q],Xe=[pe];if(!De||!Qe)return q==te?-1:pe==te?1:De?-1:Qe?1:K?Tn(K,q)-Tn(K,pe):0;if(De===Qe)return tu(q,pe);for(ye=q;ye=ye.parentNode;)qe.unshift(ye);for(ye=pe;ye=ye.parentNode;)Xe.unshift(ye);for(;qe[Te]===Xe[Te];)Te++;return Te?tu(qe[Te],Xe[Te]):qe[Te]==et?-1:Xe[Te]==et?1:0}),te},Tt.matches=function(C,F){return Tt(C,null,null,F)},Tt.matchesSelector=function(C,F){if(J(C),x.matchesSelector&&Ge&&!Mn[F+" "]&&(!Ft||!Ft.test(F))&&(!Fe||!Fe.test(F)))try{var V=Xt.call(C,F);if(V||x.disconnectedMatch||C.document&&C.document.nodeType!==11)return V}catch{Mn(F,!0)}return 0<Tt(F,te,null,[C]).length},Tt.contains=function(C,F){return(C.ownerDocument||C)!=te&&J(C),wn(C,F)},Tt.attr=function(C,F){(C.ownerDocument||C)!=te&&J(C);var V=b.attrHandle[F.toLowerCase()],ae=V&&Rr.call(b.attrHandle,F.toLowerCase())?V(C,F,!Ge):void 0;return ae!==void 0?ae:x.attributes||!Ge?C.getAttribute(F):(ae=C.getAttributeNode(F))&&ae.specified?ae.value:null},Tt.escape=function(C){return(C+"").replace(Ql,Kl)},Tt.error=function(C){throw new Error("Syntax error, unrecognized expression: "+C)},Tt.uniqueSort=function(C){var F,V=[],ae=0,q=0;if(he=!x.detectDuplicates,K=!x.sortStable&&C.slice(0),C.sort(sr),he){for(;F=C[q++];)F===C[q]&&(ae=V.push(q));for(;ae--;)C.splice(V[ae],1)}return K=null,C},S=Tt.getText=function(C){var F,V="",ae=0,q=C.nodeType;if(q){if(q===1||q===9||q===11){if(typeof C.textContent=="string")return C.textContent;for(C=C.firstChild;C;C=C.nextSibling)V+=S(C)}else if(q===3||q===4)return C.nodeValue}else for(;F=C[ae++];)V+=S(F);return V},(b=Tt.selectors={cacheLength:50,createPseudo:Vn,match:xo,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(C){return C[1]=C[1].replace(xi,_i),C[3]=(C[3]||C[4]||C[5]||"").replace(xi,_i),C[2]==="~="&&(C[3]=" "+C[3]+" "),C.slice(0,4)},CHILD:function(C){return C[1]=C[1].toLowerCase(),C[1].slice(0,3)==="nth"?(C[3]||Tt.error(C[0]),C[4]=+(C[4]?C[5]+(C[6]||1):2*(C[3]==="even"||C[3]==="odd")),C[5]=+(C[7]+C[8]||C[3]==="odd")):C[3]&&Tt.error(C[0]),C},PSEUDO:function(C){var F,V=!C[6]&&C[2];return xo.CHILD.test(C[0])?null:(C[3]?C[2]=C[4]||C[5]||"":V&&nd.test(V)&&(F=L(V,!0))&&(F=V.indexOf(")",V.length-F)-V.length)&&(C[0]=C[0].slice(0,F),C[2]=V.slice(0,F)),C.slice(0,3))}},filter:{TAG:function(C){var F=C.replace(xi,_i).toLowerCase();return C==="*"?function(){return!0}:function(V){return V.nodeName&&V.nodeName.toLowerCase()===F}},CLASS:function(C){var F=zt[C+" "];return F||(F=new RegExp("(^|"+nt+")"+C+"("+nt+"|$)"))&&zt(C,function(V){return F.test(typeof V.className=="string"&&V.className||typeof V.getAttribute<"u"&&V.getAttribute("class")||"")})},ATTR:function(C,F,V){return function(ae){var q=Tt.attr(ae,C);return q==null?F==="!=":!F||(q+="",F==="="?q===V:F==="!="?q!==V:F==="^="?V&&q.indexOf(V)===0:F==="*="?V&&-1<q.indexOf(V):F==="$="?V&&q.slice(-V.length)===V:F==="~="?-1<(" "+q.replace(jt," ")+" ").indexOf(V):F==="|="&&(q===V||q.slice(0,V.length+1)===V+"-"))}},CHILD:function(C,F,V,ae,q){var pe=C.slice(0,3)!=="nth",ye=C.slice(-4)!=="last",Te=F==="of-type";return ae===1&&q===0?function(De){return!!De.parentNode}:function(De,Qe,qe){var Xe,mt,Vt,ot,Zt,Qt,dn=pe!==ye?"nextSibling":"previousSibling",Et=De.parentNode,ri=Te&&De.nodeName.toLowerCase(),cn=!qe&&!Te,qt=!1;if(Et){if(pe){for(;dn;){for(ot=De;ot=ot[dn];)if(Te?ot.nodeName.toLowerCase()===ri:ot.nodeType===1)return!1;Qt=dn=C==="only"&&!Qt&&"nextSibling"}return!0}if(Qt=[ye?Et.firstChild:Et.lastChild],ye&&cn){for(qt=(Zt=(Xe=(mt=(Vt=(ot=Et)[Mt]||(ot[Mt]={}))[ot.uniqueID]||(Vt[ot.uniqueID]={}))[C]||[])[0]===yn&&Xe[1])&&Xe[2],ot=Zt&&Et.childNodes[Zt];ot=++Zt&&ot&&ot[dn]||(qt=Zt=0)||Qt.pop();)if(ot.nodeType===1&&++qt&&ot===De){mt[C]=[yn,Zt,qt];break}}else if(cn&&(qt=Zt=(Xe=(mt=(Vt=(ot=De)[Mt]||(ot[Mt]={}))[ot.uniqueID]||(Vt[ot.uniqueID]={}))[C]||[])[0]===yn&&Xe[1]),qt===!1)for(;(ot=++Zt&&ot&&ot[dn]||(qt=Zt=0)||Qt.pop())&&!((Te?ot.nodeName.toLowerCase()===ri:ot.nodeType===1)&&++qt&&(cn&&((mt=(Vt=ot[Mt]||(ot[Mt]={}))[ot.uniqueID]||(Vt[ot.uniqueID]={}))[C]=[yn,qt]),ot===De)););return(qt-=q)===ae||qt%ae==0&&0<=qt/ae}}},PSEUDO:function(C,F){var V,ae=b.pseudos[C]||b.setFilters[C.toLowerCase()]||Tt.error("unsupported pseudo: "+C);return ae[Mt]?ae(F):1<ae.length?(V=[C,C,"",F],b.setFilters.hasOwnProperty(C.toLowerCase())?Vn(function(q,pe){for(var ye,Te=ae(q,F),De=Te.length;De--;)q[ye=Tn(q,Te[De])]=!(pe[ye]=Te[De])}):function(q){return ae(q,0,V)}):ae}},pseudos:{not:Vn(function(C){var F=[],V=[],ae=z(C.replace(An,"$1"));return ae[Mt]?Vn(function(q,pe,ye,Te){for(var De,Qe=ae(q,null,Te,[]),qe=q.length;qe--;)(De=Qe[qe])&&(q[qe]=!(pe[qe]=De))}):function(q,pe,ye){return F[0]=q,ae(F,null,ye,V),F[0]=null,!V.pop()}}),has:Vn(function(C){return function(F){return 0<Tt(C,F).length}}),contains:Vn(function(C){return C=C.replace(xi,_i),function(F){return-1<(F.textContent||S(F)).indexOf(C)}}),lang:Vn(function(C){return id.test(C||"")||Tt.error("unsupported lang: "+C),C=C.replace(xi,_i).toLowerCase(),function(F){var V;do if(V=Ge?F.lang:F.getAttribute("xml:lang")||F.getAttribute("lang"))return(V=V.toLowerCase())===C||V.indexOf(C+"-")===0;while((F=F.parentNode)&&F.nodeType===1);return!1}}),target:function(C){var F=c.location&&c.location.hash;return F&&F.slice(1)===C.id},root:function(C){return C===Ie},focus:function(C){return C===te.activeElement&&(!te.hasFocus||te.hasFocus())&&!!(C.type||C.href||~C.tabIndex)},enabled:nu(!1),disabled:nu(!0),checked:function(C){var F=C.nodeName.toLowerCase();return F==="input"&&!!C.checked||F==="option"&&!!C.selected},selected:function(C){return C.parentNode&&C.parentNode.selectedIndex,C.selected===!0},empty:function(C){for(C=C.firstChild;C;C=C.nextSibling)if(C.nodeType<6)return!1;return!0},parent:function(C){return!b.pseudos.empty(C)},header:function(C){return od.test(C.nodeName)},input:function(C){return sd.test(C.nodeName)},button:function(C){var F=C.nodeName.toLowerCase();return F==="input"&&C.type==="button"||F==="button"},text:function(C){var F;return C.nodeName.toLowerCase()==="input"&&C.type==="text"&&((F=C.getAttribute("type"))==null||F.toLowerCase()==="text")},first:or(function(){return[0]}),last:or(function(C,F){return[F-1]}),eq:or(function(C,F,V){return[V<0?V+F:V]}),even:or(function(C,F){for(var V=0;V<F;V+=2)C.push(V);return C}),odd:or(function(C,F){for(var V=1;V<F;V+=2)C.push(V);return C}),lt:or(function(C,F,V){for(var ae=V<0?V+F:F<V?F:V;0<=--ae;)C.push(ae);return C}),gt:or(function(C,F,V){for(var ae=V<0?V+F:V;++ae<F;)C.push(ae);return C})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[f]=ld(f);for(f in{submit:!0,reset:!0})b.pseudos[f]=ud(f);function iu(){}function bo(C){for(var F=0,V=C.length,ae="";F<V;F++)ae+=C[F].value;return ae}function wo(C,F,V){var ae=F.dir,q=F.next,pe=q||ae,ye=V&&pe==="parentNode",Te=yt++;return F.first?function(De,Qe,qe){for(;De=De[ae];)if(De.nodeType===1||ye)return C(De,Qe,qe);return!1}:function(De,Qe,qe){var Xe,mt,Vt,ot=[yn,Te];if(qe){for(;De=De[ae];)if((De.nodeType===1||ye)&&C(De,Qe,qe))return!0}else for(;De=De[ae];)if(De.nodeType===1||ye)if(mt=(Vt=De[Mt]||(De[Mt]={}))[De.uniqueID]||(Vt[De.uniqueID]={}),q&&q===De.nodeName.toLowerCase())De=De[ae]||De;else{if((Xe=mt[pe])&&Xe[0]===yn&&Xe[1]===Te)return ot[2]=Xe[2];if((mt[pe]=ot)[2]=C(De,Qe,qe))return!0}return!1}}function ec(C){return 1<C.length?function(F,V,ae){for(var q=C.length;q--;)if(!C[q](F,V,ae))return!1;return!0}:C[0]}function Mo(C,F,V,ae,q){for(var pe,ye=[],Te=0,De=C.length,Qe=F!=null;Te<De;Te++)(pe=C[Te])&&(V&&!V(pe,ae,q)||(ye.push(pe),Qe&&F.push(Te)));return ye}function tc(C,F,V,ae,q,pe){return ae&&!ae[Mt]&&(ae=tc(ae)),q&&!q[Mt]&&(q=tc(q,pe)),Vn(function(ye,Te,De,Qe){var qe,Xe,mt,Vt=[],ot=[],Zt=Te.length,Qt=ye||(function(ri,cn,qt){for(var jn=0,So=cn.length;jn<So;jn++)Tt(ri,cn[jn],qt);return qt})(F||"*",De.nodeType?[De]:De,[]),dn=!C||!ye&&F?Qt:Mo(Qt,Vt,C,De,Qe),Et=V?q||(ye?C:Zt||ae)?[]:Te:dn;if(V&&V(dn,Et,De,Qe),ae)for(qe=Mo(Et,ot),ae(qe,[],De,Qe),Xe=qe.length;Xe--;)(mt=qe[Xe])&&(Et[ot[Xe]]=!(dn[ot[Xe]]=mt));if(ye){if(q||C){if(q){for(qe=[],Xe=Et.length;Xe--;)(mt=Et[Xe])&&qe.push(dn[Xe]=mt);q(null,Et=[],qe,Qe)}for(Xe=Et.length;Xe--;)(mt=Et[Xe])&&-1<(qe=q?Tn(ye,mt):Vt[Xe])&&(ye[qe]=!(Te[qe]=mt))}}else Et=Mo(Et===Te?Et.splice(Zt,Et.length):Et),q?q(null,Te,Et,Qe):kt.apply(Te,Et)})}function nc(C){for(var F,V,ae,q=C.length,pe=b.relative[C[0].type],ye=pe||b.relative[" "],Te=pe?1:0,De=wo(function(Xe){return Xe===F},ye,!0),Qe=wo(function(Xe){return-1<Tn(F,Xe)},ye,!0),qe=[function(Xe,mt,Vt){var ot=!pe&&(Vt||mt!==W)||((F=mt).nodeType?De(Xe,mt,Vt):Qe(Xe,mt,Vt));return F=null,ot}];Te<q;Te++)if(V=b.relative[C[Te].type])qe=[wo(ec(qe),V)];else{if((V=b.filter[C[Te].type].apply(null,C[Te].matches))[Mt]){for(ae=++Te;ae<q&&!b.relative[C[ae].type];ae++);return tc(1<Te&&ec(qe),1<Te&&bo(C.slice(0,Te-1).concat({value:C[Te-2].type===" "?"*":""})).replace(An,"$1"),V,Te<ae&&nc(C.slice(Te,ae)),ae<q&&nc(C=C.slice(ae)),ae<q&&bo(C))}qe.push(V)}return ec(qe)}return iu.prototype=b.filters=b.pseudos,b.setFilters=new iu,L=Tt.tokenize=function(C,F){var V,ae,q,pe,ye,Te,De,Qe=bs[C+" "];if(Qe)return F?0:Qe.slice(0);for(ye=C,Te=[],De=b.preFilter;ye;){for(pe in V&&!(ae=Dr.exec(ye))||(ae&&(ye=ye.slice(ae[0].length)||ye),Te.push(q=[])),V=!1,(ae=vo.exec(ye))&&(V=ae.shift(),q.push({value:V,type:ae[0].replace(An," ")}),ye=ye.slice(V.length)),b.filter)!(ae=xo[pe].exec(ye))||De[pe]&&!(ae=De[pe](ae))||(V=ae.shift(),q.push({value:V,type:pe,matches:ae}),ye=ye.slice(V.length));if(!V)break}return F?ye.length:ye?Tt.error(C):bs(C,Te).slice(0)},z=Tt.compile=function(C,F){var V,ae,q,pe,ye,Te,De=[],Qe=[],qe=yo[C+" "];if(!qe){for(F||(F=L(C)),V=F.length;V--;)(qe=nc(F[V]))[Mt]?De.push(qe):Qe.push(qe);(qe=yo(C,(ae=Qe,pe=0<(q=De).length,ye=0<ae.length,Te=function(Xe,mt,Vt,ot,Zt){var Qt,dn,Et,ri=0,cn="0",qt=Xe&&[],jn=[],So=W,ru=Xe||ye&&b.find.TAG("*",Zt),su=yn+=So==null?1:Math.random()||.1,hd=ru.length;for(Zt&&(W=mt==te||mt||Zt);cn!==hd&&(Qt=ru[cn])!=null;cn++){if(ye&&Qt){for(dn=0,mt||Qt.ownerDocument==te||(J(Qt),Vt=!Ge);Et=ae[dn++];)if(Et(Qt,mt||te,Vt)){ot.push(Qt);break}Zt&&(yn=su)}pe&&((Qt=!Et&&Qt)&&ri--,Xe&&qt.push(Qt))}if(ri+=cn,pe&&cn!==ri){for(dn=0;Et=q[dn++];)Et(qt,jn,mt,Vt);if(Xe){if(0<ri)for(;cn--;)qt[cn]||jn[cn]||(jn[cn]=Pr.call(ot));jn=Mo(jn)}kt.apply(ot,jn),Zt&&!Xe&&0<jn.length&&1<ri+q.length&&Tt.uniqueSort(ot)}return Zt&&(yn=su,W=So),qt},pe?Vn(Te):Te))).selector=C}return qe},U=Tt.select=function(C,F,V,ae){var q,pe,ye,Te,De,Qe=typeof C=="function"&&C,qe=!ae&&L(C=Qe.selector||C);if(V=V||[],qe.length===1){if(2<(pe=qe[0]=qe[0].slice(0)).length&&(ye=pe[0]).type==="ID"&&F.nodeType===9&&Ge&&b.relative[pe[1].type]){if(!(F=(b.find.ID(ye.matches[0].replace(xi,_i),F)||[])[0]))return V;Qe&&(F=F.parentNode),C=C.slice(pe.shift().value.length)}for(q=xo.needsContext.test(C)?0:pe.length;q--&&(ye=pe[q],!b.relative[Te=ye.type]);)if((De=b.find[Te])&&(ae=De(ye.matches[0].replace(xi,_i),$a.test(pe[0].type)&&Ka(F.parentNode)||F))){if(pe.splice(q,1),!(C=ae.length&&bo(pe)))return kt.apply(V,ae),V;break}}return(Qe||z(C,qe))(ae,F,!Ge,V,!F||$a.test(C)&&Ka(F.parentNode)||F),V},x.sortStable=Mt.split("").sort(sr).join("")===Mt,x.detectDuplicates=!!he,J(),x.sortDetached=Wn(function(C){return 1&C.compareDocumentPosition(te.createElement("fieldset"))}),Wn(function(C){return C.innerHTML="<a href='#'></a>",C.firstChild.getAttribute("href")==="#"})||Qa("type|href|height|width",function(C,F,V){if(!V)return C.getAttribute(F,F.toLowerCase()==="type"?1:2)}),x.attributes&&Wn(function(C){return C.innerHTML="<input/>",C.firstChild.setAttribute("value",""),C.firstChild.getAttribute("value")===""})||Qa("value",function(C,F,V){if(!V&&C.nodeName.toLowerCase()==="input")return C.defaultValue}),Wn(function(C){return C.getAttribute("disabled")==null})||Qa(ii,function(C,F,V){var ae;if(!V)return C[F]===!0?F.toLowerCase():(ae=C.getAttributeNode(F))&&ae.specified?ae.value:null}),Tt})(t);p.find=O,p.expr=O.selectors,p.expr[":"]=p.expr.pseudos,p.uniqueSort=p.unique=O.uniqueSort,p.text=O.getText,p.isXMLDoc=O.isXML,p.contains=O.contains,p.escapeSelector=O.escape;var H=function(c,f,x){for(var b=[],S=x!==void 0;(c=c[f])&&c.nodeType!==9;)if(c.nodeType===1){if(S&&p(c).is(x))break;b.push(c)}return b},ne=function(c,f){for(var x=[];c;c=c.nextSibling)c.nodeType===1&&c!==f&&x.push(c);return x},se=p.expr.match.needsContext;function B(c,f){return c.nodeName&&c.nodeName.toLowerCase()===f.toLowerCase()}var j=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Y(c,f,x){return y(f)?p.grep(c,function(b,S){return!!f.call(b,S,b)!==x}):f.nodeType?p.grep(c,function(b){return b===f!==x}):typeof f!="string"?p.grep(c,function(b){return-1<a.call(f,b)!==x}):p.filter(f,c,x)}p.filter=function(c,f,x){var b=f[0];return x&&(c=":not("+c+")"),f.length===1&&b.nodeType===1?p.find.matchesSelector(b,c)?[b]:[]:p.find.matches(c,p.grep(f,function(S){return S.nodeType===1}))},p.fn.extend({find:function(c){var f,x,b=this.length,S=this;if(typeof c!="string")return this.pushStack(p(c).filter(function(){for(f=0;f<b;f++)if(p.contains(S[f],this))return!0}));for(x=this.pushStack([]),f=0;f<b;f++)p.find(c,S[f],x);return 1<b?p.uniqueSort(x):x},filter:function(c){return this.pushStack(Y(this,c||[],!1))},not:function(c){return this.pushStack(Y(this,c||[],!0))},is:function(c){return!!Y(this,typeof c=="string"&&se.test(c)?p(c):c||[],!1).length}});var Q,X=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(p.fn.init=function(c,f,x){var b,S;if(!c)return this;if(x=x||Q,typeof c=="string"){if(!(b=c[0]==="<"&&c[c.length-1]===">"&&3<=c.length?[null,c,null]:X.exec(c))||!b[1]&&f)return!f||f.jquery?(f||x).find(c):this.constructor(f).find(c);if(b[1]){if(f=f instanceof p?f[0]:f,p.merge(this,p.parseHTML(b[1],f&&f.nodeType?f.ownerDocument||f:M,!0)),j.test(b[1])&&p.isPlainObject(f))for(b in f)y(this[b])?this[b](f[b]):this.attr(b,f[b]);return this}return(S=M.getElementById(b[2]))&&(this[0]=S,this.length=1),this}return c.nodeType?(this[0]=c,this.length=1,this):y(c)?x.ready!==void 0?x.ready(c):c(p):p.makeArray(c,this)}).prototype=p.fn,Q=p(M);var Z=/^(?:parents|prev(?:Until|All))/,le={children:!0,contents:!0,next:!0,prev:!0};function de(c,f){for(;(c=c[f])&&c.nodeType!==1;);return c}p.fn.extend({has:function(c){var f=p(c,this),x=f.length;return this.filter(function(){for(var b=0;b<x;b++)if(p.contains(this,f[b]))return!0})},closest:function(c,f){var x,b=0,S=this.length,T=[],L=typeof c!="string"&&p(c);if(!se.test(c)){for(;b<S;b++)for(x=this[b];x&&x!==f;x=x.parentNode)if(x.nodeType<11&&(L?-1<L.index(x):x.nodeType===1&&p.find.matchesSelector(x,c))){T.push(x);break}}return this.pushStack(1<T.length?p.uniqueSort(T):T)},index:function(c){return c?typeof c=="string"?a.call(p(c),this[0]):a.call(this,c.jquery?c[0]:c):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(c,f){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(c,f))))},addBack:function(c){return this.add(c==null?this.prevObject:this.prevObject.filter(c))}}),p.each({parent:function(c){var f=c.parentNode;return f&&f.nodeType!==11?f:null},parents:function(c){return H(c,"parentNode")},parentsUntil:function(c,f,x){return H(c,"parentNode",x)},next:function(c){return de(c,"nextSibling")},prev:function(c){return de(c,"previousSibling")},nextAll:function(c){return H(c,"nextSibling")},prevAll:function(c){return H(c,"previousSibling")},nextUntil:function(c,f,x){return H(c,"nextSibling",x)},prevUntil:function(c,f,x){return H(c,"previousSibling",x)},siblings:function(c){return ne((c.parentNode||{}).firstChild,c)},children:function(c){return ne(c.firstChild)},contents:function(c){return c.contentDocument!=null&&i(c.contentDocument)?c.contentDocument:(B(c,"template")&&(c=c.content||c),p.merge([],c.childNodes))}},function(c,f){p.fn[c]=function(x,b){var S=p.map(this,f,x);return c.slice(-5)!=="Until"&&(b=x),b&&typeof b=="string"&&(S=p.filter(b,S)),1<this.length&&(le[c]||p.uniqueSort(S),Z.test(c)&&S.reverse()),this.pushStack(S)}});var we=/[^\x20\t\r\n\f]+/g;function Ne(c){return c}function Re(c){throw c}function Je(c,f,x,b){var S;try{c&&y(S=c.promise)?S.call(c).done(f).fail(x):c&&y(S=c.then)?S.call(c,f,x):f.apply(void 0,[c].slice(b))}catch(T){x.apply(void 0,[T])}}p.Callbacks=function(c){var f,x;c=typeof c=="string"?(f=c,x={},p.each(f.match(we)||[],function(J,te){x[te]=!0}),x):p.extend({},c);var b,S,T,L,z=[],U=[],W=-1,K=function(){for(L=L||c.once,T=b=!0;U.length;W=-1)for(S=U.shift();++W<z.length;)z[W].apply(S[0],S[1])===!1&&c.stopOnFalse&&(W=z.length,S=!1);c.memory||(S=!1),b=!1,L&&(z=S?[]:"")},he={add:function(){return z&&(S&&!b&&(W=z.length-1,U.push(S)),(function J(te){p.each(te,function(Ie,Ge){y(Ge)?c.unique&&he.has(Ge)||z.push(Ge):Ge&&Ge.length&&E(Ge)!=="string"&&J(Ge)})})(arguments),S&&!b&&K()),this},remove:function(){return p.each(arguments,function(J,te){for(var Ie;-1<(Ie=p.inArray(te,z,Ie));)z.splice(Ie,1),Ie<=W&&W--}),this},has:function(J){return J?-1<p.inArray(J,z):0<z.length},empty:function(){return z&&(z=[]),this},disable:function(){return L=U=[],z=S="",this},disabled:function(){return!z},lock:function(){return L=U=[],S||b||(z=S=""),this},locked:function(){return!!L},fireWith:function(J,te){return L||(te=[J,(te=te||[]).slice?te.slice():te],U.push(te),b||K()),this},fire:function(){return he.fireWith(this,arguments),this},fired:function(){return!!T}};return he},p.extend({Deferred:function(c){var f=[["notify","progress",p.Callbacks("memory"),p.Callbacks("memory"),2],["resolve","done",p.Callbacks("once memory"),p.Callbacks("once memory"),0,"resolved"],["reject","fail",p.Callbacks("once memory"),p.Callbacks("once memory"),1,"rejected"]],x="pending",b={state:function(){return x},always:function(){return S.done(arguments).fail(arguments),this},catch:function(T){return b.then(null,T)},pipe:function(){var T=arguments;return p.Deferred(function(L){p.each(f,function(z,U){var W=y(T[U[4]])&&T[U[4]];S[U[1]](function(){var K=W&&W.apply(this,arguments);K&&y(K.promise)?K.promise().progress(L.notify).done(L.resolve).fail(L.reject):L[U[0]+"With"](this,W?[K]:arguments)})}),T=null}).promise()},then:function(T,L,z){var U=0;function W(K,he,J,te){return function(){var Ie=this,Ge=arguments,Fe=function(){var Xt,wn;if(!(K<U)){if((Xt=J.apply(Ie,Ge))===he.promise())throw new TypeError("Thenable self-resolution");wn=Xt&&(typeof Xt=="object"||typeof Xt=="function")&&Xt.then,y(wn)?te?wn.call(Xt,W(U,he,Ne,te),W(U,he,Re,te)):(U++,wn.call(Xt,W(U,he,Ne,te),W(U,he,Re,te),W(U,he,Ne,he.notifyWith))):(J!==Ne&&(Ie=void 0,Ge=[Xt]),(te||he.resolveWith)(Ie,Ge))}},Ft=te?Fe:function(){try{Fe()}catch(Xt){p.Deferred.exceptionHook&&p.Deferred.exceptionHook(Xt,Ft.stackTrace),U<=K+1&&(J!==Re&&(Ie=void 0,Ge=[Xt]),he.rejectWith(Ie,Ge))}};K?Ft():(p.Deferred.getStackHook&&(Ft.stackTrace=p.Deferred.getStackHook()),t.setTimeout(Ft))}}return p.Deferred(function(K){f[0][3].add(W(0,K,y(z)?z:Ne,K.notifyWith)),f[1][3].add(W(0,K,y(T)?T:Ne)),f[2][3].add(W(0,K,y(L)?L:Re))}).promise()},promise:function(T){return T!=null?p.extend(T,b):b}},S={};return p.each(f,function(T,L){var z=L[2],U=L[5];b[L[1]]=z.add,U&&z.add(function(){x=U},f[3-T][2].disable,f[3-T][3].disable,f[0][2].lock,f[0][3].lock),z.add(L[3].fire),S[L[0]]=function(){return S[L[0]+"With"](this===S?void 0:this,arguments),this},S[L[0]+"With"]=z.fireWith}),b.promise(S),c&&c.call(S,S),S},when:function(c){var f=arguments.length,x=f,b=Array(x),S=r.call(arguments),T=p.Deferred(),L=function(z){return function(U){b[z]=this,S[z]=1<arguments.length?r.call(arguments):U,--f||T.resolveWith(b,S)}};if(f<=1&&(Je(c,T.done(L(x)).resolve,T.reject,!f),T.state()==="pending"||y(S[x]&&S[x].then)))return T.then();for(;x--;)Je(S[x],L(x),T.reject);return T.promise()}});var tt=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;p.Deferred.exceptionHook=function(c,f){t.console&&t.console.warn&&c&&tt.test(c.name)&&t.console.warn("jQuery.Deferred exception: "+c.message,c.stack,f)},p.readyException=function(c){t.setTimeout(function(){throw c})};var _t=p.Deferred();function ue(){M.removeEventListener("DOMContentLoaded",ue),t.removeEventListener("load",ue),p.ready()}p.fn.ready=function(c){return _t.then(c).catch(function(f){p.readyException(f)}),this},p.extend({isReady:!1,readyWait:1,ready:function(c){(c===!0?--p.readyWait:p.isReady)||(p.isReady=!0)!==c&&0<--p.readyWait||_t.resolveWith(M,[p])}}),p.ready.then=_t.then,M.readyState==="complete"||M.readyState!=="loading"&&!M.documentElement.doScroll?t.setTimeout(p.ready):(M.addEventListener("DOMContentLoaded",ue),t.addEventListener("load",ue));var bt=function(c,f,x,b,S,T,L){var z=0,U=c.length,W=x==null;if(E(x)==="object")for(z in S=!0,x)bt(c,f,z,x[z],!0,T,L);else if(b!==void 0&&(S=!0,y(b)||(L=!0),W&&(L?(f.call(c,b),f=null):(W=f,f=function(K,he,J){return W.call(p(K),J)})),f))for(;z<U;z++)f(c[z],x,L?b:b.call(c[z],z,f(c[z],x)));return S?c:W?f.call(c):U?f(c[0],x):T},We=/^-ms-/,ft=/-([a-z])/g;function Ke(c,f){return f.toUpperCase()}function it(c){return c.replace(We,"ms-").replace(ft,Ke)}var Ze=function(c){return c.nodeType===1||c.nodeType===9||!+c.nodeType};function me(){this.expando=p.expando+me.uid++}me.uid=1,me.prototype={cache:function(c){var f=c[this.expando];return f||(f={},Ze(c)&&(c.nodeType?c[this.expando]=f:Object.defineProperty(c,this.expando,{value:f,configurable:!0}))),f},set:function(c,f,x){var b,S=this.cache(c);if(typeof f=="string")S[it(f)]=x;else for(b in f)S[it(b)]=f[b];return S},get:function(c,f){return f===void 0?this.cache(c):c[this.expando]&&c[this.expando][it(f)]},access:function(c,f,x){return f===void 0||f&&typeof f=="string"&&x===void 0?this.get(c,f):(this.set(c,f,x),x!==void 0?x:f)},remove:function(c,f){var x,b=c[this.expando];if(b!==void 0){if(f!==void 0)for(x=(f=Array.isArray(f)?f.map(it):(f=it(f))in b?[f]:f.match(we)||[]).length;x--;)delete b[f[x]];(f===void 0||p.isEmptyObject(b))&&(c.nodeType?c[this.expando]=void 0:delete c[this.expando])}},hasData:function(c){var f=c[this.expando];return f!==void 0&&!p.isEmptyObject(f)}};var ie=new me,_e=new me,ke=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Le=/[A-Z]/g;function N(c,f,x){var b,S;if(x===void 0&&c.nodeType===1)if(b="data-"+f.replace(Le,"-$&").toLowerCase(),typeof(x=c.getAttribute(b))=="string"){try{x=(S=x)==="true"||S!=="false"&&(S==="null"?null:S===+S+""?+S:ke.test(S)?JSON.parse(S):S)}catch{}_e.set(c,f,x)}else x=void 0;return x}p.extend({hasData:function(c){return _e.hasData(c)||ie.hasData(c)},data:function(c,f,x){return _e.access(c,f,x)},removeData:function(c,f){_e.remove(c,f)},_data:function(c,f,x){return ie.access(c,f,x)},_removeData:function(c,f){ie.remove(c,f)}}),p.fn.extend({data:function(c,f){var x,b,S,T=this[0],L=T&&T.attributes;if(c===void 0){if(this.length&&(S=_e.get(T),T.nodeType===1&&!ie.get(T,"hasDataAttrs"))){for(x=L.length;x--;)L[x]&&(b=L[x].name).indexOf("data-")===0&&(b=it(b.slice(5)),N(T,b,S[b]));ie.set(T,"hasDataAttrs",!0)}return S}return typeof c=="object"?this.each(function(){_e.set(this,c)}):bt(this,function(z){var U;if(T&&z===void 0)return(U=_e.get(T,c))!==void 0||(U=N(T,c))!==void 0?U:void 0;this.each(function(){_e.set(this,c,z)})},null,f,1<arguments.length,null,!0)},removeData:function(c){return this.each(function(){_e.remove(this,c)})}}),p.extend({queue:function(c,f,x){var b;if(c)return f=(f||"fx")+"queue",b=ie.get(c,f),x&&(!b||Array.isArray(x)?b=ie.access(c,f,p.makeArray(x)):b.push(x)),b||[]},dequeue:function(c,f){f=f||"fx";var x=p.queue(c,f),b=x.length,S=x.shift(),T=p._queueHooks(c,f);S==="inprogress"&&(S=x.shift(),b--),S&&(f==="fx"&&x.unshift("inprogress"),delete T.stop,S.call(c,function(){p.dequeue(c,f)},T)),!b&&T&&T.empty.fire()},_queueHooks:function(c,f){var x=f+"queueHooks";return ie.get(c,x)||ie.access(c,x,{empty:p.Callbacks("once memory").add(function(){ie.remove(c,[f+"queue",x])})})}}),p.fn.extend({queue:function(c,f){var x=2;return typeof c!="string"&&(f=c,c="fx",x--),arguments.length<x?p.queue(this[0],c):f===void 0?this:this.each(function(){var b=p.queue(this,c,f);p._queueHooks(this,c),c==="fx"&&b[0]!=="inprogress"&&p.dequeue(this,c)})},dequeue:function(c){return this.each(function(){p.dequeue(this,c)})},clearQueue:function(c){return this.queue(c||"fx",[])},promise:function(c,f){var x,b=1,S=p.Deferred(),T=this,L=this.length,z=function(){--b||S.resolveWith(T,[T])};for(typeof c!="string"&&(f=c,c=void 0),c=c||"fx";L--;)(x=ie.get(T[L],c+"queueHooks"))&&x.empty&&(b++,x.empty.add(z));return z(),S.promise(f)}});var D=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ve=new RegExp("^(?:([+-])=|)("+D+")([a-z%]*)$","i"),fe=["Top","Right","Bottom","Left"],G=M.documentElement,ge=function(c){return p.contains(c.ownerDocument,c)},Ee={composed:!0};G.getRootNode&&(ge=function(c){return p.contains(c.ownerDocument,c)||c.getRootNode(Ee)===c.ownerDocument});var Be=function(c,f){return(c=f||c).style.display==="none"||c.style.display===""&&ge(c)&&p.css(c,"display")==="none"};function Se(c,f,x,b){var S,T,L=20,z=b?function(){return b.cur()}:function(){return p.css(c,f,"")},U=z(),W=x&&x[3]||(p.cssNumber[f]?"":"px"),K=c.nodeType&&(p.cssNumber[f]||W!=="px"&&+U)&&ve.exec(p.css(c,f));if(K&&K[3]!==W){for(U/=2,W=W||K[3],K=+U||1;L--;)p.style(c,f,K+W),(1-T)*(1-(T=z()/U||.5))<=0&&(L=0),K/=T;K*=2,p.style(c,f,K+W),x=x||[]}return x&&(K=+K||+U||0,S=x[1]?K+(x[1]+1)*x[2]:+x[2],b&&(b.unit=W,b.start=K,b.end=S)),S}var k={};function xe(c,f){for(var x,b,S,T,L,z,U,W=[],K=0,he=c.length;K<he;K++)(b=c[K]).style&&(x=b.style.display,f?(x==="none"&&(W[K]=ie.get(b,"display")||null,W[K]||(b.style.display="")),b.style.display===""&&Be(b)&&(W[K]=(U=L=T=void 0,L=(S=b).ownerDocument,z=S.nodeName,(U=k[z])||(T=L.body.appendChild(L.createElement(z)),U=p.css(T,"display"),T.parentNode.removeChild(T),U==="none"&&(U="block"),k[z]=U)))):x!=="none"&&(W[K]="none",ie.set(b,"display",x)));for(K=0;K<he;K++)W[K]!=null&&(c[K].style.display=W[K]);return c}p.fn.extend({show:function(){return xe(this,!0)},hide:function(){return xe(this)},toggle:function(c){return typeof c=="boolean"?c?this.show():this.hide():this.each(function(){Be(this)?p(this).show():p(this).hide()})}});var Pe,Me,ze=/^(?:checkbox|radio)$/i,gt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Gt=/^$|^module$|\/(?:java|ecma)script/i;Pe=M.createDocumentFragment().appendChild(M.createElement("div")),(Me=M.createElement("input")).setAttribute("type","radio"),Me.setAttribute("checked","checked"),Me.setAttribute("name","t"),Pe.appendChild(Me),m.checkClone=Pe.cloneNode(!0).cloneNode(!0).lastChild.checked,Pe.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!Pe.cloneNode(!0).lastChild.defaultValue,Pe.innerHTML="<option></option>",m.option=!!Pe.lastChild;var $t={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Rt(c,f){var x;return x=typeof c.getElementsByTagName<"u"?c.getElementsByTagName(f||"*"):typeof c.querySelectorAll<"u"?c.querySelectorAll(f||"*"):[],f===void 0||f&&B(c,f)?p.merge([c],x):x}function on(c,f){for(var x=0,b=c.length;x<b;x++)ie.set(c[x],"globalEval",!f||ie.get(f[x],"globalEval"))}$t.tbody=$t.tfoot=$t.colgroup=$t.caption=$t.thead,$t.th=$t.td,m.option||($t.optgroup=$t.option=[1,"<select multiple='multiple'>","</select>"]);var ka=/<|&#?\w+;/;function Tr(c,f,x,b,S){for(var T,L,z,U,W,K,he=f.createDocumentFragment(),J=[],te=0,Ie=c.length;te<Ie;te++)if((T=c[te])||T===0)if(E(T)==="object")p.merge(J,T.nodeType?[T]:T);else if(ka.test(T)){for(L=L||he.appendChild(f.createElement("div")),z=(gt.exec(T)||["",""])[1].toLowerCase(),U=$t[z]||$t._default,L.innerHTML=U[1]+p.htmlPrefilter(T)+U[2],K=U[0];K--;)L=L.lastChild;p.merge(J,L.childNodes),(L=he.firstChild).textContent=""}else J.push(f.createTextNode(T));for(he.textContent="",te=0;T=J[te++];)if(b&&-1<p.inArray(T,b))S&&S.push(T);else if(W=ge(T),L=Rt(he.appendChild(T),"script"),W&&on(L),x)for(K=0;T=L[K++];)Gt.test(T.type||"")&&x.push(T);return he}var Ua=/^key/,tr=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ys=/^([^.]*)(?:\.(.+)|)/;function yi(){return!0}function vi(){return!1}function Un(c,f){return c===(function(){try{return M.activeElement}catch{}})()==(f==="focus")}function Er(c,f,x,b,S,T){var L,z;if(typeof f=="object"){for(z in typeof x!="string"&&(b=b||x,x=void 0),f)Er(c,z,x,b,f[z],T);return c}if(b==null&&S==null?(S=x,b=x=void 0):S==null&&(typeof x=="string"?(S=b,b=void 0):(S=b,b=x,x=void 0)),S===!1)S=vi;else if(!S)return c;return T===1&&(L=S,(S=function(U){return p().off(U),L.apply(this,arguments)}).guid=L.guid||(L.guid=p.guid++)),c.each(function(){p.event.add(this,f,S,b,x)})}function Ar(c,f,x){x?(ie.set(c,f,!1),p.event.add(c,f,{namespace:!1,handler:function(b){var S,T,L=ie.get(this,f);if(1&b.isTrigger&&this[f]){if(L.length)(p.event.special[f]||{}).delegateType&&b.stopPropagation();else if(L=r.call(arguments),ie.set(this,f,L),S=x(this,f),this[f](),L!==(T=ie.get(this,f))||S?ie.set(this,f,!1):T={},L!==T)return b.stopImmediatePropagation(),b.preventDefault(),T.value}else L.length&&(ie.set(this,f,{value:p.event.trigger(p.extend(L[0],p.Event.prototype),L.slice(1),this)}),b.stopImmediatePropagation())}})):ie.get(c,f)===void 0&&p.event.add(c,f,yi)}p.event={global:{},add:function(c,f,x,b,S){var T,L,z,U,W,K,he,J,te,Ie,Ge,Fe=ie.get(c);if(Ze(c))for(x.handler&&(x=(T=x).handler,S=T.selector),S&&p.find.matchesSelector(G,S),x.guid||(x.guid=p.guid++),(U=Fe.events)||(U=Fe.events=Object.create(null)),(L=Fe.handle)||(L=Fe.handle=function(Ft){return typeof p<"u"&&p.event.triggered!==Ft.type?p.event.dispatch.apply(c,arguments):void 0}),W=(f=(f||"").match(we)||[""]).length;W--;)te=Ge=(z=ys.exec(f[W])||[])[1],Ie=(z[2]||"").split(".").sort(),te&&(he=p.event.special[te]||{},te=(S?he.delegateType:he.bindType)||te,he=p.event.special[te]||{},K=p.extend({type:te,origType:Ge,data:b,handler:x,guid:x.guid,selector:S,needsContext:S&&p.expr.match.needsContext.test(S),namespace:Ie.join(".")},T),(J=U[te])||((J=U[te]=[]).delegateCount=0,he.setup&&he.setup.call(c,b,Ie,L)!==!1||c.addEventListener&&c.addEventListener(te,L)),he.add&&(he.add.call(c,K),K.handler.guid||(K.handler.guid=x.guid)),S?J.splice(J.delegateCount++,0,K):J.push(K),p.event.global[te]=!0)},remove:function(c,f,x,b,S){var T,L,z,U,W,K,he,J,te,Ie,Ge,Fe=ie.hasData(c)&&ie.get(c);if(Fe&&(U=Fe.events)){for(W=(f=(f||"").match(we)||[""]).length;W--;)if(te=Ge=(z=ys.exec(f[W])||[])[1],Ie=(z[2]||"").split(".").sort(),te){for(he=p.event.special[te]||{},J=U[te=(b?he.delegateType:he.bindType)||te]||[],z=z[2]&&new RegExp("(^|\\.)"+Ie.join("\\.(?:.*\\.|)")+"(\\.|$)"),L=T=J.length;T--;)K=J[T],!S&&Ge!==K.origType||x&&x.guid!==K.guid||z&&!z.test(K.namespace)||b&&b!==K.selector&&(b!=="**"||!K.selector)||(J.splice(T,1),K.selector&&J.delegateCount--,he.remove&&he.remove.call(c,K));L&&!J.length&&(he.teardown&&he.teardown.call(c,Ie,Fe.handle)!==!1||p.removeEvent(c,te,Fe.handle),delete U[te])}else for(te in U)p.event.remove(c,te+f[W],x,b,!0);p.isEmptyObject(U)&&ie.remove(c,"handle events")}},dispatch:function(c){var f,x,b,S,T,L,z=new Array(arguments.length),U=p.event.fix(c),W=(ie.get(this,"events")||Object.create(null))[U.type]||[],K=p.event.special[U.type]||{};for(z[0]=U,f=1;f<arguments.length;f++)z[f]=arguments[f];if(U.delegateTarget=this,!K.preDispatch||K.preDispatch.call(this,U)!==!1){for(L=p.event.handlers.call(this,U,W),f=0;(S=L[f++])&&!U.isPropagationStopped();)for(U.currentTarget=S.elem,x=0;(T=S.handlers[x++])&&!U.isImmediatePropagationStopped();)U.rnamespace&&T.namespace!==!1&&!U.rnamespace.test(T.namespace)||(U.handleObj=T,U.data=T.data,(b=((p.event.special[T.origType]||{}).handle||T.handler).apply(S.elem,z))!==void 0&&(U.result=b)===!1&&(U.preventDefault(),U.stopPropagation()));return K.postDispatch&&K.postDispatch.call(this,U),U.result}},handlers:function(c,f){var x,b,S,T,L,z=[],U=f.delegateCount,W=c.target;if(U&&W.nodeType&&!(c.type==="click"&&1<=c.button)){for(;W!==this;W=W.parentNode||this)if(W.nodeType===1&&(c.type!=="click"||W.disabled!==!0)){for(T=[],L={},x=0;x<U;x++)L[S=(b=f[x]).selector+" "]===void 0&&(L[S]=b.needsContext?-1<p(S,this).index(W):p.find(S,this,null,[W]).length),L[S]&&T.push(b);T.length&&z.push({elem:W,handlers:T})}}return W=this,U<f.length&&z.push({elem:W,handlers:f.slice(U)}),z},addProp:function(c,f){Object.defineProperty(p.Event.prototype,c,{enumerable:!0,configurable:!0,get:y(f)?function(){if(this.originalEvent)return f(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[c]},set:function(x){Object.defineProperty(this,c,{enumerable:!0,configurable:!0,writable:!0,value:x})}})},fix:function(c){return c[p.expando]?c:new p.Event(c)},special:{load:{noBubble:!0},click:{setup:function(c){var f=this||c;return ze.test(f.type)&&f.click&&B(f,"input")&&Ar(f,"click",yi),!1},trigger:function(c){var f=this||c;return ze.test(f.type)&&f.click&&B(f,"input")&&Ar(f,"click"),!0},_default:function(c){var f=c.target;return ze.test(f.type)&&f.click&&B(f,"input")&&ie.get(f,"click")||B(f,"a")}},beforeunload:{postDispatch:function(c){c.result!==void 0&&c.originalEvent&&(c.originalEvent.returnValue=c.result)}}}},p.removeEvent=function(c,f,x){c.removeEventListener&&c.removeEventListener(f,x)},p.Event=function(c,f){if(!(this instanceof p.Event))return new p.Event(c,f);c&&c.type?(this.originalEvent=c,this.type=c.type,this.isDefaultPrevented=c.defaultPrevented||c.defaultPrevented===void 0&&c.returnValue===!1?yi:vi,this.target=c.target&&c.target.nodeType===3?c.target.parentNode:c.target,this.currentTarget=c.currentTarget,this.relatedTarget=c.relatedTarget):this.type=c,f&&p.extend(this,f),this.timeStamp=c&&c.timeStamp||Date.now(),this[p.expando]=!0},p.Event.prototype={constructor:p.Event,isDefaultPrevented:vi,isPropagationStopped:vi,isImmediatePropagationStopped:vi,isSimulated:!1,preventDefault:function(){var c=this.originalEvent;this.isDefaultPrevented=yi,c&&!this.isSimulated&&c.preventDefault()},stopPropagation:function(){var c=this.originalEvent;this.isPropagationStopped=yi,c&&!this.isSimulated&&c.stopPropagation()},stopImmediatePropagation:function(){var c=this.originalEvent;this.isImmediatePropagationStopped=yi,c&&!this.isSimulated&&c.stopImmediatePropagation(),this.stopPropagation()}},p.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(c){var f=c.button;return c.which==null&&Ua.test(c.type)?c.charCode!=null?c.charCode:c.keyCode:!c.which&&f!==void 0&&tr.test(c.type)?1&f?1:2&f?3:4&f?2:0:c.which}},p.event.addProp),p.each({focus:"focusin",blur:"focusout"},function(c,f){p.event.special[c]={setup:function(){return Ar(this,c,Un),!1},trigger:function(){return Ar(this,c),!0},delegateType:f}}),p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(c,f){p.event.special[c]={delegateType:f,bindType:f,handle:function(x){var b,S=x.relatedTarget,T=x.handleObj;return S&&(S===this||p.contains(this,S))||(x.type=T.origType,b=T.handler.apply(this,arguments),x.type=f),b}}}),p.fn.extend({on:function(c,f,x,b){return Er(this,c,f,x,b)},one:function(c,f,x,b){return Er(this,c,f,x,b,1)},off:function(c,f,x){var b,S;if(c&&c.preventDefault&&c.handleObj)return b=c.handleObj,p(c.delegateTarget).off(b.namespace?b.origType+"."+b.namespace:b.origType,b.selector,b.handler),this;if(typeof c=="object"){for(S in c)this.off(S,f,c[S]);return this}return f!==!1&&typeof f!="function"||(x=f,f=void 0),x===!1&&(x=vi),this.each(function(){p.event.remove(this,c,x,f)})}});var Ga=/<script|<style|<link/i,I=/checked\s*(?:[^=]|=\s*.checked.)/i,re=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function ee(c,f){return B(c,"table")&&B(f.nodeType!==11?f:f.firstChild,"tr")&&p(c).children("tbody")[0]||c}function ce(c){return c.type=(c.getAttribute("type")!==null)+"/"+c.type,c}function Ce(c){return(c.type||"").slice(0,5)==="true/"?c.type=c.type.slice(5):c.removeAttribute("type"),c}function ut(c,f){var x,b,S,T,L,z;if(f.nodeType===1){if(ie.hasData(c)&&(z=ie.get(c).events))for(S in ie.remove(f,"handle events"),z)for(x=0,b=z[S].length;x<b;x++)p.event.add(f,S,z[S][x]);_e.hasData(c)&&(T=_e.access(c),L=p.extend({},T),_e.set(f,L))}}function $e(c,f,x,b){f=s(f);var S,T,L,z,U,W,K=0,he=c.length,J=he-1,te=f[0],Ie=y(te);if(Ie||1<he&&typeof te=="string"&&!m.checkClone&&I.test(te))return c.each(function(Ge){var Fe=c.eq(Ge);Ie&&(f[0]=te.call(this,Ge,Fe.html())),$e(Fe,f,x,b)});if(he&&(T=(S=Tr(f,c[0].ownerDocument,!1,c,b)).firstChild,S.childNodes.length===1&&(S=T),T||b)){for(z=(L=p.map(Rt(S,"script"),ce)).length;K<he;K++)U=S,K!==J&&(U=p.clone(U,!0,!0),z&&p.merge(L,Rt(U,"script"))),x.call(c[K],U,K);if(z)for(W=L[L.length-1].ownerDocument,p.map(L,Ce),K=0;K<z;K++)U=L[K],Gt.test(U.type||"")&&!ie.access(U,"globalEval")&&p.contains(W,U)&&(U.src&&(U.type||"").toLowerCase()!=="module"?p._evalUrl&&!U.noModule&&p._evalUrl(U.src,{nonce:U.nonce||U.getAttribute("nonce")},W):v(U.textContent.replace(re,""),U,W))}return c}function dt(c,f,x){for(var b,S=f?p.filter(f,c):c,T=0;(b=S[T])!=null;T++)x||b.nodeType!==1||p.cleanData(Rt(b)),b.parentNode&&(x&&ge(b)&&on(Rt(b,"script")),b.parentNode.removeChild(b));return c}p.extend({htmlPrefilter:function(c){return c},clone:function(c,f,x){var b,S,T,L,z,U,W,K=c.cloneNode(!0),he=ge(c);if(!(m.noCloneChecked||c.nodeType!==1&&c.nodeType!==11||p.isXMLDoc(c)))for(L=Rt(K),b=0,S=(T=Rt(c)).length;b<S;b++)z=T[b],U=L[b],(W=U.nodeName.toLowerCase())==="input"&&ze.test(z.type)?U.checked=z.checked:W!=="input"&&W!=="textarea"||(U.defaultValue=z.defaultValue);if(f)if(x)for(T=T||Rt(c),L=L||Rt(K),b=0,S=T.length;b<S;b++)ut(T[b],L[b]);else ut(c,K);return 0<(L=Rt(K,"script")).length&&on(L,!he&&Rt(c,"script")),K},cleanData:function(c){for(var f,x,b,S=p.event.special,T=0;(x=c[T])!==void 0;T++)if(Ze(x)){if(f=x[ie.expando]){if(f.events)for(b in f.events)S[b]?p.event.remove(x,b):p.removeEvent(x,b,f.handle);x[ie.expando]=void 0}x[_e.expando]&&(x[_e.expando]=void 0)}}}),p.fn.extend({detach:function(c){return dt(this,c,!0)},remove:function(c){return dt(this,c)},text:function(c){return bt(this,function(f){return f===void 0?p.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=f)})},null,c,arguments.length)},append:function(){return $e(this,arguments,function(c){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||ee(this,c).appendChild(c)})},prepend:function(){return $e(this,arguments,function(c){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var f=ee(this,c);f.insertBefore(c,f.firstChild)}})},before:function(){return $e(this,arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this)})},after:function(){return $e(this,arguments,function(c){this.parentNode&&this.parentNode.insertBefore(c,this.nextSibling)})},empty:function(){for(var c,f=0;(c=this[f])!=null;f++)c.nodeType===1&&(p.cleanData(Rt(c,!1)),c.textContent="");return this},clone:function(c,f){return c=c!=null&&c,f=f??c,this.map(function(){return p.clone(this,c,f)})},html:function(c){return bt(this,function(f){var x=this[0]||{},b=0,S=this.length;if(f===void 0&&x.nodeType===1)return x.innerHTML;if(typeof f=="string"&&!Ga.test(f)&&!$t[(gt.exec(f)||["",""])[1].toLowerCase()]){f=p.htmlPrefilter(f);try{for(;b<S;b++)(x=this[b]||{}).nodeType===1&&(p.cleanData(Rt(x,!1)),x.innerHTML=f);x=0}catch{}}x&&this.empty().append(f)},null,c,arguments.length)},replaceWith:function(){var c=[];return $e(this,arguments,function(f){var x=this.parentNode;p.inArray(this,c)<0&&(p.cleanData(Rt(this)),x&&x.replaceChild(f,this))},c)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(c,f){p.fn[c]=function(x){for(var b,S=[],T=p(x),L=T.length-1,z=0;z<=L;z++)b=z===L?this:this.clone(!0),p(T[z])[f](b),o.apply(S,b.get());return this.pushStack(S)}});var rt=new RegExp("^("+D+")(?!px)[a-z%]+$","i"),It=function(c){var f=c.ownerDocument.defaultView;return f&&f.opener||(f=t),f.getComputedStyle(c)},Ot=function(c,f,x){var b,S,T={};for(S in f)T[S]=c.style[S],c.style[S]=f[S];for(S in b=x.call(c),f)c.style[S]=T[S];return b},st=new RegExp(fe.join("|"),"i");function vt(c,f,x){var b,S,T,L,z=c.style;return(x=x||It(c))&&((L=x.getPropertyValue(f)||x[f])!==""||ge(c)||(L=p.style(c,f)),!m.pixelBoxStyles()&&rt.test(L)&&st.test(f)&&(b=z.width,S=z.minWidth,T=z.maxWidth,z.minWidth=z.maxWidth=z.width=L,L=x.width,z.width=b,z.minWidth=S,z.maxWidth=T)),L!==void 0?L+"":L}function In(c,f){return{get:function(){if(!c())return(this.get=f).apply(this,arguments);delete this.get}}}(function(){function c(){if(W){U.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",W.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",G.appendChild(U).appendChild(W);var K=t.getComputedStyle(W);x=K.top!=="1%",z=f(K.marginLeft)===12,W.style.right="60%",T=f(K.right)===36,b=f(K.width)===36,W.style.position="absolute",S=f(W.offsetWidth/3)===12,G.removeChild(U),W=null}}function f(K){return Math.round(parseFloat(K))}var x,b,S,T,L,z,U=M.createElement("div"),W=M.createElement("div");W.style&&(W.style.backgroundClip="content-box",W.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle=W.style.backgroundClip==="content-box",p.extend(m,{boxSizingReliable:function(){return c(),b},pixelBoxStyles:function(){return c(),T},pixelPosition:function(){return c(),x},reliableMarginLeft:function(){return c(),z},scrollboxSize:function(){return c(),S},reliableTrDimensions:function(){var K,he,J,te;return L==null&&(K=M.createElement("table"),he=M.createElement("tr"),J=M.createElement("div"),K.style.cssText="position:absolute;left:-11111px",he.style.height="1px",J.style.height="9px",G.appendChild(K).appendChild(he).appendChild(J),te=t.getComputedStyle(he),L=3<parseInt(te.height),G.removeChild(K)),L}}))})();var wt=["Webkit","Moz","ms"],ni=M.createElement("div").style,Ht={};function nr(c){var f=p.cssProps[c]||Ht[c];return f||(c in ni?c:Ht[c]=(function(x){for(var b=x[0].toUpperCase()+x.slice(1),S=wt.length;S--;)if((x=wt[S]+b)in ni)return x})(c)||c)}var an=/^(none|table(?!-c[ea]).+)/,Ii=/^--/,Ni={position:"absolute",visibility:"hidden",display:"block"},Oi={letterSpacing:"0",fontWeight:"400"};function Bl(c,f,x){var b=ve.exec(f);return b?Math.max(0,b[2]-(x||0))+(b[3]||"px"):f}function Ha(c,f,x,b,S,T){var L=f==="width"?1:0,z=0,U=0;if(x===(b?"border":"content"))return 0;for(;L<4;L+=2)x==="margin"&&(U+=p.css(c,x+fe[L],!0,S)),b?(x==="content"&&(U-=p.css(c,"padding"+fe[L],!0,S)),x!=="margin"&&(U-=p.css(c,"border"+fe[L]+"Width",!0,S))):(U+=p.css(c,"padding"+fe[L],!0,S),x!=="padding"?U+=p.css(c,"border"+fe[L]+"Width",!0,S):z+=p.css(c,"border"+fe[L]+"Width",!0,S));return!b&&0<=T&&(U+=Math.max(0,Math.ceil(c["offset"+f[0].toUpperCase()+f.slice(1)]-T-U-z-.5))||0),U}function Fl(c,f,x){var b=It(c),S=(!m.boxSizingReliable()||x)&&p.css(c,"boxSizing",!1,b)==="border-box",T=S,L=vt(c,f,b),z="offset"+f[0].toUpperCase()+f.slice(1);if(rt.test(L)){if(!x)return L;L="auto"}return(!m.boxSizingReliable()&&S||!m.reliableTrDimensions()&&B(c,"tr")||L==="auto"||!parseFloat(L)&&p.css(c,"display",!1,b)==="inline")&&c.getClientRects().length&&(S=p.css(c,"boxSizing",!1,b)==="border-box",(T=z in c)&&(L=c[z])),(L=parseFloat(L)||0)+Ha(c,f,x||(S?"border":"content"),T,b,L)+"px"}function Gn(c,f,x,b,S){return new Gn.prototype.init(c,f,x,b,S)}p.extend({cssHooks:{opacity:{get:function(c,f){if(f){var x=vt(c,"opacity");return x===""?"1":x}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(c,f,x,b){if(c&&c.nodeType!==3&&c.nodeType!==8&&c.style){var S,T,L,z=it(f),U=Ii.test(f),W=c.style;if(U||(f=nr(z)),L=p.cssHooks[f]||p.cssHooks[z],x===void 0)return L&&"get"in L&&(S=L.get(c,!1,b))!==void 0?S:W[f];(T=typeof x)=="string"&&(S=ve.exec(x))&&S[1]&&(x=Se(c,f,S),T="number"),x!=null&&x==x&&(T!=="number"||U||(x+=S&&S[3]||(p.cssNumber[z]?"":"px")),m.clearCloneStyle||x!==""||f.indexOf("background")!==0||(W[f]="inherit"),L&&"set"in L&&(x=L.set(c,x,b))===void 0||(U?W.setProperty(f,x):W[f]=x))}},css:function(c,f,x,b){var S,T,L,z=it(f);return Ii.test(f)||(f=nr(z)),(L=p.cssHooks[f]||p.cssHooks[z])&&"get"in L&&(S=L.get(c,!0,x)),S===void 0&&(S=vt(c,f,b)),S==="normal"&&f in Oi&&(S=Oi[f]),x===""||x?(T=parseFloat(S),x===!0||isFinite(T)?T||0:S):S}}),p.each(["height","width"],function(c,f){p.cssHooks[f]={get:function(x,b,S){if(b)return!an.test(p.css(x,"display"))||x.getClientRects().length&&x.getBoundingClientRect().width?Fl(x,f,S):Ot(x,Ni,function(){return Fl(x,f,S)})},set:function(x,b,S){var T,L=It(x),z=!m.scrollboxSize()&&L.position==="absolute",U=(z||S)&&p.css(x,"boxSizing",!1,L)==="border-box",W=S?Ha(x,f,S,U,L):0;return U&&z&&(W-=Math.ceil(x["offset"+f[0].toUpperCase()+f.slice(1)]-parseFloat(L[f])-Ha(x,f,"border",!1,L)-.5)),W&&(T=ve.exec(b))&&(T[3]||"px")!=="px"&&(x.style[f]=b,b=p.css(x,f)),Bl(0,b,W)}}}),p.cssHooks.marginLeft=In(m.reliableMarginLeft,function(c,f){if(f)return(parseFloat(vt(c,"marginLeft"))||c.getBoundingClientRect().left-Ot(c,{marginLeft:0},function(){return c.getBoundingClientRect().left}))+"px"}),p.each({margin:"",padding:"",border:"Width"},function(c,f){p.cssHooks[c+f]={expand:function(x){for(var b=0,S={},T=typeof x=="string"?x.split(" "):[x];b<4;b++)S[c+fe[b]+f]=T[b]||T[b-2]||T[0];return S}},c!=="margin"&&(p.cssHooks[c+f].set=Bl)}),p.fn.extend({css:function(c,f){return bt(this,function(x,b,S){var T,L,z={},U=0;if(Array.isArray(b)){for(T=It(x),L=b.length;U<L;U++)z[b[U]]=p.css(x,b[U],!1,T);return z}return S!==void 0?p.style(x,b,S):p.css(x,b)},c,f,1<arguments.length)}}),((p.Tween=Gn).prototype={constructor:Gn,init:function(c,f,x,b,S,T){this.elem=c,this.prop=x,this.easing=S||p.easing._default,this.options=f,this.start=this.now=this.cur(),this.end=b,this.unit=T||(p.cssNumber[x]?"":"px")},cur:function(){var c=Gn.propHooks[this.prop];return c&&c.get?c.get(this):Gn.propHooks._default.get(this)},run:function(c){var f,x=Gn.propHooks[this.prop];return this.options.duration?this.pos=f=p.easing[this.easing](c,this.options.duration*c,0,1,this.options.duration):this.pos=f=c,this.now=(this.end-this.start)*f+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),x&&x.set?x.set(this):Gn.propHooks._default.set(this),this}}).init.prototype=Gn.prototype,(Gn.propHooks={_default:{get:function(c){var f;return c.elem.nodeType!==1||c.elem[c.prop]!=null&&c.elem.style[c.prop]==null?c.elem[c.prop]:(f=p.css(c.elem,c.prop,""))&&f!=="auto"?f:0},set:function(c){p.fx.step[c.prop]?p.fx.step[c.prop](c):c.elem.nodeType!==1||!p.cssHooks[c.prop]&&c.elem.style[nr(c.prop)]==null?c.elem[c.prop]=c.now:p.style(c.elem,c.prop,c.now+c.unit)}}}).scrollTop=Gn.propHooks.scrollLeft={set:function(c){c.elem.nodeType&&c.elem.parentNode&&(c.elem[c.prop]=c.now)}},p.easing={linear:function(c){return c},swing:function(c){return .5-Math.cos(c*Math.PI)/2},_default:"swing"},p.fx=Gn.prototype.init,p.fx.step={};var Lr,mo,Cr,zl,Ff=/^(?:toggle|show|hide)$/,zf=/queueHooks$/;function Va(){mo&&(M.hidden===!1&&t.requestAnimationFrame?t.requestAnimationFrame(Va):t.setTimeout(Va,p.fx.interval),p.fx.tick())}function kl(){return t.setTimeout(function(){Lr=void 0}),Lr=Date.now()}function go(c,f){var x,b=0,S={height:c};for(f=f?1:0;b<4;b+=2-f)S["margin"+(x=fe[b])]=S["padding"+x]=c;return f&&(S.opacity=S.width=c),S}function Ul(c,f,x){for(var b,S=(Hn.tweeners[f]||[]).concat(Hn.tweeners["*"]),T=0,L=S.length;T<L;T++)if(b=S[T].call(x,f,c))return b}function Hn(c,f,x){var b,S,T=0,L=Hn.prefilters.length,z=p.Deferred().always(function(){delete U.elem}),U=function(){if(S)return!1;for(var he=Lr||kl(),J=Math.max(0,W.startTime+W.duration-he),te=1-(J/W.duration||0),Ie=0,Ge=W.tweens.length;Ie<Ge;Ie++)W.tweens[Ie].run(te);return z.notifyWith(c,[W,te,J]),te<1&&Ge?J:(Ge||z.notifyWith(c,[W,1,0]),z.resolveWith(c,[W]),!1)},W=z.promise({elem:c,props:p.extend({},f),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},x),originalProperties:f,originalOptions:x,startTime:Lr||kl(),duration:x.duration,tweens:[],createTween:function(he,J){var te=p.Tween(c,W.opts,he,J,W.opts.specialEasing[he]||W.opts.easing);return W.tweens.push(te),te},stop:function(he){var J=0,te=he?W.tweens.length:0;if(S)return this;for(S=!0;J<te;J++)W.tweens[J].run(1);return he?(z.notifyWith(c,[W,1,0]),z.resolveWith(c,[W,he])):z.rejectWith(c,[W,he]),this}}),K=W.props;for(!(function(he,J){var te,Ie,Ge,Fe,Ft;for(te in he)if(Ge=J[Ie=it(te)],Fe=he[te],Array.isArray(Fe)&&(Ge=Fe[1],Fe=he[te]=Fe[0]),te!==Ie&&(he[Ie]=Fe,delete he[te]),(Ft=p.cssHooks[Ie])&&"expand"in Ft)for(te in Fe=Ft.expand(Fe),delete he[Ie],Fe)te in he||(he[te]=Fe[te],J[te]=Ge);else J[Ie]=Ge})(K,W.opts.specialEasing);T<L;T++)if(b=Hn.prefilters[T].call(W,c,K,W.opts))return y(b.stop)&&(p._queueHooks(W.elem,W.opts.queue).stop=b.stop.bind(b)),b;return p.map(K,Ul,W),y(W.opts.start)&&W.opts.start.call(c,W),W.progress(W.opts.progress).done(W.opts.done,W.opts.complete).fail(W.opts.fail).always(W.opts.always),p.fx.timer(p.extend(U,{elem:c,anim:W,queue:W.opts.queue})),W}p.Animation=p.extend(Hn,{tweeners:{"*":[function(c,f){var x=this.createTween(c,f);return Se(x.elem,c,ve.exec(f),x),x}]},tweener:function(c,f){y(c)?(f=c,c=["*"]):c=c.match(we);for(var x,b=0,S=c.length;b<S;b++)x=c[b],Hn.tweeners[x]=Hn.tweeners[x]||[],Hn.tweeners[x].unshift(f)},prefilters:[function(c,f,x){var b,S,T,L,z,U,W,K,he="width"in f||"height"in f,J=this,te={},Ie=c.style,Ge=c.nodeType&&Be(c),Fe=ie.get(c,"fxshow");for(b in x.queue||((L=p._queueHooks(c,"fx")).unqueued==null&&(L.unqueued=0,z=L.empty.fire,L.empty.fire=function(){L.unqueued||z()}),L.unqueued++,J.always(function(){J.always(function(){L.unqueued--,p.queue(c,"fx").length||L.empty.fire()})})),f)if(S=f[b],Ff.test(S)){if(delete f[b],T=T||S==="toggle",S===(Ge?"hide":"show")){if(S!=="show"||!Fe||Fe[b]===void 0)continue;Ge=!0}te[b]=Fe&&Fe[b]||p.style(c,b)}if((U=!p.isEmptyObject(f))||!p.isEmptyObject(te))for(b in he&&c.nodeType===1&&(x.overflow=[Ie.overflow,Ie.overflowX,Ie.overflowY],(W=Fe&&Fe.display)==null&&(W=ie.get(c,"display")),(K=p.css(c,"display"))==="none"&&(W?K=W:(xe([c],!0),W=c.style.display||W,K=p.css(c,"display"),xe([c]))),(K==="inline"||K==="inline-block"&&W!=null)&&p.css(c,"float")==="none"&&(U||(J.done(function(){Ie.display=W}),W==null&&(K=Ie.display,W=K==="none"?"":K)),Ie.display="inline-block")),x.overflow&&(Ie.overflow="hidden",J.always(function(){Ie.overflow=x.overflow[0],Ie.overflowX=x.overflow[1],Ie.overflowY=x.overflow[2]})),U=!1,te)U||(Fe?"hidden"in Fe&&(Ge=Fe.hidden):Fe=ie.access(c,"fxshow",{display:W}),T&&(Fe.hidden=!Ge),Ge&&xe([c],!0),J.done(function(){for(b in Ge||xe([c]),ie.remove(c,"fxshow"),te)p.style(c,b,te[b])})),U=Ul(Ge?Fe[b]:0,b,J),b in Fe||(Fe[b]=U.start,Ge&&(U.end=U.start,U.start=0))}],prefilter:function(c,f){f?Hn.prefilters.unshift(c):Hn.prefilters.push(c)}}),p.speed=function(c,f,x){var b=c&&typeof c=="object"?p.extend({},c):{complete:x||!x&&f||y(c)&&c,duration:c,easing:x&&f||f&&!y(f)&&f};return p.fx.off?b.duration=0:typeof b.duration!="number"&&(b.duration in p.fx.speeds?b.duration=p.fx.speeds[b.duration]:b.duration=p.fx.speeds._default),b.queue!=null&&b.queue!==!0||(b.queue="fx"),b.old=b.complete,b.complete=function(){y(b.old)&&b.old.call(this),b.queue&&p.dequeue(this,b.queue)},b},p.fn.extend({fadeTo:function(c,f,x,b){return this.filter(Be).css("opacity",0).show().end().animate({opacity:f},c,x,b)},animate:function(c,f,x,b){var S=p.isEmptyObject(c),T=p.speed(f,x,b),L=function(){var z=Hn(this,p.extend({},c),T);(S||ie.get(this,"finish"))&&z.stop(!0)};return L.finish=L,S||T.queue===!1?this.each(L):this.queue(T.queue,L)},stop:function(c,f,x){var b=function(S){var T=S.stop;delete S.stop,T(x)};return typeof c!="string"&&(x=f,f=c,c=void 0),f&&this.queue(c||"fx",[]),this.each(function(){var S=!0,T=c!=null&&c+"queueHooks",L=p.timers,z=ie.get(this);if(T)z[T]&&z[T].stop&&b(z[T]);else for(T in z)z[T]&&z[T].stop&&zf.test(T)&&b(z[T]);for(T=L.length;T--;)L[T].elem!==this||c!=null&&L[T].queue!==c||(L[T].anim.stop(x),S=!1,L.splice(T,1));!S&&x||p.dequeue(this,c)})},finish:function(c){return c!==!1&&(c=c||"fx"),this.each(function(){var f,x=ie.get(this),b=x[c+"queue"],S=x[c+"queueHooks"],T=p.timers,L=b?b.length:0;for(x.finish=!0,p.queue(this,c,[]),S&&S.stop&&S.stop.call(this,!0),f=T.length;f--;)T[f].elem===this&&T[f].queue===c&&(T[f].anim.stop(!0),T.splice(f,1));for(f=0;f<L;f++)b[f]&&b[f].finish&&b[f].finish.call(this);delete x.finish})}}),p.each(["toggle","show","hide"],function(c,f){var x=p.fn[f];p.fn[f]=function(b,S,T){return b==null||typeof b=="boolean"?x.apply(this,arguments):this.animate(go(f,!0),b,S,T)}}),p.each({slideDown:go("show"),slideUp:go("hide"),slideToggle:go("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(c,f){p.fn[c]=function(x,b,S){return this.animate(f,x,b,S)}}),p.timers=[],p.fx.tick=function(){var c,f=0,x=p.timers;for(Lr=Date.now();f<x.length;f++)(c=x[f])()||x[f]!==c||x.splice(f--,1);x.length||p.fx.stop(),Lr=void 0},p.fx.timer=function(c){p.timers.push(c),p.fx.start()},p.fx.interval=13,p.fx.start=function(){mo||(mo=!0,Va())},p.fx.stop=function(){mo=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(c,f){return c=p.fx&&p.fx.speeds[c]||c,f=f||"fx",this.queue(f,function(x,b){var S=t.setTimeout(x,c);b.stop=function(){t.clearTimeout(S)}})},Cr=M.createElement("input"),zl=M.createElement("select").appendChild(M.createElement("option")),Cr.type="checkbox",m.checkOn=Cr.value!=="",m.optSelected=zl.selected,(Cr=M.createElement("input")).value="t",Cr.type="radio",m.radioValue=Cr.value==="t";var Gl,vs=p.expr.attrHandle;p.fn.extend({attr:function(c,f){return bt(this,p.attr,c,f,1<arguments.length)},removeAttr:function(c){return this.each(function(){p.removeAttr(this,c)})}}),p.extend({attr:function(c,f,x){var b,S,T=c.nodeType;if(T!==3&&T!==8&&T!==2)return typeof c.getAttribute>"u"?p.prop(c,f,x):(T===1&&p.isXMLDoc(c)||(S=p.attrHooks[f.toLowerCase()]||(p.expr.match.bool.test(f)?Gl:void 0)),x!==void 0?x===null?void p.removeAttr(c,f):S&&"set"in S&&(b=S.set(c,x,f))!==void 0?b:(c.setAttribute(f,x+""),x):S&&"get"in S&&(b=S.get(c,f))!==null?b:(b=p.find.attr(c,f))==null?void 0:b)},attrHooks:{type:{set:function(c,f){if(!m.radioValue&&f==="radio"&&B(c,"input")){var x=c.value;return c.setAttribute("type",f),x&&(c.value=x),f}}}},removeAttr:function(c,f){var x,b=0,S=f&&f.match(we);if(S&&c.nodeType===1)for(;x=S[b++];)c.removeAttribute(x)}}),Gl={set:function(c,f,x){return f===!1?p.removeAttr(c,x):c.setAttribute(x,x),x}},p.each(p.expr.match.bool.source.match(/\w+/g),function(c,f){var x=vs[f]||p.find.attr;vs[f]=function(b,S,T){var L,z,U=S.toLowerCase();return T||(z=vs[U],vs[U]=L,L=x(b,S,T)!=null?U:null,vs[U]=z),L}});var kf=/^(?:input|select|textarea|button)$/i,Uf=/^(?:a|area)$/i;function ir(c){return(c.match(we)||[]).join(" ")}function rr(c){return c.getAttribute&&c.getAttribute("class")||""}function Wa(c){return Array.isArray(c)?c:typeof c=="string"&&c.match(we)||[]}p.fn.extend({prop:function(c,f){return bt(this,p.prop,c,f,1<arguments.length)},removeProp:function(c){return this.each(function(){delete this[p.propFix[c]||c]})}}),p.extend({prop:function(c,f,x){var b,S,T=c.nodeType;if(T!==3&&T!==8&&T!==2)return T===1&&p.isXMLDoc(c)||(f=p.propFix[f]||f,S=p.propHooks[f]),x!==void 0?S&&"set"in S&&(b=S.set(c,x,f))!==void 0?b:c[f]=x:S&&"get"in S&&(b=S.get(c,f))!==null?b:c[f]},propHooks:{tabIndex:{get:function(c){var f=p.find.attr(c,"tabindex");return f?parseInt(f,10):kf.test(c.nodeName)||Uf.test(c.nodeName)&&c.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(p.propHooks.selected={get:function(c){var f=c.parentNode;return f&&f.parentNode&&f.parentNode.selectedIndex,null},set:function(c){var f=c.parentNode;f&&(f.selectedIndex,f.parentNode&&f.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this}),p.fn.extend({addClass:function(c){var f,x,b,S,T,L,z,U=0;if(y(c))return this.each(function(W){p(this).addClass(c.call(this,W,rr(this)))});if((f=Wa(c)).length){for(;x=this[U++];)if(S=rr(x),b=x.nodeType===1&&" "+ir(S)+" "){for(L=0;T=f[L++];)b.indexOf(" "+T+" ")<0&&(b+=T+" ");S!==(z=ir(b))&&x.setAttribute("class",z)}}return this},removeClass:function(c){var f,x,b,S,T,L,z,U=0;if(y(c))return this.each(function(W){p(this).removeClass(c.call(this,W,rr(this)))});if(!arguments.length)return this.attr("class","");if((f=Wa(c)).length){for(;x=this[U++];)if(S=rr(x),b=x.nodeType===1&&" "+ir(S)+" "){for(L=0;T=f[L++];)for(;-1<b.indexOf(" "+T+" ");)b=b.replace(" "+T+" "," ");S!==(z=ir(b))&&x.setAttribute("class",z)}}return this},toggleClass:function(c,f){var x=typeof c,b=x==="string"||Array.isArray(c);return typeof f=="boolean"&&b?f?this.addClass(c):this.removeClass(c):y(c)?this.each(function(S){p(this).toggleClass(c.call(this,S,rr(this),f),f)}):this.each(function(){var S,T,L,z;if(b)for(T=0,L=p(this),z=Wa(c);S=z[T++];)L.hasClass(S)?L.removeClass(S):L.addClass(S);else c!==void 0&&x!=="boolean"||((S=rr(this))&&ie.set(this,"__className__",S),this.setAttribute&&this.setAttribute("class",S||c===!1?"":ie.get(this,"__className__")||""))})},hasClass:function(c){var f,x,b=0;for(f=" "+c+" ";x=this[b++];)if(x.nodeType===1&&-1<(" "+ir(rr(x))+" ").indexOf(f))return!0;return!1}});var Gf=/\r/g;p.fn.extend({val:function(c){var f,x,b,S=this[0];return arguments.length?(b=y(c),this.each(function(T){var L;this.nodeType===1&&((L=b?c.call(this,T,p(this).val()):c)==null?L="":typeof L=="number"?L+="":Array.isArray(L)&&(L=p.map(L,function(z){return z==null?"":z+""})),(f=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in f&&f.set(this,L,"value")!==void 0||(this.value=L))})):S?(f=p.valHooks[S.type]||p.valHooks[S.nodeName.toLowerCase()])&&"get"in f&&(x=f.get(S,"value"))!==void 0?x:typeof(x=S.value)=="string"?x.replace(Gf,""):x??"":void 0}}),p.extend({valHooks:{option:{get:function(c){var f=p.find.attr(c,"value");return f??ir(p.text(c))}},select:{get:function(c){var f,x,b,S=c.options,T=c.selectedIndex,L=c.type==="select-one",z=L?null:[],U=L?T+1:S.length;for(b=T<0?U:L?T:0;b<U;b++)if(((x=S[b]).selected||b===T)&&!x.disabled&&(!x.parentNode.disabled||!B(x.parentNode,"optgroup"))){if(f=p(x).val(),L)return f;z.push(f)}return z},set:function(c,f){for(var x,b,S=c.options,T=p.makeArray(f),L=S.length;L--;)((b=S[L]).selected=-1<p.inArray(p.valHooks.option.get(b),T))&&(x=!0);return x||(c.selectedIndex=-1),T}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(c,f){if(Array.isArray(f))return c.checked=-1<p.inArray(p(c).val(),f)}},m.checkOn||(p.valHooks[this].get=function(c){return c.getAttribute("value")===null?"on":c.value})}),m.focusin="onfocusin"in t;var Hl=/^(?:focusinfocus|focusoutblur)$/,Vl=function(c){c.stopPropagation()};p.extend(p.event,{trigger:function(c,f,x,b){var S,T,L,z,U,W,K,he,J=[x||M],te=d.call(c,"type")?c.type:c,Ie=d.call(c,"namespace")?c.namespace.split("."):[];if(T=he=L=x=x||M,x.nodeType!==3&&x.nodeType!==8&&!Hl.test(te+p.event.triggered)&&(-1<te.indexOf(".")&&(te=(Ie=te.split(".")).shift(),Ie.sort()),U=te.indexOf(":")<0&&"on"+te,(c=c[p.expando]?c:new p.Event(te,typeof c=="object"&&c)).isTrigger=b?2:3,c.namespace=Ie.join("."),c.rnamespace=c.namespace?new RegExp("(^|\\.)"+Ie.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=void 0,c.target||(c.target=x),f=f==null?[c]:p.makeArray(f,[c]),K=p.event.special[te]||{},b||!K.trigger||K.trigger.apply(x,f)!==!1)){if(!b&&!K.noBubble&&!w(x)){for(z=K.delegateType||te,Hl.test(z+te)||(T=T.parentNode);T;T=T.parentNode)J.push(T),L=T;L===(x.ownerDocument||M)&&J.push(L.defaultView||L.parentWindow||t)}for(S=0;(T=J[S++])&&!c.isPropagationStopped();)he=T,c.type=1<S?z:K.bindType||te,(W=(ie.get(T,"events")||Object.create(null))[c.type]&&ie.get(T,"handle"))&&W.apply(T,f),(W=U&&T[U])&&W.apply&&Ze(T)&&(c.result=W.apply(T,f),c.result===!1&&c.preventDefault());return c.type=te,b||c.isDefaultPrevented()||K._default&&K._default.apply(J.pop(),f)!==!1||!Ze(x)||U&&y(x[te])&&!w(x)&&((L=x[U])&&(x[U]=null),p.event.triggered=te,c.isPropagationStopped()&&he.addEventListener(te,Vl),x[te](),c.isPropagationStopped()&&he.removeEventListener(te,Vl),p.event.triggered=void 0,L&&(x[U]=L)),c.result}},simulate:function(c,f,x){var b=p.extend(new p.Event,x,{type:c,isSimulated:!0});p.event.trigger(b,null,f)}}),p.fn.extend({trigger:function(c,f){return this.each(function(){p.event.trigger(c,f,this)})},triggerHandler:function(c,f){var x=this[0];if(x)return p.event.trigger(c,f,x,!0)}}),m.focusin||p.each({focus:"focusin",blur:"focusout"},function(c,f){var x=function(b){p.event.simulate(f,b.target,p.event.fix(b))};p.event.special[f]={setup:function(){var b=this.ownerDocument||this.document||this,S=ie.access(b,f);S||b.addEventListener(c,x,!0),ie.access(b,f,(S||0)+1)},teardown:function(){var b=this.ownerDocument||this.document||this,S=ie.access(b,f)-1;S?ie.access(b,f,S):(b.removeEventListener(c,x,!0),ie.remove(b,f))}}});var xs=t.location,Wl={guid:Date.now()},ja=/\?/;p.parseXML=function(c){var f;if(!c||typeof c!="string")return null;try{f=new t.DOMParser().parseFromString(c,"text/xml")}catch{f=void 0}return f&&!f.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+c),f};var Hf=/\[\]$/,jl=/\r?\n/g,Vf=/^(?:submit|button|image|reset|file)$/i,Wf=/^(?:input|select|textarea|keygen)/i;function qa(c,f,x,b){var S;if(Array.isArray(f))p.each(f,function(T,L){x||Hf.test(c)?b(c,L):qa(c+"["+(typeof L=="object"&&L!=null?T:"")+"]",L,x,b)});else if(x||E(f)!=="object")b(c,f);else for(S in f)qa(c+"["+S+"]",f[S],x,b)}p.param=function(c,f){var x,b=[],S=function(T,L){var z=y(L)?L():L;b[b.length]=encodeURIComponent(T)+"="+encodeURIComponent(z??"")};if(c==null)return"";if(Array.isArray(c)||c.jquery&&!p.isPlainObject(c))p.each(c,function(){S(this.name,this.value)});else for(x in c)qa(x,c[x],f,S);return b.join("&")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var c=p.prop(this,"elements");return c?p.makeArray(c):this}).filter(function(){var c=this.type;return this.name&&!p(this).is(":disabled")&&Wf.test(this.nodeName)&&!Vf.test(c)&&(this.checked||!ze.test(c))}).map(function(c,f){var x=p(this).val();return x==null?null:Array.isArray(x)?p.map(x,function(b){return{name:f.name,value:b.replace(jl,`\r
`)}}):{name:f.name,value:x.replace(jl,`\r
`)}}).get()}});var jf=/%20/g,qf=/#.*$/,Xf=/([?&])_=[^&]*/,Yf=/^(.*?):[ \t]*([^\r\n]*)$/gm,Zf=/^(?:GET|HEAD)$/,Jf=/^\/\//,ql={},Xa={},Xl="*/".concat("*"),Ya=M.createElement("a");function Yl(c){return function(f,x){typeof f!="string"&&(x=f,f="*");var b,S=0,T=f.toLowerCase().match(we)||[];if(y(x))for(;b=T[S++];)b[0]==="+"?(b=b.slice(1)||"*",(c[b]=c[b]||[]).unshift(x)):(c[b]=c[b]||[]).push(x)}}function Zl(c,f,x,b){var S={},T=c===Xa;function L(z){var U;return S[z]=!0,p.each(c[z]||[],function(W,K){var he=K(f,x,b);return typeof he!="string"||T||S[he]?T?!(U=he):void 0:(f.dataTypes.unshift(he),L(he),!1)}),U}return L(f.dataTypes[0])||!S["*"]&&L("*")}function Za(c,f){var x,b,S=p.ajaxSettings.flatOptions||{};for(x in f)f[x]!==void 0&&((S[x]?c:b||(b={}))[x]=f[x]);return b&&p.extend(!0,c,b),c}Ya.href=xs.href,p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:xs.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(xs.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xl,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(c,f){return f?Za(Za(c,p.ajaxSettings),f):Za(p.ajaxSettings,c)},ajaxPrefilter:Yl(ql),ajaxTransport:Yl(Xa),ajax:function(c,f){typeof c=="object"&&(f=c,c=void 0),f=f||{};var x,b,S,T,L,z,U,W,K,he,J=p.ajaxSetup({},f),te=J.context||J,Ie=J.context&&(te.nodeType||te.jquery)?p(te):p.event,Ge=p.Deferred(),Fe=p.Callbacks("once memory"),Ft=J.statusCode||{},Xt={},wn={},Mt="canceled",et={readyState:0,getResponseHeader:function(yt){var zt;if(U){if(!T)for(T={};zt=Yf.exec(S);)T[zt[1].toLowerCase()+" "]=(T[zt[1].toLowerCase()+" "]||[]).concat(zt[2]);zt=T[yt.toLowerCase()+" "]}return zt==null?null:zt.join(", ")},getAllResponseHeaders:function(){return U?S:null},setRequestHeader:function(yt,zt){return U==null&&(yt=wn[yt.toLowerCase()]=wn[yt.toLowerCase()]||yt,Xt[yt]=zt),this},overrideMimeType:function(yt){return U==null&&(J.mimeType=yt),this},statusCode:function(yt){var zt;if(yt)if(U)et.always(yt[et.status]);else for(zt in yt)Ft[zt]=[Ft[zt],yt[zt]];return this},abort:function(yt){var zt=yt||Mt;return x&&x.abort(zt),yn(0,zt),this}};if(Ge.promise(et),J.url=((c||J.url||xs.href)+"").replace(Jf,xs.protocol+"//"),J.type=f.method||f.type||J.method||J.type,J.dataTypes=(J.dataType||"*").toLowerCase().match(we)||[""],J.crossDomain==null){z=M.createElement("a");try{z.href=J.url,z.href=z.href,J.crossDomain=Ya.protocol+"//"+Ya.host!=z.protocol+"//"+z.host}catch{J.crossDomain=!0}}if(J.data&&J.processData&&typeof J.data!="string"&&(J.data=p.param(J.data,J.traditional)),Zl(ql,J,f,et),U)return et;for(K in(W=p.event&&J.global)&&p.active++==0&&p.event.trigger("ajaxStart"),J.type=J.type.toUpperCase(),J.hasContent=!Zf.test(J.type),b=J.url.replace(qf,""),J.hasContent?J.data&&J.processData&&(J.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(J.data=J.data.replace(jf,"+")):(he=J.url.slice(b.length),J.data&&(J.processData||typeof J.data=="string")&&(b+=(ja.test(b)?"&":"?")+J.data,delete J.data),J.cache===!1&&(b=b.replace(Xf,"$1"),he=(ja.test(b)?"&":"?")+"_="+Wl.guid+++he),J.url=b+he),J.ifModified&&(p.lastModified[b]&&et.setRequestHeader("If-Modified-Since",p.lastModified[b]),p.etag[b]&&et.setRequestHeader("If-None-Match",p.etag[b])),(J.data&&J.hasContent&&J.contentType!==!1||f.contentType)&&et.setRequestHeader("Content-Type",J.contentType),et.setRequestHeader("Accept",J.dataTypes[0]&&J.accepts[J.dataTypes[0]]?J.accepts[J.dataTypes[0]]+(J.dataTypes[0]!=="*"?", "+Xl+"; q=0.01":""):J.accepts["*"]),J.headers)et.setRequestHeader(K,J.headers[K]);if(J.beforeSend&&(J.beforeSend.call(te,et,J)===!1||U))return et.abort();if(Mt="abort",Fe.add(J.complete),et.done(J.success),et.fail(J.error),x=Zl(Xa,J,f,et)){if(et.readyState=1,W&&Ie.trigger("ajaxSend",[et,J]),U)return et;J.async&&0<J.timeout&&(L=t.setTimeout(function(){et.abort("timeout")},J.timeout));try{U=!1,x.send(Xt,yn)}catch(yt){if(U)throw yt;yn(-1,yt)}}else yn(-1,"No Transport");function yn(yt,zt,bs,yo){var Mn,sr,Rr,vn,Pr,Nn=zt;U||(U=!0,L&&t.clearTimeout(L),x=void 0,S=yo||"",et.readyState=0<yt?4:0,Mn=200<=yt&&yt<300||yt===304,bs&&(vn=(function(kt,Sn,Tn){for(var ii,nt,xt,Yt,En=kt.contents,jt=kt.dataTypes;jt[0]==="*";)jt.shift(),ii===void 0&&(ii=kt.mimeType||Sn.getResponseHeader("Content-Type"));if(ii){for(nt in En)if(En[nt]&&En[nt].test(ii)){jt.unshift(nt);break}}if(jt[0]in Tn)xt=jt[0];else{for(nt in Tn){if(!jt[0]||kt.converters[nt+" "+jt[0]]){xt=nt;break}Yt||(Yt=nt)}xt=xt||Yt}if(xt)return xt!==jt[0]&&jt.unshift(xt),Tn[xt]})(J,et,bs)),!Mn&&-1<p.inArray("script",J.dataTypes)&&(J.converters["text script"]=function(){}),vn=(function(kt,Sn,Tn,ii){var nt,xt,Yt,En,jt,An={},Dr=kt.dataTypes.slice();if(Dr[1])for(Yt in kt.converters)An[Yt.toLowerCase()]=kt.converters[Yt];for(xt=Dr.shift();xt;)if(kt.responseFields[xt]&&(Tn[kt.responseFields[xt]]=Sn),!jt&&ii&&kt.dataFilter&&(Sn=kt.dataFilter(Sn,kt.dataType)),jt=xt,xt=Dr.shift()){if(xt==="*")xt=jt;else if(jt!=="*"&&jt!==xt){if(!(Yt=An[jt+" "+xt]||An["* "+xt])){for(nt in An)if((En=nt.split(" "))[1]===xt&&(Yt=An[jt+" "+En[0]]||An["* "+En[0]])){Yt===!0?Yt=An[nt]:An[nt]!==!0&&(xt=En[0],Dr.unshift(En[1]));break}}if(Yt!==!0)if(Yt&&kt.throws)Sn=Yt(Sn);else try{Sn=Yt(Sn)}catch(vo){return{state:"parsererror",error:Yt?vo:"No conversion from "+jt+" to "+xt}}}}return{state:"success",data:Sn}})(J,vn,et,Mn),Mn?(J.ifModified&&((Pr=et.getResponseHeader("Last-Modified"))&&(p.lastModified[b]=Pr),(Pr=et.getResponseHeader("etag"))&&(p.etag[b]=Pr)),yt===204||J.type==="HEAD"?Nn="nocontent":yt===304?Nn="notmodified":(Nn=vn.state,sr=vn.data,Mn=!(Rr=vn.error))):(Rr=Nn,!yt&&Nn||(Nn="error",yt<0&&(yt=0))),et.status=yt,et.statusText=(zt||Nn)+"",Mn?Ge.resolveWith(te,[sr,Nn,et]):Ge.rejectWith(te,[et,Nn,Rr]),et.statusCode(Ft),Ft=void 0,W&&Ie.trigger(Mn?"ajaxSuccess":"ajaxError",[et,J,Mn?sr:Rr]),Fe.fireWith(te,[et,Nn]),W&&(Ie.trigger("ajaxComplete",[et,J]),--p.active||p.event.trigger("ajaxStop")))}return et},getJSON:function(c,f,x){return p.get(c,f,x,"json")},getScript:function(c,f){return p.get(c,void 0,f,"script")}}),p.each(["get","post"],function(c,f){p[f]=function(x,b,S,T){return y(b)&&(T=T||S,S=b,b=void 0),p.ajax(p.extend({url:x,type:f,dataType:T,data:b,success:S},p.isPlainObject(x)&&x))}}),p.ajaxPrefilter(function(c){var f;for(f in c.headers)f.toLowerCase()==="content-type"&&(c.contentType=c.headers[f]||"")}),p._evalUrl=function(c,f,x){return p.ajax({url:c,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(b){p.globalEval(b,f,x)}})},p.fn.extend({wrapAll:function(c){var f;return this[0]&&(y(c)&&(c=c.call(this[0])),f=p(c,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&f.insertBefore(this[0]),f.map(function(){for(var x=this;x.firstElementChild;)x=x.firstElementChild;return x}).append(this)),this},wrapInner:function(c){return y(c)?this.each(function(f){p(this).wrapInner(c.call(this,f))}):this.each(function(){var f=p(this),x=f.contents();x.length?x.wrapAll(c):f.append(c)})},wrap:function(c){var f=y(c);return this.each(function(x){p(this).wrapAll(f?c.call(this,x):c)})},unwrap:function(c){return this.parent(c).not("body").each(function(){p(this).replaceWith(this.childNodes)}),this}}),p.expr.pseudos.hidden=function(c){return!p.expr.pseudos.visible(c)},p.expr.pseudos.visible=function(c){return!!(c.offsetWidth||c.offsetHeight||c.getClientRects().length)},p.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch{}};var $f={0:200,1223:204},_s=p.ajaxSettings.xhr();m.cors=!!_s&&"withCredentials"in _s,m.ajax=_s=!!_s,p.ajaxTransport(function(c){var f,x;if(m.cors||_s&&!c.crossDomain)return{send:function(b,S){var T,L=c.xhr();if(L.open(c.type,c.url,c.async,c.username,c.password),c.xhrFields)for(T in c.xhrFields)L[T]=c.xhrFields[T];for(T in c.mimeType&&L.overrideMimeType&&L.overrideMimeType(c.mimeType),c.crossDomain||b["X-Requested-With"]||(b["X-Requested-With"]="XMLHttpRequest"),b)L.setRequestHeader(T,b[T]);f=function(z){return function(){f&&(f=x=L.onload=L.onerror=L.onabort=L.ontimeout=L.onreadystatechange=null,z==="abort"?L.abort():z==="error"?typeof L.status!="number"?S(0,"error"):S(L.status,L.statusText):S($f[L.status]||L.status,L.statusText,(L.responseType||"text")!=="text"||typeof L.responseText!="string"?{binary:L.response}:{text:L.responseText},L.getAllResponseHeaders()))}},L.onload=f(),x=L.onerror=L.ontimeout=f("error"),L.onabort!==void 0?L.onabort=x:L.onreadystatechange=function(){L.readyState===4&&t.setTimeout(function(){f&&x()})},f=f("abort");try{L.send(c.hasContent&&c.data||null)}catch(z){if(f)throw z}},abort:function(){f&&f()}}}),p.ajaxPrefilter(function(c){c.crossDomain&&(c.contents.script=!1)}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(c){return p.globalEval(c),c}}}),p.ajaxPrefilter("script",function(c){c.cache===void 0&&(c.cache=!1),c.crossDomain&&(c.type="GET")}),p.ajaxTransport("script",function(c){var f,x;if(c.crossDomain||c.scriptAttrs)return{send:function(b,S){f=p("<script>").attr(c.scriptAttrs||{}).prop({charset:c.scriptCharset,src:c.url}).on("load error",x=function(T){f.remove(),x=null,T&&S(T.type==="error"?404:200,T.type)}),M.head.appendChild(f[0])},abort:function(){x&&x()}}});var Jl,$l=[],Ja=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var c=$l.pop()||p.expando+"_"+Wl.guid++;return this[c]=!0,c}}),p.ajaxPrefilter("json jsonp",function(c,f,x){var b,S,T,L=c.jsonp!==!1&&(Ja.test(c.url)?"url":typeof c.data=="string"&&(c.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Ja.test(c.data)&&"data");if(L||c.dataTypes[0]==="jsonp")return b=c.jsonpCallback=y(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,L?c[L]=c[L].replace(Ja,"$1"+b):c.jsonp!==!1&&(c.url+=(ja.test(c.url)?"&":"?")+c.jsonp+"="+b),c.converters["script json"]=function(){return T||p.error(b+" was not called"),T[0]},c.dataTypes[0]="json",S=t[b],t[b]=function(){T=arguments},x.always(function(){S===void 0?p(t).removeProp(b):t[b]=S,c[b]&&(c.jsonpCallback=f.jsonpCallback,$l.push(b)),T&&y(S)&&S(T[0]),T=S=void 0}),"script"}),m.createHTMLDocument=((Jl=M.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",Jl.childNodes.length===2),p.parseHTML=function(c,f,x){return typeof c!="string"?[]:(typeof f=="boolean"&&(x=f,f=!1),f||(m.createHTMLDocument?((b=(f=M.implementation.createHTMLDocument("")).createElement("base")).href=M.location.href,f.head.appendChild(b)):f=M),T=!x&&[],(S=j.exec(c))?[f.createElement(S[1])]:(S=Tr([c],f,T),T&&T.length&&p(T).remove(),p.merge([],S.childNodes)));var b,S,T},p.fn.load=function(c,f,x){var b,S,T,L=this,z=c.indexOf(" ");return-1<z&&(b=ir(c.slice(z)),c=c.slice(0,z)),y(f)?(x=f,f=void 0):f&&typeof f=="object"&&(S="POST"),0<L.length&&p.ajax({url:c,type:S||"GET",dataType:"html",data:f}).done(function(U){T=arguments,L.html(b?p("<div>").append(p.parseHTML(U)).find(b):U)}).always(x&&function(U,W){L.each(function(){x.apply(this,T||[U.responseText,W,U])})}),this},p.expr.pseudos.animated=function(c){return p.grep(p.timers,function(f){return c===f.elem}).length},p.offset={setOffset:function(c,f,x){var b,S,T,L,z,U,W=p.css(c,"position"),K=p(c),he={};W==="static"&&(c.style.position="relative"),z=K.offset(),T=p.css(c,"top"),U=p.css(c,"left"),(W==="absolute"||W==="fixed")&&-1<(T+U).indexOf("auto")?(L=(b=K.position()).top,S=b.left):(L=parseFloat(T)||0,S=parseFloat(U)||0),y(f)&&(f=f.call(c,x,p.extend({},z))),f.top!=null&&(he.top=f.top-z.top+L),f.left!=null&&(he.left=f.left-z.left+S),"using"in f?f.using.call(c,he):(typeof he.top=="number"&&(he.top+="px"),typeof he.left=="number"&&(he.left+="px"),K.css(he))}},p.fn.extend({offset:function(c){if(arguments.length)return c===void 0?this:this.each(function(S){p.offset.setOffset(this,c,S)});var f,x,b=this[0];return b?b.getClientRects().length?(f=b.getBoundingClientRect(),x=b.ownerDocument.defaultView,{top:f.top+x.pageYOffset,left:f.left+x.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var c,f,x,b=this[0],S={top:0,left:0};if(p.css(b,"position")==="fixed")f=b.getBoundingClientRect();else{for(f=this.offset(),x=b.ownerDocument,c=b.offsetParent||x.documentElement;c&&(c===x.body||c===x.documentElement)&&p.css(c,"position")==="static";)c=c.parentNode;c&&c!==b&&c.nodeType===1&&((S=p(c).offset()).top+=p.css(c,"borderTopWidth",!0),S.left+=p.css(c,"borderLeftWidth",!0))}return{top:f.top-S.top-p.css(b,"marginTop",!0),left:f.left-S.left-p.css(b,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var c=this.offsetParent;c&&p.css(c,"position")==="static";)c=c.offsetParent;return c||G})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,f){var x=f==="pageYOffset";p.fn[c]=function(b){return bt(this,function(S,T,L){var z;if(w(S)?z=S:S.nodeType===9&&(z=S.defaultView),L===void 0)return z?z[f]:S[T];z?z.scrollTo(x?z.pageXOffset:L,x?L:z.pageYOffset):S[T]=L},c,b,arguments.length)}}),p.each(["top","left"],function(c,f){p.cssHooks[f]=In(m.pixelPosition,function(x,b){if(b)return b=vt(x,f),rt.test(b)?p(x).position()[f]+"px":b})}),p.each({Height:"height",Width:"width"},function(c,f){p.each({padding:"inner"+c,content:f,"":"outer"+c},function(x,b){p.fn[b]=function(S,T){var L=arguments.length&&(x||typeof S!="boolean"),z=x||(S===!0||T===!0?"margin":"border");return bt(this,function(U,W,K){var he;return w(U)?b.indexOf("outer")===0?U["inner"+c]:U.document.documentElement["client"+c]:U.nodeType===9?(he=U.documentElement,Math.max(U.body["scroll"+c],he["scroll"+c],U.body["offset"+c],he["offset"+c],he["client"+c])):K===void 0?p.css(U,W,z):p.style(U,W,K,z)},f,L?S:void 0,L)}})}),p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(c,f){p.fn[f]=function(x){return this.on(f,x)}}),p.fn.extend({bind:function(c,f,x){return this.on(c,null,f,x)},unbind:function(c,f){return this.off(c,null,f)},delegate:function(c,f,x,b){return this.on(f,c,x,b)},undelegate:function(c,f,x){return arguments.length===1?this.off(c,"**"):this.off(f,c||"**",x)},hover:function(c,f){return this.mouseenter(c).mouseleave(f||c)}}),p.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(c,f){p.fn[f]=function(x,b){return 0<arguments.length?this.on(f,null,x,b):this.trigger(f)}});var Qf=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;p.proxy=function(c,f){var x,b,S;if(typeof f=="string"&&(x=c[f],f=c,c=x),y(c))return b=r.call(arguments,2),(S=function(){return c.apply(f||this,b.concat(r.call(arguments)))}).guid=c.guid=c.guid||p.guid++,S},p.holdReady=function(c){c?p.readyWait++:p.ready(!0)},p.isArray=Array.isArray,p.parseJSON=JSON.parse,p.nodeName=B,p.isFunction=y,p.isWindow=w,p.camelCase=it,p.type=E,p.now=Date.now,p.isNumeric=function(c){var f=p.type(c);return(f==="number"||f==="string")&&!isNaN(c-parseFloat(c))},p.trim=function(c){return c==null?"":(c+"").replace(Qf,"")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return p});var Kf=t.jQuery,ed=t.$;return p.noConflict=function(c){return t.$===p&&(t.$=ed),c&&t.jQuery===p&&(t.jQuery=Kf),p},typeof e>"u"&&(t.jQuery=t.$=p),p});var Ei=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0;function dd(t,e){return typeof e>"u"?e={autoBom:!1}:typeof e!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function ic(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){ua(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function ou(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function To(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var au=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),ua=Ei.saveAs||(typeof window!="object"||window!==Ei?function(){}:"download"in HTMLAnchorElement.prototype&&!au?function(e,n,i){var r=Ei.URL||Ei.webkitURL,s=document.createElement("a");n=n||e.name||"download",s.download=n,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?ou(s.href)?ic(e,n,i):To(s,s.target="_blank"):To(s)):(s.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){To(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,n,i){if(n=n||e.name||"download",typeof e=="string")if(ou(e))ic(e,n,i);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){To(r)})}else navigator.msSaveOrOpenBlob(dd(e,i),n)}:function(e,n,i,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return ic(e,n,i);var s=e.type==="application/octet-stream",o=/constructor/i.test(Ei.HTMLElement)||Ei.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||s&&o||au)&&typeof FileReader<"u"){var u=new FileReader;u.onloadend=function(){var h=u.result;h=a?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=h:location=h,r=null},u.readAsDataURL(e)}else{var l=Ei.URL||Ei.webkitURL,d=l.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){l.revokeObjectURL(d)},4e4)}});Ei.saveAs=ua.saveAs=ua;typeof Ji<"u"&&(Ji.exports=ua);(function(t){if(typeof Bf=="object"&&typeof Ji<"u")Ji.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var e;typeof window<"u"?e=window:typeof global<"u"?e=global:typeof self<"u"?e=self:e=this,e.GIF=t()}})(function(){return(function t(e,n,i){function r(a,u){if(!n[a]){if(!e[a]){var l=typeof require=="function"&&require;if(!u&&l)return l(a,!0);if(s)return s(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(g){var m=e[a][1][g];return r(m||g)},h,h.exports,t,e,n,i)}return n[a].exports}for(var s=typeof require=="function"&&require,o=0;o<i.length;o++)r(i[o]);return r})({1:[function(t,e,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(u){if(!s(u)||u<0||isNaN(u))throw TypeError("n must be a positive number");return this._maxListeners=u,this},i.prototype.emit=function(u){var l,d,h,g,m,y;if(this._events||(this._events={}),u==="error"&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(l=arguments[1],l instanceof Error)throw l;var w=new Error('Uncaught, unspecified "error" event. ('+l+")");throw w.context=l,w}if(d=this._events[u],a(d))return!1;if(r(d))switch(arguments.length){case 1:d.call(this);break;case 2:d.call(this,arguments[1]);break;case 3:d.call(this,arguments[1],arguments[2]);break;default:g=Array.prototype.slice.call(arguments,1),d.apply(this,g)}else if(o(d))for(g=Array.prototype.slice.call(arguments,1),y=d.slice(),h=y.length,m=0;m<h;m++)y[m].apply(this,g);return!0},i.prototype.addListener=function(u,l){var d;if(!r(l))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",u,r(l.listener)?l.listener:l),this._events[u]?o(this._events[u])?this._events[u].push(l):this._events[u]=[this._events[u],l]:this._events[u]=l,o(this._events[u])&&!this._events[u].warned&&(a(this._maxListeners)?d=i.defaultMaxListeners:d=this._maxListeners,d&&d>0&&this._events[u].length>d&&(this._events[u].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[u].length),typeof console.trace=="function"&&console.trace())),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(u,l){if(!r(l))throw TypeError("listener must be a function");var d=!1;function h(){this.removeListener(u,h),d||(d=!0,l.apply(this,arguments))}return h.listener=l,this.on(u,h),this},i.prototype.removeListener=function(u,l){var d,h,g,m;if(!r(l))throw TypeError("listener must be a function");if(!this._events||!this._events[u])return this;if(d=this._events[u],g=d.length,h=-1,d===l||r(d.listener)&&d.listener===l)delete this._events[u],this._events.removeListener&&this.emit("removeListener",u,l);else if(o(d)){for(m=g;m-- >0;)if(d[m]===l||d[m].listener&&d[m].listener===l){h=m;break}if(h<0)return this;d.length===1?(d.length=0,delete this._events[u]):d.splice(h,1),this._events.removeListener&&this.emit("removeListener",u,l)}return this},i.prototype.removeAllListeners=function(u){var l,d;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[u]&&delete this._events[u],this;if(arguments.length===0){for(l in this._events)l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events={},this}if(d=this._events[u],r(d))this.removeListener(u,d);else if(d)for(;d.length;)this.removeListener(u,d[d.length-1]);return delete this._events[u],this},i.prototype.listeners=function(u){var l;return!this._events||!this._events[u]?l=[]:r(this._events[u])?l=[this._events[u]]:l=this._events[u].slice(),l},i.prototype.listenerCount=function(u){if(this._events){var l=this._events[u];if(r(l))return 1;if(l)return l.length}return 0},i.listenerCount=function(u,l){return u.listenerCount(l)};function r(u){return typeof u=="function"}function s(u){return typeof u=="number"}function o(u){return typeof u=="object"&&u!==null}function a(u){return u===void 0}},{}],2:[function(t,e,n){var i,r,s,o,a;a=navigator.userAgent.toLowerCase(),o=navigator.platform.toLowerCase(),i=a.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],s=i[1]==="ie"&&document.documentMode,r={name:i[1]==="version"?i[3]:i[1],version:s||parseFloat(i[1]==="opera"&&i[4]?i[4]:i[2]),platform:{name:a.match(/ip(?:ad|od|hone)/)?"ios":(a.match(/(?:webos|android)/)||o.match(/mac|win|linux/)||["other"])[0]}},r[r.name]=!0,r[r.name+parseInt(r.version,10)]=!0,r.platform[r.platform.name]=!0,e.exports=r},{}],3:[function(t,e,n){var i,r,s,o=function(d,h){for(var g in h)a.call(h,g)&&(d[g]=h[g]);function m(){this.constructor=d}return m.prototype=h.prototype,d.prototype=new m,d.__super__=h.prototype,d},a={}.hasOwnProperty,u=[].indexOf||function(d){for(var h=0,g=this.length;h<g;h++)if(h in this&&this[h]===d)return h;return-1},l=[].slice;i=t("events").EventEmitter,s=t("./browser.coffee"),r=(function(d){var h,g;o(m,d),h={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1},g={delay:500,copy:!1};function m(y){var w,M,_;this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(y);for(M in h)_=h[M],(w=this.options)[M]==null&&(w[M]=_)}return m.prototype.setOption=function(y,w){if(this.options[y]=w,this._canvas!=null&&(y==="width"||y==="height"))return this._canvas[y]=w},m.prototype.setOptions=function(y){var w,M,_;M=[];for(w in y)a.call(y,w)&&(_=y[w],M.push(this.setOption(w,_)));return M},m.prototype.addFrame=function(y,w){var M,_;w==null&&(w={}),M={},M.transparent=this.options.transparent;for(_ in g)M[_]=w[_]||g[_];if(this.options.width==null&&this.setOption("width",y.width),this.options.height==null&&this.setOption("height",y.height),typeof ImageData<"u"&&ImageData!==null&&y instanceof ImageData)M.data=y.data;else if(typeof CanvasRenderingContext2D<"u"&&CanvasRenderingContext2D!==null&&y instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext<"u"&&WebGLRenderingContext!==null&&y instanceof WebGLRenderingContext)w.copy?M.data=this.getContextData(y):M.context=y;else if(y.childNodes!=null)w.copy?M.data=this.getImageData(y):M.image=y;else throw new Error("Invalid image");return this.frames.push(M)},m.prototype.render=function(){var y,w,M;if(this.running)throw new Error("Already running");if(this.options.width==null||this.options.height==null)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=(function(){var _,v,E;for(E=[],_=0,v=this.frames.length;0<=v?_<v:_>v;0<=v?++_:--_)E.push(null);return E}).call(this),w=this.spawnWorkers(),this.options.globalPalette===!0)this.renderNextFrame();else for(y=0,M=w;0<=M?y<M:y>M;0<=M?++y:--y)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},m.prototype.abort=function(){for(var y;y=this.activeWorkers.shift(),y!=null;)this.log("killing active worker"),y.terminate();return this.running=!1,this.emit("abort")},m.prototype.spawnWorkers=function(){var y,w,M;return y=Math.min(this.options.workers,this.frames.length),(function(){M=[];for(var _=w=this.freeWorkers.length;w<=y?_<y:_>y;w<=y?_++:_--)M.push(_);return M}).apply(this).forEach((function(_){return function(v){var E;return _.log("spawning worker "+v),E=new Worker(_.options.workerScript),E.onmessage=function(R){return _.activeWorkers.splice(_.activeWorkers.indexOf(E),1),_.freeWorkers.push(E),_.frameFinished(R.data)},_.freeWorkers.push(E)}})(this)),y},m.prototype.frameFinished=function(y){var w,M;if(this.log("frame "+y.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[y.index]=y,this.options.globalPalette===!0&&(this.options.globalPalette=y.globalPalette,this.log("global palette analyzed"),this.frames.length>2))for(w=1,M=this.freeWorkers.length;1<=M?w<M:w>M;1<=M?++w:--w)this.renderNextFrame();return u.call(this.imageParts,null)>=0?this.renderNextFrame():this.finishRendering()},m.prototype.finishRendering=function(){var y,w,M,_,v,E,R,p,A,O,H,ne,se,B,j,Y;for(p=0,B=this.imageParts,v=0,A=B.length;v<A;v++)w=B[v],p+=(w.data.length-1)*w.pageSize+w.cursor;for(p+=w.pageSize-w.cursor,this.log("rendering finished - filesize "+Math.round(p/1e3)+"kb"),y=new Uint8Array(p),ne=0,j=this.imageParts,E=0,O=j.length;E<O;E++)for(w=j[E],Y=w.data,M=R=0,H=Y.length;R<H;M=++R)se=Y[M],y.set(se,ne),M===w.data.length-1?ne+=w.cursor:ne+=w.pageSize;return _=new Blob([y],{type:"image/gif"}),this.emit("finished",_,y)},m.prototype.renderNextFrame=function(){var y,w,M;if(this.freeWorkers.length===0)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return y=this.frames[this.nextFrame++],M=this.freeWorkers.shift(),w=this.getTask(y),this.log("starting frame "+(w.index+1)+" of "+this.frames.length),this.activeWorkers.push(M),M.postMessage(w)},m.prototype.getContextData=function(y){return y.getImageData(0,0,this.options.width,this.options.height).data},m.prototype.getImageData=function(y){var w;return this._canvas==null&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),w=this._canvas.getContext("2d"),w.setFill=this.options.background,w.fillRect(0,0,this.options.width,this.options.height),w.drawImage(y,0,0),this.getContextData(w)},m.prototype.getTask=function(y){var w,M;if(w=this.frames.indexOf(y),M={index:w,last:w===this.frames.length-1,delay:y.delay,transparent:y.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:s.name==="chrome"},y.data!=null)M.data=y.data;else if(y.context!=null)M.data=this.getContextData(y.context);else if(y.image!=null)M.data=this.getImageData(y.image);else throw new Error("Invalid frame");return M},m.prototype.log=function(){var y;if(y=1<=arguments.length?l.call(arguments,0):[],!!this.options.debug)return console.log.apply(console,y)},m})(i),e.exports=r},{"./browser.coffee":2,events:1}]},{},[3])(3)});const pd="122",Wi={ROTATE:0,DOLLY:1,PAN:2},ji={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},md=0,cu=1,gd=2,Dh=1,yd=2,Ds=3,Ea=0,nn=1,Aa=2,Ih=1,Os=0,Bs=1,lu=2,uu=3,hu=4,vd=5,Zr=100,xd=101,_d=102,fu=103,du=104,bd=200,wd=201,Md=202,Sd=203,Nh=204,Oh=205,Td=206,Ed=207,Ad=208,Ld=209,Cd=210,Rd=0,Pd=1,Dd=2,Nc=3,Id=4,Nd=5,Od=6,Bd=7,La=0,Fd=1,zd=2,Fs=0,kd=1,Ud=2,Gd=3,Hd=4,Vd=5,Tl=300,Ca=301,Ra=302,Oc=303,Bc=304,Pa=306,Da=307,ha=1e3,xn=1001,fa=1002,un=1003,Fc=1004,zc=1005,sn=1006,Bh=1007,lo=1008,El=1009,Wd=1010,jd=1011,da=1012,qd=1013,ca=1014,qi=1015,pa=1016,Xd=1017,Yd=1018,Zd=1019,zs=1020,Jd=1021,fr=1022,Qn=1023,$d=1024,Qd=1025,ns=1026,Vs=1027,Kd=1028,ep=1029,tp=1030,np=1031,ip=1032,rp=1033,pu=33776,mu=33777,gu=33778,yu=33779,vu=35840,xu=35841,_u=35842,bu=35843,sp=36196,wu=37492,Mu=37496,op=37808,ap=37809,cp=37810,lp=37811,up=37812,hp=37813,fp=37814,dp=37815,pp=37816,mp=37817,gp=37818,yp=37819,vp=37820,xp=37821,_p=36492,bp=37840,wp=37841,Mp=37842,Sp=37843,Tp=37844,Ep=37845,Ap=37846,Lp=37847,Cp=37848,Rp=37849,Pp=37850,Dp=37851,Ip=37852,Np=37853,Op=2200,Bp=2201,Fp=2202,ma=2300,la=2301,rc=2302,Jr=2400,$r=2401,ga=2402,Al=2500,Fh=2501,zp=0,uo=3e3,zh=3001,kp=3007,Up=3002,Gp=3003,Hp=3004,Vp=3005,Wp=3006,jp=3200,qp=3201,ps=0,Xp=1,sc=7680,Yp=519,Ia=35044,Ws=35048,Su="300 es";function ti(){}Object.assign(ti.prototype,{addEventListener:function(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)},hasEventListener:function(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1},removeEventListener:function(t,e){if(this._listeners===void 0)return;const i=this._listeners[t];if(i!==void 0){const r=i.indexOf(e);r!==-1&&i.splice(r,1)}},dispatchEvent:function(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const i=n.slice(0);for(let r=0,s=i.length;r<s;r++)i[r].call(this,t)}}});const tn=[];for(let t=0;t<256;t++)tn[t]=(t<16?"0":"")+t.toString(16);let Eo=1234567;const at={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(tn[t&255]+tn[t>>8&255]+tn[t>>16&255]+tn[t>>24&255]+"-"+tn[e&255]+tn[e>>8&255]+"-"+tn[e>>16&15|64]+tn[e>>24&255]+"-"+tn[n&63|128]+tn[n>>8&255]+"-"+tn[n>>16&255]+tn[n>>24&255]+tn[i&255]+tn[i>>8&255]+tn[i>>16&255]+tn[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return t!==void 0&&(Eo=t%2147483647),Eo=Eo*16807%2147483647,(Eo-1)/2147483646},degToRad:function(t){return t*at.DEG2RAD},radToDeg:function(t){return t*at.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)===0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),u=o(n/2),l=s((e+i)/2),d=o((e+i)/2),h=s((e-i)/2),g=o((e-i)/2),m=s((i-e)/2),y=o((i-e)/2);switch(r){case"XYX":t.set(a*d,u*h,u*g,a*l);break;case"YZY":t.set(u*g,a*d,u*h,a*l);break;case"ZXZ":t.set(u*h,u*g,a*d,a*l);break;case"XZX":t.set(a*d,u*y,u*m,a*l);break;case"YXY":t.set(u*m,a*d,u*y,a*l);break;case"ZYZ":t.set(u*y,u*m,a*d,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};class oe{constructor(e=0,n=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class _n{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,n,i,r,s,o,a,u,l){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=n,d[4]=s,d[5]=u,d[6]=i,d[7]=o,d[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return new this.constructor().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],u=i[6],l=i[1],d=i[4],h=i[7],g=i[2],m=i[5],y=i[8],w=r[0],M=r[3],_=r[6],v=r[1],E=r[4],R=r[7],p=r[2],A=r[5],O=r[8];return s[0]=o*w+a*v+u*p,s[3]=o*M+a*E+u*A,s[6]=o*_+a*R+u*O,s[1]=l*w+d*v+h*p,s[4]=l*M+d*E+h*A,s[7]=l*_+d*R+h*O,s[2]=g*w+m*v+y*p,s[5]=g*M+m*E+y*A,s[8]=g*_+m*R+y*O,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],d=e[8];return n*o*d-n*a*l-i*s*d+i*a*u+r*s*l-r*o*u}getInverse(e,n){n!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const i=e.elements,r=this.elements,s=i[0],o=i[1],a=i[2],u=i[3],l=i[4],d=i[5],h=i[6],g=i[7],m=i[8],y=m*l-d*g,w=d*h-m*u,M=g*u-l*h,_=s*y+o*w+a*M;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/_;return r[0]=y*v,r[1]=(a*g-m*o)*v,r[2]=(d*o-a*l)*v,r[3]=w*v,r[4]=(m*s-a*h)*v,r[5]=(a*u-d*s)*v,r[6]=M*v,r[7]=(o*h-g*s)*v,r[8]=(l*s-o*u)*v,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).getInverse(this).transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){const u=Math.cos(s),l=Math.sin(s);this.set(i*u,i*l,-i*(u*o+l*a)+o+e,-r*l,r*u,-r*(-l*o+u*a)+a+n,0,0,1)}scale(e,n){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=n,i[4]*=n,i[7]*=n,this}rotate(e){const n=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],u=r[1],l=r[4],d=r[7];return r[0]=n*s+i*u,r[3]=n*o+i*l,r[6]=n*a+i*d,r[1]=-i*s+n*u,r[4]=-i*o+n*l,r[7]=-i*a+n*d,this}translate(e,n){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=n*i[2],i[4]+=n*i[5],i[7]+=n*i[8],this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}}let Ir;const pr={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Ir===void 0&&(Ir=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ir.width=t.width,Ir.height=t.height;const n=Ir.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Ir}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}};let Zp=0;function Ct(t,e,n,i,r,s,o,a,u,l){Object.defineProperty(this,"id",{value:Zp++}),this.uuid=at.generateUUID(),this.name="",this.image=t!==void 0?t:Ct.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=e!==void 0?e:Ct.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:xn,this.wrapT=i!==void 0?i:xn,this.magFilter=r!==void 0?r:sn,this.minFilter=s!==void 0?s:lo,this.anisotropy=u!==void 0?u:1,this.format=o!==void 0?o:Qn,this.internalFormat=null,this.type=a!==void 0?a:El,this.offset=new oe(0,0),this.repeat=new oe(1,1),this.center=new oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _n,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=l!==void 0?l:uo,this.version=0,this.onUpdate=null}Ct.DEFAULT_IMAGE=void 0;Ct.DEFAULT_MAPPING=Tl;Ct.prototype=Object.assign(Object.create(ti.prototype),{constructor:Ct,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const i=this.image;if(i.uuid===void 0&&(i.uuid=at.generateUUID()),!e&&t.images[i.uuid]===void 0){let r;if(Array.isArray(i)){r=[];for(let s=0,o=i.length;s<o;s++)r.push(pr.getDataURL(i[s]))}else r=pr.getDataURL(i);t.images[i.uuid]={uuid:i.uuid,url:r}}n.image=i.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==Tl)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ha:t.x=t.x-Math.floor(t.x);break;case xn:t.x=t.x<0?0:1;break;case fa:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case ha:t.y=t.y-Math.floor(t.y);break;case xn:t.y=t.y<0?0:1;break;case fa:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}});Object.defineProperty(Ct.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});class At{constructor(e=0,n=0,i=0,r=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const u=e.elements,l=u[0],d=u[4],h=u[8],g=u[1],m=u[5],y=u[9],w=u[2],M=u[6],_=u[10];if(Math.abs(d-g)<.01&&Math.abs(h-w)<.01&&Math.abs(y-M)<.01){if(Math.abs(d+g)<.1&&Math.abs(h+w)<.1&&Math.abs(y+M)<.1&&Math.abs(l+m+_-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const E=(l+1)/2,R=(m+1)/2,p=(_+1)/2,A=(d+g)/4,O=(h+w)/4,H=(y+M)/4;return E>R&&E>p?E<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(E),r=A/i,s=O/i):R>p?R<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(R),i=A/r,s=H/r):p<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(p),i=O/s,r=H/s),this.set(i,r,s,n),this}let v=Math.sqrt((M-y)*(M-y)+(h-w)*(h-w)+(g-d)*(g-d));return Math.abs(v)<.001&&(v=1),this.x=(M-y)/v,this.y=(h-w)/v,this.z=(g-d)/v,this.w=Math.acos((l+m+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}function Kn(t,e,n){this.width=t,this.height=e,this.scissor=new At(0,0,t,e),this.scissorTest=!1,this.viewport=new At(0,0,t,e),n=n||{},this.texture=new Ct(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:sn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}Kn.prototype=Object.assign(Object.create(ti.prototype),{constructor:Kn,isWebGLRenderTarget:!0,setSize:function(t,e){(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Tu(t,e,n){Kn.call(this,t,e,n),this.samples=4}Tu.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Tu,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Kn.prototype.copy.call(this,t),this.samples=t.samples,this}});class mn{constructor(e=0,n=0,i=0,r=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=e,this._y=n,this._z=i,this._w=r}static slerp(e,n,i,r){return i.copy(e).slerp(n,r)}static slerpFlat(e,n,i,r,s,o,a){let u=i[r+0],l=i[r+1],d=i[r+2],h=i[r+3];const g=s[o+0],m=s[o+1],y=s[o+2],w=s[o+3];if(h!==w||u!==g||l!==m||d!==y){let M=1-a;const _=u*g+l*m+d*y+h*w,v=_>=0?1:-1,E=1-_*_;if(E>Number.EPSILON){const p=Math.sqrt(E),A=Math.atan2(p,_*v);M=Math.sin(M*A)/p,a=Math.sin(a*A)/p}const R=a*v;if(u=u*M+g*R,l=l*M+m*R,d=d*M+y*R,h=h*M+w*R,M===1-a){const p=1/Math.sqrt(u*u+l*l+d*d+h*h);u*=p,l*=p,d*=p,h*=p}}e[n]=u,e[n+1]=l,e[n+2]=d,e[n+3]=h}static multiplyQuaternionsFlat(e,n,i,r,s,o){const a=i[r],u=i[r+1],l=i[r+2],d=i[r+3],h=s[o],g=s[o+1],m=s[o+2],y=s[o+3];return e[n]=a*y+d*h+u*m-l*g,e[n+1]=u*y+d*g+l*h-a*m,e[n+2]=l*y+d*m+a*g-u*h,e[n+3]=d*y-a*h-u*g-l*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,u=Math.sin,l=a(i/2),d=a(r/2),h=a(s/2),g=u(i/2),m=u(r/2),y=u(s/2);switch(o){case"XYZ":this._x=g*d*h+l*m*y,this._y=l*m*h-g*d*y,this._z=l*d*y+g*m*h,this._w=l*d*h-g*m*y;break;case"YXZ":this._x=g*d*h+l*m*y,this._y=l*m*h-g*d*y,this._z=l*d*y-g*m*h,this._w=l*d*h+g*m*y;break;case"ZXY":this._x=g*d*h-l*m*y,this._y=l*m*h+g*d*y,this._z=l*d*y+g*m*h,this._w=l*d*h-g*m*y;break;case"ZYX":this._x=g*d*h-l*m*y,this._y=l*m*h+g*d*y,this._z=l*d*y-g*m*h,this._w=l*d*h+g*m*y;break;case"YZX":this._x=g*d*h+l*m*y,this._y=l*m*h+g*d*y,this._z=l*d*y-g*m*h,this._w=l*d*h-g*m*y;break;case"XZY":this._x=g*d*h-l*m*y,this._y=l*m*h-g*d*y,this._z=l*d*y+g*m*h,this._w=l*d*h+g*m*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],u=n[9],l=n[2],d=n[6],h=n[10],g=i+a+h;if(g>0){const m=.5/Math.sqrt(g+1);this._w=.25/m,this._x=(d-u)*m,this._y=(s-l)*m,this._z=(o-r)*m}else if(i>a&&i>h){const m=2*Math.sqrt(1+i-a-h);this._w=(d-u)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+l)/m}else if(a>h){const m=2*Math.sqrt(1+a-i-h);this._w=(s-l)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(u+d)/m}else{const m=2*Math.sqrt(1+h-i-a);this._w=(o-r)/m,this._x=(s+l)/m,this._y=(u+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<1e-6?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(at.clamp(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}inverse(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,n)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,u=n._y,l=n._z,d=n._w;return this._x=i*d+o*a+r*l-s*u,this._y=r*d+o*u+s*a-i*l,this._z=s*d+o*l+i*u-r*a,this._w=o*d-i*a-r*u-s*l,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const u=1-a*a;if(u<=Number.EPSILON){const m=1-n;return this._w=m*o+n*this._w,this._x=m*i+n*this._x,this._y=m*r+n*this._y,this._z=m*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(u),d=Math.atan2(l,a),h=Math.sin((1-n)*d)/l,g=Math.sin(n*d)/l;return this._w=o*h+this._w*g,this._x=i*h+this._x*g,this._y=r*h+this._y*g,this._z=s*h+this._z*g,this._onChangeCallback(),this}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}class P{constructor(e=0,n=0,i=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,n)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Eu.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(Eu.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,u=e.w,l=u*n+o*r-a*i,d=u*i+a*n-s*r,h=u*r+s*i-o*n,g=-s*n-o*i-a*r;return this.x=l*u+g*-s+d*-a-h*-o,this.y=d*u+g*-o+h*-s-l*-a,this.z=h*u+g*-a+l*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,n)):this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,u=n.z;return this.x=r*u-s*a,this.y=s*o-i*u,this.z=i*a-r*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return oc.copy(this).projectOnVector(e),this.sub(oc)}reflect(e){return this.sub(oc.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(at.clamp(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const oc=new P,Eu=new mn;class Ki{constructor(e,n){Object.defineProperty(this,"isBox3",{value:!0}),this.min=e!==void 0?e:new P(1/0,1/0,1/0),this.max=n!==void 0?n:new P(-1/0,-1/0,-1/0)}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){let n=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let u=0,l=e.length;u<l;u+=3){const d=e[u],h=e[u+1],g=e[u+2];d<n&&(n=d),h<i&&(i=h),g<r&&(r=g),d>s&&(s=d),h>o&&(o=h),g>a&&(a=g)}return this.min.set(n,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let n=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let u=0,l=e.count;u<l;u++){const d=e.getX(u),h=e.getY(u),g=e.getZ(u);d<n&&(n=d),h<i&&(i=h),g<r&&(r=g),d>s&&(s=d),h>o&&(o=h),g>a&&(a=g)}return this.min.set(n,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Ms.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new P),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new P),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const n=e.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),cc.copy(n.boundingBox),cc.applyMatrix4(e.matrixWorld),this.union(cc));const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new P),n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ms),Ms.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ss),Ao.subVectors(this.max,Ss),Nr.subVectors(e.a,Ss),Or.subVectors(e.b,Ss),Br.subVectors(e.c,Ss),Bi.subVectors(Or,Nr),Fi.subVectors(Br,Or),ar.subVectors(Nr,Br);let n=[0,-Bi.z,Bi.y,0,-Fi.z,Fi.y,0,-ar.z,ar.y,Bi.z,0,-Bi.x,Fi.z,0,-Fi.x,ar.z,0,-ar.x,-Bi.y,Bi.x,0,-Fi.y,Fi.x,0,-ar.y,ar.x,0];return!ac(n,Nr,Or,Br,Ao)||(n=[1,0,0,0,1,0,0,0,1],!ac(n,Nr,Or,Br,Ao))?!1:(Lo.crossVectors(Bi,Fi),n=[Lo.x,Lo.y,Lo.z],ac(n,Nr,Or,Br,Ao))}clampPoint(e,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new P),n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ms.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=this.getSize(Ms).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(bi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),bi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),bi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),bi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),bi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),bi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),bi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),bi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(bi),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}function ac(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){cr.fromArray(t,s);const a=r.x*Math.abs(cr.x)+r.y*Math.abs(cr.y)+r.z*Math.abs(cr.z),u=e.dot(cr),l=n.dot(cr),d=i.dot(cr);if(Math.max(-Math.max(u,l,d),Math.min(u,l,d))>a)return!1}return!0}const bi=[new P,new P,new P,new P,new P,new P,new P,new P],Ms=new P,cc=new Ki,Nr=new P,Or=new P,Br=new P,Bi=new P,Fi=new P,ar=new P,Ss=new P,Ao=new P,Lo=new P,cr=new P,Jp=new Ki;class er{constructor(e,n){this.center=e!==void 0?e:new P,this.radius=n!==void 0?n:-1}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Jp.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new P),n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Ki),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}}const wi=new P,lc=new P,Co=new P,zi=new P,uc=new P,Ro=new P,hc=new P;class ho{constructor(e,n){this.origin=e!==void 0?e:new P,this.direction=n!==void 0?n:new P(0,0,-1)}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new P),n.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,wi)),this}closestPointToPoint(e,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new P),n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=wi.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(wi.copy(this.direction).multiplyScalar(n).add(this.origin),wi.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){lc.copy(e).add(n).multiplyScalar(.5),Co.copy(n).sub(e).normalize(),zi.copy(this.origin).sub(lc);const s=e.distanceTo(n)*.5,o=-this.direction.dot(Co),a=zi.dot(this.direction),u=-zi.dot(Co),l=zi.lengthSq(),d=Math.abs(1-o*o);let h,g,m,y;if(d>0)if(h=o*u-a,g=o*a-u,y=s*d,h>=0)if(g>=-y)if(g<=y){const w=1/d;h*=w,g*=w,m=h*(h+o*g+2*a)+g*(o*h+g+2*u)+l}else g=s,h=Math.max(0,-(o*g+a)),m=-h*h+g*(g+2*u)+l;else g=-s,h=Math.max(0,-(o*g+a)),m=-h*h+g*(g+2*u)+l;else g<=-y?(h=Math.max(0,-(-o*s+a)),g=h>0?-s:Math.min(Math.max(-s,-u),s),m=-h*h+g*(g+2*u)+l):g<=y?(h=0,g=Math.min(Math.max(-s,-u),s),m=g*(g+2*u)+l):(h=Math.max(0,-(o*s+a)),g=h>0?s:Math.min(Math.max(-s,-u),s),m=-h*h+g*(g+2*u)+l);else g=o>0?-s:s,h=Math.max(0,-(o*g+a)),m=-h*h+g*(g+2*u)+l;return i&&i.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(Co).multiplyScalar(g).add(lc),m}intersectSphere(e,n){wi.subVectors(e.center,this.origin);const i=wi.dot(this.direction),r=wi.dot(wi)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,u=i+o;return a<0&&u<0?null:a<0?this.at(u,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,u;const l=1/this.direction.x,d=1/this.direction.y,h=1/this.direction.z,g=this.origin;return l>=0?(i=(e.min.x-g.x)*l,r=(e.max.x-g.x)*l):(i=(e.max.x-g.x)*l,r=(e.min.x-g.x)*l),d>=0?(s=(e.min.y-g.y)*d,o=(e.max.y-g.y)*d):(s=(e.max.y-g.y)*d,o=(e.min.y-g.y)*d),i>o||s>r||((s>i||i!==i)&&(i=s),(o<r||r!==r)&&(r=o),h>=0?(a=(e.min.z-g.z)*h,u=(e.max.z-g.z)*h):(a=(e.max.z-g.z)*h,u=(e.min.z-g.z)*h),i>u||a>r)||((a>i||i!==i)&&(i=a),(u<r||r!==r)&&(r=u),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,wi)!==null}intersectTriangle(e,n,i,r,s){uc.subVectors(n,e),Ro.subVectors(i,e),hc.crossVectors(uc,Ro);let o=this.direction.dot(hc),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;zi.subVectors(this.origin,e);const u=a*this.direction.dot(Ro.crossVectors(zi,Ro));if(u<0)return null;const l=a*this.direction.dot(uc.cross(zi));if(l<0||u+l>o)return null;const d=-a*zi.dot(hc);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}class ht{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,n,i,r,s,o,a,u,l,d,h,g,m,y,w,M){const _=this.elements;return _[0]=e,_[4]=n,_[8]=i,_[12]=r,_[1]=s,_[5]=o,_[9]=a,_[13]=u,_[2]=l,_[6]=d,_[10]=h,_[14]=g,_[3]=m,_[7]=y,_[11]=w,_[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ht().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/Fr.setFromMatrixColumn(e,0).length(),s=1/Fr.setFromMatrixColumn(e,1).length(),o=1/Fr.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),u=Math.cos(r),l=Math.sin(r),d=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const g=o*d,m=o*h,y=a*d,w=a*h;n[0]=u*d,n[4]=-u*h,n[8]=l,n[1]=m+y*l,n[5]=g-w*l,n[9]=-a*u,n[2]=w-g*l,n[6]=y+m*l,n[10]=o*u}else if(e.order==="YXZ"){const g=u*d,m=u*h,y=l*d,w=l*h;n[0]=g+w*a,n[4]=y*a-m,n[8]=o*l,n[1]=o*h,n[5]=o*d,n[9]=-a,n[2]=m*a-y,n[6]=w+g*a,n[10]=o*u}else if(e.order==="ZXY"){const g=u*d,m=u*h,y=l*d,w=l*h;n[0]=g-w*a,n[4]=-o*h,n[8]=y+m*a,n[1]=m+y*a,n[5]=o*d,n[9]=w-g*a,n[2]=-o*l,n[6]=a,n[10]=o*u}else if(e.order==="ZYX"){const g=o*d,m=o*h,y=a*d,w=a*h;n[0]=u*d,n[4]=y*l-m,n[8]=g*l+w,n[1]=u*h,n[5]=w*l+g,n[9]=m*l-y,n[2]=-l,n[6]=a*u,n[10]=o*u}else if(e.order==="YZX"){const g=o*u,m=o*l,y=a*u,w=a*l;n[0]=u*d,n[4]=w-g*h,n[8]=y*h+m,n[1]=h,n[5]=o*d,n[9]=-a*d,n[2]=-l*d,n[6]=m*h+y,n[10]=g-w*h}else if(e.order==="XZY"){const g=o*u,m=o*l,y=a*u,w=a*l;n[0]=u*d,n[4]=-h,n[8]=l*d,n[1]=g*h+w,n[5]=o*d,n[9]=m*h-y,n[2]=y*h-m,n[6]=a*d,n[10]=w*h+g}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose($p,e,Qp)}lookAt(e,n,i){const r=this.elements;return Ln.subVectors(e,n),Ln.lengthSq()===0&&(Ln.z=1),Ln.normalize(),ki.crossVectors(i,Ln),ki.lengthSq()===0&&(Math.abs(i.z)===1?Ln.x+=1e-4:Ln.z+=1e-4,Ln.normalize(),ki.crossVectors(i,Ln)),ki.normalize(),Po.crossVectors(Ln,ki),r[0]=ki.x,r[4]=Po.x,r[8]=Ln.x,r[1]=ki.y,r[5]=Po.y,r[9]=Ln.y,r[2]=ki.z,r[6]=Po.z,r[10]=Ln.z,this}multiply(e,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,n)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],u=i[8],l=i[12],d=i[1],h=i[5],g=i[9],m=i[13],y=i[2],w=i[6],M=i[10],_=i[14],v=i[3],E=i[7],R=i[11],p=i[15],A=r[0],O=r[4],H=r[8],ne=r[12],se=r[1],B=r[5],j=r[9],Y=r[13],Q=r[2],X=r[6],Z=r[10],le=r[14],de=r[3],we=r[7],Ne=r[11],Re=r[15];return s[0]=o*A+a*se+u*Q+l*de,s[4]=o*O+a*B+u*X+l*we,s[8]=o*H+a*j+u*Z+l*Ne,s[12]=o*ne+a*Y+u*le+l*Re,s[1]=d*A+h*se+g*Q+m*de,s[5]=d*O+h*B+g*X+m*we,s[9]=d*H+h*j+g*Z+m*Ne,s[13]=d*ne+h*Y+g*le+m*Re,s[2]=y*A+w*se+M*Q+_*de,s[6]=y*O+w*B+M*X+_*we,s[10]=y*H+w*j+M*Z+_*Ne,s[14]=y*ne+w*Y+M*le+_*Re,s[3]=v*A+E*se+R*Q+p*de,s[7]=v*O+E*B+R*X+p*we,s[11]=v*H+E*j+R*Z+p*Ne,s[15]=v*ne+E*Y+R*le+p*Re,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],u=e[9],l=e[13],d=e[2],h=e[6],g=e[10],m=e[14],y=e[3],w=e[7],M=e[11],_=e[15];return y*(+s*u*h-r*l*h-s*a*g+i*l*g+r*a*m-i*u*m)+w*(+n*u*m-n*l*g+s*o*g-r*o*m+r*l*d-s*u*d)+M*(+n*l*h-n*a*m-s*o*h+i*o*m+s*a*d-i*l*d)+_*(-r*a*d-n*u*h+n*a*g+r*o*h-i*o*g+i*u*d)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}getInverse(e,n){n!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const i=this.elements,r=e.elements,s=r[0],o=r[1],a=r[2],u=r[3],l=r[4],d=r[5],h=r[6],g=r[7],m=r[8],y=r[9],w=r[10],M=r[11],_=r[12],v=r[13],E=r[14],R=r[15],p=y*E*g-v*w*g+v*h*M-d*E*M-y*h*R+d*w*R,A=_*w*g-m*E*g-_*h*M+l*E*M+m*h*R-l*w*R,O=m*v*g-_*y*g+_*d*M-l*v*M-m*d*R+l*y*R,H=_*y*h-m*v*h-_*d*w+l*v*w+m*d*E-l*y*E,ne=s*p+o*A+a*O+u*H;if(ne===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const se=1/ne;return i[0]=p*se,i[1]=(v*w*u-y*E*u-v*a*M+o*E*M+y*a*R-o*w*R)*se,i[2]=(d*E*u-v*h*u+v*a*g-o*E*g-d*a*R+o*h*R)*se,i[3]=(y*h*u-d*w*u-y*a*g+o*w*g+d*a*M-o*h*M)*se,i[4]=A*se,i[5]=(m*E*u-_*w*u+_*a*M-s*E*M-m*a*R+s*w*R)*se,i[6]=(_*h*u-l*E*u-_*a*g+s*E*g+l*a*R-s*h*R)*se,i[7]=(l*w*u-m*h*u+m*a*g-s*w*g-l*a*M+s*h*M)*se,i[8]=O*se,i[9]=(_*y*u-m*v*u-_*o*M+s*v*M+m*o*R-s*y*R)*se,i[10]=(l*v*u-_*d*u+_*o*g-s*v*g-l*o*R+s*d*R)*se,i[11]=(m*d*u-l*y*u-m*o*g+s*y*g+l*o*M-s*d*M)*se,i[12]=H*se,i[13]=(m*v*a-_*y*a+_*o*w-s*v*w-m*o*E+s*y*E)*se,i[14]=(_*d*a-l*v*a-_*o*h+s*v*h+l*o*E-s*d*E)*se,i[15]=(l*y*a-m*d*a+m*o*h-s*y*h-l*o*w+s*d*w)*se,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,u=e.z,l=s*o,d=s*a;return this.set(l*o+i,l*a-r*u,l*u+r*a,0,l*a+r*u,d*a+i,d*u-r*o,0,l*u-r*a,d*u+r*o,s*u*u+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i){return this.set(1,n,i,0,e,1,i,0,e,n,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,o=n._y,a=n._z,u=n._w,l=s+s,d=o+o,h=a+a,g=s*l,m=s*d,y=s*h,w=o*d,M=o*h,_=a*h,v=u*l,E=u*d,R=u*h,p=i.x,A=i.y,O=i.z;return r[0]=(1-(w+_))*p,r[1]=(m+R)*p,r[2]=(y-E)*p,r[3]=0,r[4]=(m-R)*A,r[5]=(1-(g+_))*A,r[6]=(M+v)*A,r[7]=0,r[8]=(y+E)*O,r[9]=(M-v)*O,r[10]=(1-(g+w))*O,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=Fr.set(r[0],r[1],r[2]).length();const o=Fr.set(r[4],r[5],r[6]).length(),a=Fr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],qn.copy(this);const l=1/s,d=1/o,h=1/a;return qn.elements[0]*=l,qn.elements[1]*=l,qn.elements[2]*=l,qn.elements[4]*=d,qn.elements[5]*=d,qn.elements[6]*=d,qn.elements[8]*=h,qn.elements[9]*=h,qn.elements[10]*=h,n.setFromRotationMatrix(qn),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,u=2*s/(n-e),l=2*s/(i-r),d=(n+e)/(n-e),h=(i+r)/(i-r),g=-(o+s)/(o-s),m=-2*o*s/(o-s);return a[0]=u,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=l,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=g,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,n,i,r,s,o){const a=this.elements,u=1/(n-e),l=1/(i-r),d=1/(o-s),h=(n+e)*u,g=(i+r)*l,m=(o+s)*d;return a[0]=2*u,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-g,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const Fr=new P,qn=new ht,$p=new P(0,0,0),Qp=new P(1,1,1),ki=new P,Po=new P,Ln=new P;class fo{constructor(e=0,n=0,i=0,r=fo.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._order=r||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n,i){const r=at.clamp,s=e.elements,o=s[0],a=s[4],u=s[8],l=s[1],d=s[5],h=s[9],g=s[2],m=s[6],y=s[10];switch(n=n||this._order,n){case"XYZ":this._y=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-h,y),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(m,d),this._z=0);break;case"YXZ":this._x=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(u,y),this._z=Math.atan2(l,d)):(this._y=Math.atan2(-g,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-g,y),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-r(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(m,y),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,d),this._y=Math.atan2(-g,o)):(this._x=0,this._y=Math.atan2(u,y));break;case"XZY":this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(m,d),this._y=Math.atan2(u,o)):(this._x=Math.atan2(-h,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i!==!1&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return Au.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Au,n,i)}setFromVector3(e,n){return this.set(e.x,e.y,e.z,n||this._order)}reorder(e){return Lu.setFromEuler(this),this.setFromQuaternion(Lu,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new P(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}fo.DefaultOrder="XYZ";fo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const Au=new ht,Lu=new mn;class kh{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}}let Kp=0;const Cu=new P,zr=new mn,Mi=new ht,Do=new P,Ts=new P,em=new P,tm=new mn,Ru=new P(1,0,0),Pu=new P(0,1,0),Du=new P(0,0,1),nm={type:"added"},Iu={type:"removed"};function je(){Object.defineProperty(this,"id",{value:Kp++}),this.uuid=at.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=je.DefaultUp.clone();const t=new P,e=new fo,n=new mn,i=new P(1,1,1);function r(){n.setFromEuler(e,!1)}function s(){e.setFromQuaternion(n,void 0,!1)}e._onChange(r),n._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new ht},normalMatrix:{value:new _n}}),this.matrix=new ht,this.matrixWorld=new ht,this.matrixAutoUpdate=je.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new kh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}je.DefaultUp=new P(0,1,0);je.DefaultMatrixAutoUpdate=!0;je.prototype=Object.assign(Object.create(ti.prototype),{constructor:je,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return zr.setFromAxisAngle(t,e),this.quaternion.multiply(zr),this},rotateOnWorldAxis:function(t,e){return zr.setFromAxisAngle(t,e),this.quaternion.premultiply(zr),this},rotateX:function(t){return this.rotateOnAxis(Ru,t)},rotateY:function(t){return this.rotateOnAxis(Pu,t)},rotateZ:function(t){return this.rotateOnAxis(Du,t)},translateOnAxis:function(t,e){return Cu.copy(t).applyQuaternion(this.quaternion),this.position.add(Cu.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(Ru,t)},translateY:function(t){return this.translateOnAxis(Pu,t)},translateZ:function(t){return this.translateOnAxis(Du,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Mi.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?Do.copy(t):Do.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ts.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Mi.lookAt(Ts,Do,this.up):Mi.lookAt(Do,Ts,this.up),this.quaternion.setFromRotationMatrix(Mi),i&&(Mi.extractRotation(i.matrixWorld),zr.setFromRotationMatrix(Mi),this.quaternion.premultiply(zr.inverse()))},add:function(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(nm)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Iu)),this},clear:function(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Iu)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),Mi.getInverse(this.matrixWorld),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Mi.multiply(t.parent.matrixWorld)),t.applyMatrix4(Mi),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const s=this.children[n].getObjectByProperty(t,e);if(s!==void 0)return s}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new P),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new mn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ts,t,em),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new P),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ts,tm,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new P),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)},traverseAncestors:function(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].updateWorldMatrix(!1,!0)}},toJSON:function(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON());function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(t)),a.uuid}if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const a=o.shapes;if(Array.isArray(a))for(let u=0,l=a.length;u<l;u++){const d=a[u];r(t.shapes,d)}else r(t.shapes,a)}}if(this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let a=0,u=this.material.length;a<u;a++)o.push(r(t.materials,this.material[a]));i.material=o}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(t).object)}if(e){const o=s(t.geometries),a=s(t.materials),u=s(t.textures),l=s(t.images),d=s(t.shapes);o.length>0&&(n.geometries=o),a.length>0&&(n.materials=a),u.length>0&&(n.textures=u),l.length>0&&(n.images=l),d.length>0&&(n.shapes=d)}return n.object=i,n;function s(o){const a=[];for(const u in o){const l=o[u];delete l.metadata,a.push(l)}return a}},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,e){if(e===void 0&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const i=t.children[n];this.add(i.clone())}return this}});const fc=new P,im=new P,rm=new _n;class Ai{constructor(e,n){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=e!==void 0?e:new P(1,0,0),this.constant=n!==void 0?n:0}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=fc.subVectors(i,n).cross(im.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}clone(){return new this.constructor().copy(this)}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new P),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new P);const i=e.delta(fc),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):void 0;const s=-(e.start.dot(this.normal)+this.constant)/r;if(!(s<0||s>1))return n.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new P),e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||rm.getNormalMatrix(e),r=this.coplanarPoint(fc).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}const Xn=new P,Si=new P,dc=new P,Ti=new P,kr=new P,Ur=new P,Nu=new P,pc=new P,mc=new P,gc=new P;class hn{constructor(e,n,i){this.a=e!==void 0?e:new P,this.b=n!==void 0?n:new P,this.c=i!==void 0?i:new P}static getNormal(e,n,i,r){r===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new P),r.subVectors(i,n),Xn.subVectors(e,n),r.cross(Xn);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Xn.subVectors(r,n),Si.subVectors(i,n),dc.subVectors(e,n);const o=Xn.dot(Xn),a=Xn.dot(Si),u=Xn.dot(dc),l=Si.dot(Si),d=Si.dot(dc),h=o*l-a*a;if(s===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new P),h===0)return s.set(-2,-1,-1);const g=1/h,m=(l*u-a*d)*g,y=(o*d-a*u)*g;return s.set(1-m-y,y,m)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Ti),Ti.x>=0&&Ti.y>=0&&Ti.x+Ti.y<=1}static getUV(e,n,i,r,s,o,a,u){return this.getBarycoord(e,n,i,r,Ti),u.set(0,0),u.addScaledVector(s,Ti.x),u.addScaledVector(o,Ti.y),u.addScaledVector(a,Ti.z),u}static isFrontFacing(e,n,i,r){return Xn.subVectors(i,n),Si.subVectors(e,n),Xn.cross(Si).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Xn.subVectors(this.c,this.b),Si.subVectors(this.a,this.b),Xn.cross(Si).length()*.5}getMidpoint(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new P),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return hn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Ai),e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return hn.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,r,s){return hn.getUV(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return hn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return hn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new P);const i=this.a,r=this.b,s=this.c;let o,a;kr.subVectors(r,i),Ur.subVectors(s,i),pc.subVectors(e,i);const u=kr.dot(pc),l=Ur.dot(pc);if(u<=0&&l<=0)return n.copy(i);mc.subVectors(e,r);const d=kr.dot(mc),h=Ur.dot(mc);if(d>=0&&h<=d)return n.copy(r);const g=u*h-d*l;if(g<=0&&u>=0&&d<=0)return o=u/(u-d),n.copy(i).addScaledVector(kr,o);gc.subVectors(e,s);const m=kr.dot(gc),y=Ur.dot(gc);if(y>=0&&m<=y)return n.copy(s);const w=m*l-u*y;if(w<=0&&l>=0&&y<=0)return a=l/(l-y),n.copy(i).addScaledVector(Ur,a);const M=d*y-m*h;if(M<=0&&h-d>=0&&m-y>=0)return Nu.subVectors(s,r),a=(h-d)/(h-d+(m-y)),n.copy(r).addScaledVector(Nu,a);const _=1/(M+w+g);return o=w*_,a=g*_,n.copy(i).addScaledVector(kr,o).addScaledVector(Ur,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Uh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yn={h:0,s:0,l:0},Io={h:0,s:0,l:0};function yc(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}function vc(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function xc(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}class He{constructor(e,n,i){return Object.defineProperty(this,"isColor",{value:!0}),n===void 0&&i===void 0?this.set(e):this.setRGB(e,n,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this}setRGB(e,n,i){return this.r=e,this.g=n,this.b=i,this}setHSL(e,n,i){if(e=at.euclideanModulo(e,1),n=at.clamp(n,0,1),i=at.clamp(i,0,1),n===0)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+n):i+n-i*n,s=2*i-r;this.r=yc(s,r,e+1/3),this.g=yc(s,r,e),this.b=yc(s,r,e-1/3)}return this}setStyle(e){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){let r;const s=i[1],o=i[2];switch(s){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,n(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,n(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){const a=parseFloat(r[1])/360,u=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return n(r[5]),this.setHSL(a,u,l)}break}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){const r=i[1],s=r.length;if(s===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const n=Uh[e];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,n){return n===void 0&&(n=2),this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}copyLinearToGamma(e,n){n===void 0&&(n=2);const i=n>0?1/n:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=vc(e.r),this.g=vc(e.g),this.b=vc(e.b),this}copyLinearToSRGB(e){return this.r=xc(e.r),this.g=xc(e.g),this.b=xc(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const n=this.r,i=this.g,r=this.b,s=Math.max(n,i,r),o=Math.min(n,i,r);let a,u;const l=(o+s)/2;if(o===s)a=0,u=0;else{const d=s-o;switch(u=l<=.5?d/(s+o):d/(2-s-o),s){case n:a=(i-r)/d+(i<r?6:0);break;case i:a=(r-n)/d+2;break;case r:a=(n-i)/d+4;break}a/=6}return e.h=a,e.s=u,e.l=l,e}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(e,n,i){return this.getHSL(Yn),Yn.h+=e,Yn.s+=n,Yn.l+=i,this.setHSL(Yn.h,Yn.s,Yn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpHSL(e,n){this.getHSL(Yn),e.getHSL(Io);const i=at.lerp(Yn.h,Io.h,n),r=at.lerp(Yn.s,Io.s,n),s=at.lerp(Yn.l,Io.l,n);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}He.NAMES=Uh;He.prototype.r=1;He.prototype.g=1;He.prototype.b=1;class kc{constructor(e,n,i,r,s,o){this.a=e,this.b=n,this.c=i,this.normal=r&&r.isVector3?r:new P,this.vertexNormals=Array.isArray(r)?r:[],this.color=s&&s.isColor?s:new He,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=o!==void 0?o:0}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let n=0,i=e.vertexNormals.length;n<i;n++)this.vertexNormals[n]=e.vertexNormals[n].clone();for(let n=0,i=e.vertexColors.length;n<i;n++)this.vertexColors[n]=e.vertexColors[n].clone();return this}}let sm=0;function Ye(){Object.defineProperty(this,"id",{value:sm++}),this.uuid=at.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Bs,this.side=Ea,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Nh,this.blendDst=Oh,this.blendEquation=Zr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Nc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Yp,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=sc,this.stencilZFail=sc,this.stencilZPass=sc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Ye.prototype=Object.assign(Object.create(ti.prototype),{constructor:Ye,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Ih;continue}const i=this[e];if(i===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n}},toJSON:function(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,this.combine!==void 0&&(n.combine=this.combine),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Bs&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==Ea&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function i(r){const s=[];for(const o in r){const a=r[o];delete a.metadata,s.push(a)}return s}if(e){const r=i(t.textures),s=i(t.images);r.length>0&&(n.textures=r),s.length>0&&(n.images=s)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const i=e.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(Ye.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});function mr(t){Ye.call(this),this.type="MeshBasicMaterial",this.color=new He(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=La,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}mr.prototype=Object.create(Ye.prototype);mr.prototype.constructor=mr;mr.prototype.isMeshBasicMaterial=!0;mr.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const Pt=new P,No=new oe;function ct(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n===!0,this.usage=Ia,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(ct.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});Object.assign(ct.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new He),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this},copyVector2sArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new oe),e[n++]=s.x,e[n++]=s.y}return this},copyVector3sArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new P),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this},copyVector4sArray:function(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new At),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this},applyMatrix3:function(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)No.fromBufferAttribute(this,e),No.applyMatrix3(t),this.setXY(e,No.x,No.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)Pt.fromBufferAttribute(this,e),Pt.applyMatrix3(t),this.setXYZ(e,Pt.x,Pt.y,Pt.z);return this},applyMatrix4:function(t){for(let e=0,n=this.count;e<n;e++)Pt.x=this.getX(e),Pt.y=this.getY(e),Pt.z=this.getZ(e),Pt.applyMatrix4(t),this.setXYZ(e,Pt.x,Pt.y,Pt.z);return this},applyNormalMatrix:function(t){for(let e=0,n=this.count;e<n;e++)Pt.x=this.getX(e),Pt.y=this.getY(e),Pt.z=this.getZ(e),Pt.applyNormalMatrix(t),this.setXYZ(e,Pt.x,Pt.y,Pt.z);return this},transformDirection:function(t){for(let e=0,n=this.count;e<n;e++)Pt.x=this.getX(e),Pt.y=this.getY(e),Pt.z=this.getZ(e),Pt.transformDirection(t),this.setXYZ(e,Pt.x,Pt.y,Pt.z);return this},set:function(t,e){return e===void 0&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Uc(t,e,n){ct.call(this,new Int8Array(t),e,n)}Uc.prototype=Object.create(ct.prototype);Uc.prototype.constructor=Uc;function Gc(t,e,n){ct.call(this,new Uint8Array(t),e,n)}Gc.prototype=Object.create(ct.prototype);Gc.prototype.constructor=Gc;function Hc(t,e,n){ct.call(this,new Uint8ClampedArray(t),e,n)}Hc.prototype=Object.create(ct.prototype);Hc.prototype.constructor=Hc;function Vc(t,e,n){ct.call(this,new Int16Array(t),e,n)}Vc.prototype=Object.create(ct.prototype);Vc.prototype.constructor=Vc;function js(t,e,n){ct.call(this,new Uint16Array(t),e,n)}js.prototype=Object.create(ct.prototype);js.prototype.constructor=js;function Wc(t,e,n){ct.call(this,new Int32Array(t),e,n)}Wc.prototype=Object.create(ct.prototype);Wc.prototype.constructor=Wc;function qs(t,e,n){ct.call(this,new Uint32Array(t),e,n)}qs.prototype=Object.create(ct.prototype);qs.prototype.constructor=qs;function Ue(t,e,n){ct.call(this,new Float32Array(t),e,n)}Ue.prototype=Object.create(ct.prototype);Ue.prototype.constructor=Ue;function jc(t,e,n){ct.call(this,new Float64Array(t),e,n)}jc.prototype=Object.create(ct.prototype);jc.prototype.constructor=jc;class om{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){const n=[];let i,r,s;const o=e.faces;for(r=0;r<o.length;r++){const a=o[r];a.materialIndex!==s&&(s=a.materialIndex,i!==void 0&&(i.count=r*3-i.start,n.push(i)),i={start:r*3,materialIndex:s})}i!==void 0&&(i.count=r*3-i.start,n.push(i)),this.groups=n}fromGeometry(e){const n=e.faces,i=e.vertices,r=e.faceVertexUvs,s=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,a=e.morphTargets,u=a.length;let l;if(u>0){l=[];for(let _=0;_<u;_++)l[_]={name:a[_].name,data:[]};this.morphTargets.position=l}const d=e.morphNormals,h=d.length;let g;if(h>0){g=[];for(let _=0;_<h;_++)g[_]={name:d[_].name,data:[]};this.morphTargets.normal=g}const m=e.skinIndices,y=e.skinWeights,w=m.length===i.length,M=y.length===i.length;i.length>0&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let _=0;_<n.length;_++){const v=n[_];this.vertices.push(i[v.a],i[v.b],i[v.c]);const E=v.vertexNormals;if(E.length===3)this.normals.push(E[0],E[1],E[2]);else{const p=v.normal;this.normals.push(p,p,p)}const R=v.vertexColors;if(R.length===3)this.colors.push(R[0],R[1],R[2]);else{const p=v.color;this.colors.push(p,p,p)}if(s===!0){const p=r[0][_];p!==void 0?this.uvs.push(p[0],p[1],p[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",_),this.uvs.push(new oe,new oe,new oe))}if(o===!0){const p=r[1][_];p!==void 0?this.uvs2.push(p[0],p[1],p[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",_),this.uvs2.push(new oe,new oe,new oe))}for(let p=0;p<u;p++){const A=a[p].vertices;l[p].data.push(A[v.a],A[v.b],A[v.c])}for(let p=0;p<h;p++){const A=d[p].vertexNormals[_];g[p].data.push(A.a,A.b,A.c)}w&&this.skinIndices.push(m[v.a],m[v.b],m[v.c]),M&&this.skinWeights.push(y[v.a],y[v.b],y[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}}function Gh(t){if(t.length===0)return-1/0;let e=t[0];for(let n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}let am=1;const si=new ht,_c=new je,Gr=new P,Cn=new Ki,Es=new Ki,Kt=new P;function lt(){Object.defineProperty(this,"id",{value:am+=2}),this.uuid=at.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}lt.prototype=Object.assign(Object.create(ti.prototype),{constructor:lt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(Gh(t)>65535?qs:js)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new _n().getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return si.makeRotationX(t),this.applyMatrix4(si),this},rotateY:function(t){return si.makeRotationY(t),this.applyMatrix4(si),this},rotateZ:function(t){return si.makeRotationZ(t),this.applyMatrix4(si),this},translate:function(t,e,n){return si.makeTranslation(t,e,n),this.applyMatrix4(si),this},scale:function(t,e,n){return si.makeScale(t,e,n),this.applyMatrix4(si),this},lookAt:function(t){return _c.lookAt(t),_c.updateMatrix(),this.applyMatrix4(_c.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gr).negate(),this.translate(Gr.x,Gr.y,Gr.z),this},setFromObject:function(t){const e=t.geometry;if(t.isPoints||t.isLine){const n=new Ue(e.vertices.length*3,3),i=new Ue(e.colors.length*3,3);if(this.setAttribute("position",n.copyVector3sArray(e.vertices)),this.setAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){const r=new Ue(e.lineDistances.length,1);this.setAttribute("lineDistance",r.copyArray(e.lineDistances))}e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){const e=[];for(let n=0,i=t.length;n<i;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Ue(e,3)),this},updateFromObject:function(t){let e=t.geometry;if(t.isMesh){let n=e.__directGeometry;if(e.elementsNeedUpdate===!0&&(n=void 0,e.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}if(e.verticesNeedUpdate===!0){const n=this.attributes.position;n!==void 0&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1}if(e.normalsNeedUpdate===!0){const n=this.attributes.normal;n!==void 0&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1}if(e.colorsNeedUpdate===!0){const n=this.attributes.color;n!==void 0&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1}if(e.uvsNeedUpdate){const n=this.attributes.uv;n!==void 0&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1}if(e.lineDistancesNeedUpdate){const n=this.attributes.lineDistance;n!==void 0&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1}return e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=new om().fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const e=new Float32Array(t.vertices.length*3);if(this.setAttribute("position",new ct(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){const n=new Float32Array(t.normals.length*3);this.setAttribute("normal",new ct(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const n=new Float32Array(t.colors.length*3);this.setAttribute("color",new ct(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const n=new Float32Array(t.uvs.length*2);this.setAttribute("uv",new ct(n,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const n=new Float32Array(t.uvs2.length*2);this.setAttribute("uv2",new ct(n,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const n in t.morphTargets){const i=[],r=t.morphTargets[n];for(let s=0,o=r.length;s<o;s++){const a=r[s],u=new Ue(a.data.length*3,3);u.name=a.name,i.push(u.copyVector3sArray(a.data))}this.morphAttributes[n]=i}if(t.skinIndices.length>0){const n=new Ue(t.skinIndices.length*4,4);this.setAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const n=new Ue(t.skinWeights.length*4,4);this.setAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))}return t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ki);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new P(-1/0,-1/0,-1/0),new P(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++){const r=e[n];Cn.setFromBufferAttribute(r),this.morphTargetsRelative?(Kt.addVectors(this.boundingBox.min,Cn.min),this.boundingBox.expandByPoint(Kt),Kt.addVectors(this.boundingBox.max,Cn.max),this.boundingBox.expandByPoint(Kt)):(this.boundingBox.expandByPoint(Cn.min),this.boundingBox.expandByPoint(Cn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new er);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new P,1/0);return}if(t){const n=this.boundingSphere.center;if(Cn.setFromBufferAttribute(t),e)for(let r=0,s=e.length;r<s;r++){const o=e[r];Es.setFromBufferAttribute(o),this.morphTargetsRelative?(Kt.addVectors(Cn.min,Es.min),Cn.expandByPoint(Kt),Kt.addVectors(Cn.max,Es.max),Cn.expandByPoint(Kt)):(Cn.expandByPoint(Es.min),Cn.expandByPoint(Es.max))}Cn.getCenter(n);let i=0;for(let r=0,s=t.count;r<s;r++)Kt.fromBufferAttribute(t,r),i=Math.max(i,n.distanceToSquared(Kt));if(e)for(let r=0,s=e.length;r<s;r++){const o=e[r],a=this.morphTargetsRelative;for(let u=0,l=o.count;u<l;u++)Kt.fromBufferAttribute(o,u),a&&(Gr.fromBufferAttribute(t,u),Kt.add(Gr)),i=Math.max(i,n.distanceToSquared(Kt))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new ct(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let h=0,g=n.count;h<g;h++)n.setXYZ(h,0,0,0);const i=new P,r=new P,s=new P,o=new P,a=new P,u=new P,l=new P,d=new P;if(t)for(let h=0,g=t.count;h<g;h+=3){const m=t.getX(h+0),y=t.getX(h+1),w=t.getX(h+2);i.fromBufferAttribute(e,m),r.fromBufferAttribute(e,y),s.fromBufferAttribute(e,w),l.subVectors(s,r),d.subVectors(i,r),l.cross(d),o.fromBufferAttribute(n,m),a.fromBufferAttribute(n,y),u.fromBufferAttribute(n,w),o.add(l),a.add(l),u.add(l),n.setXYZ(m,o.x,o.y,o.z),n.setXYZ(y,a.x,a.y,a.z),n.setXYZ(w,u.x,u.y,u.z)}else for(let h=0,g=e.count;h<g;h+=3)i.fromBufferAttribute(e,h+0),r.fromBufferAttribute(e,h+1),s.fromBufferAttribute(e,h+2),l.subVectors(s,r),d.subVectors(i,r),l.cross(d),n.setXYZ(h+0,l.x,l.y,l.z),n.setXYZ(h+1,l.x,l.y,l.z),n.setXYZ(h+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(t,e){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(t.attributes[i]===void 0)continue;const s=n[i].array,o=t.attributes[i],a=o.array,u=o.itemSize*e,l=Math.min(a.length,s.length-u);for(let d=0,h=u;d<l;d++,h++)s[h]=a[d]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Kt.fromBufferAttribute(t,e),Kt.normalize(),t.setXYZ(e,Kt.x,Kt.y,Kt.z)},toNonIndexed:function(){function t(o,a){const u=o.array,l=o.itemSize,d=o.normalized,h=new u.constructor(a.length*l);let g=0,m=0;for(let y=0,w=a.length;y<w;y++){g=a[y]*l;for(let M=0;M<l;M++)h[m++]=u[g++]}return new ct(h,l,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const e=new lt,n=this.index.array,i=this.attributes;for(const o in i){const a=i[o],u=t(a,n);e.setAttribute(o,u)}const r=this.morphAttributes;for(const o in r){const a=[],u=r[o];for(let l=0,d=u.length;l<d;l++){const h=u[l],g=t(h,n);a.push(g)}e.morphAttributes[o]=a}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const u=s[o];e.addGroup(u.start,u.count,u.materialIndex)}return e},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const a=this.parameters;for(const u in a)a[u]!==void 0&&(t[u]=a[u]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const a in n){const u=n[a],l=u.toJSON(t.data);u.name!==""&&(l.name=u.name),t.data.attributes[a]=l}const i={};let r=!1;for(const a in this.morphAttributes){const u=this.morphAttributes[a],l=[];for(let d=0,h=u.length;d<h;d++){const g=u[d],m=g.toJSON(t.data);g.name!==""&&(m.name=g.name),l.push(m)}l.length>0&&(i[a]=l,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t},clone:function(){return new lt().copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const i=t.attributes;for(const u in i){const l=i[u];this.setAttribute(u,l.clone(e))}const r=t.morphAttributes;for(const u in r){const l=[],d=r[u];for(let h=0,g=d.length;h<g;h++)l.push(d[h].clone(e));this.morphAttributes[u]=l}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let u=0,l=s.length;u<l;u++){const d=s[u];this.addGroup(d.start,d.count,d.materialIndex)}const o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());const a=t.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Ou=new ht,lr=new ho,bc=new er,Ui=new P,Gi=new P,Hi=new P,wc=new P,Mc=new P,Sc=new P,Oo=new P,Bo=new P,Fo=new P,Qr=new oe,Kr=new oe,es=new oe,ks=new P,zo=new P;function Jt(t,e){je.call(this),this.type="Mesh",this.geometry=t!==void 0?t:new lt,this.material=e!==void 0?e:new mr,this.updateMorphTargets()}Jt.prototype=Object.assign(Object.create(je.prototype),{constructor:Jt,isMesh:!0,copy:function(t){return je.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const i=e[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){const o=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),bc.copy(n.boundingSphere),bc.applyMatrix4(r),t.ray.intersectsSphere(bc)===!1)||(Ou.getInverse(r),lr.copy(t.ray).applyMatrix4(Ou),n.boundingBox!==null&&lr.intersectsBox(n.boundingBox)===!1))return;let s;if(n.isBufferGeometry){const o=n.index,a=n.attributes.position,u=n.morphAttributes.position,l=n.morphTargetsRelative,d=n.attributes.uv,h=n.attributes.uv2,g=n.groups,m=n.drawRange;if(o!==null)if(Array.isArray(i))for(let y=0,w=g.length;y<w;y++){const M=g[y],_=i[M.materialIndex],v=Math.max(M.start,m.start),E=Math.min(M.start+M.count,m.start+m.count);for(let R=v,p=E;R<p;R+=3){const A=o.getX(R),O=o.getX(R+1),H=o.getX(R+2);s=ko(this,_,t,lr,a,u,l,d,h,A,O,H),s&&(s.faceIndex=Math.floor(R/3),s.face.materialIndex=M.materialIndex,e.push(s))}}else{const y=Math.max(0,m.start),w=Math.min(o.count,m.start+m.count);for(let M=y,_=w;M<_;M+=3){const v=o.getX(M),E=o.getX(M+1),R=o.getX(M+2);s=ko(this,i,t,lr,a,u,l,d,h,v,E,R),s&&(s.faceIndex=Math.floor(M/3),e.push(s))}}else if(a!==void 0)if(Array.isArray(i))for(let y=0,w=g.length;y<w;y++){const M=g[y],_=i[M.materialIndex],v=Math.max(M.start,m.start),E=Math.min(M.start+M.count,m.start+m.count);for(let R=v,p=E;R<p;R+=3){const A=R,O=R+1,H=R+2;s=ko(this,_,t,lr,a,u,l,d,h,A,O,H),s&&(s.faceIndex=Math.floor(R/3),s.face.materialIndex=M.materialIndex,e.push(s))}}else{const y=Math.max(0,m.start),w=Math.min(a.count,m.start+m.count);for(let M=y,_=w;M<_;M+=3){const v=M,E=M+1,R=M+2;s=ko(this,i,t,lr,a,u,l,d,h,v,E,R),s&&(s.faceIndex=Math.floor(M/3),e.push(s))}}}else if(n.isGeometry){const o=Array.isArray(i),a=n.vertices,u=n.faces;let l;const d=n.faceVertexUvs[0];d.length>0&&(l=d);for(let h=0,g=u.length;h<g;h++){const m=u[h],y=o?i[m.materialIndex]:i;if(y===void 0)continue;const w=a[m.a],M=a[m.b],_=a[m.c];if(s=Hh(this,y,t,lr,w,M,_,ks),s){if(l&&l[h]){const v=l[h];Qr.copy(v[0]),Kr.copy(v[1]),es.copy(v[2]),s.uv=hn.getUV(ks,w,M,_,Qr,Kr,es,new oe)}s.face=m,s.faceIndex=h,e.push(s)}}}}});function Hh(t,e,n,i,r,s,o,a){let u;if(e.side===nn?u=i.intersectTriangle(o,s,r,!0,a):u=i.intersectTriangle(r,s,o,e.side!==Aa,a),u===null)return null;zo.copy(a),zo.applyMatrix4(t.matrixWorld);const l=n.ray.origin.distanceTo(zo);return l<n.near||l>n.far?null:{distance:l,point:zo.clone(),object:t}}function ko(t,e,n,i,r,s,o,a,u,l,d,h){Ui.fromBufferAttribute(r,l),Gi.fromBufferAttribute(r,d),Hi.fromBufferAttribute(r,h);const g=t.morphTargetInfluences;if(e.morphTargets&&s&&g){Oo.set(0,0,0),Bo.set(0,0,0),Fo.set(0,0,0);for(let y=0,w=s.length;y<w;y++){const M=g[y],_=s[y];M!==0&&(wc.fromBufferAttribute(_,l),Mc.fromBufferAttribute(_,d),Sc.fromBufferAttribute(_,h),o?(Oo.addScaledVector(wc,M),Bo.addScaledVector(Mc,M),Fo.addScaledVector(Sc,M)):(Oo.addScaledVector(wc.sub(Ui),M),Bo.addScaledVector(Mc.sub(Gi),M),Fo.addScaledVector(Sc.sub(Hi),M)))}Ui.add(Oo),Gi.add(Bo),Hi.add(Fo)}t.isSkinnedMesh&&(t.boneTransform(l,Ui),t.boneTransform(d,Gi),t.boneTransform(h,Hi));const m=Hh(t,e,n,i,Ui,Gi,Hi,ks);if(m){a&&(Qr.fromBufferAttribute(a,l),Kr.fromBufferAttribute(a,d),es.fromBufferAttribute(a,h),m.uv=hn.getUV(ks,Ui,Gi,Hi,Qr,Kr,es,new oe)),u&&(Qr.fromBufferAttribute(u,l),Kr.fromBufferAttribute(u,d),es.fromBufferAttribute(u,h),m.uv2=hn.getUV(ks,Ui,Gi,Hi,Qr,Kr,es,new oe));const y=new kc(l,d,h);hn.getNormal(Ui,Gi,Hi,y.normal),m.face=y}return m}class Na extends lt{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const u=[],l=[],d=[],h=[];let g=0,m=0;y("z","y","x",-1,-1,i,n,e,o,s,0),y("z","y","x",1,-1,i,n,-e,o,s,1),y("x","z","y",1,1,e,i,n,r,o,2),y("x","z","y",1,-1,e,i,-n,r,o,3),y("x","y","z",1,-1,e,n,i,r,s,4),y("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(u),this.setAttribute("position",new Ue(l,3)),this.setAttribute("normal",new Ue(d,3)),this.setAttribute("uv",new Ue(h,2));function y(w,M,_,v,E,R,p,A,O,H,ne){const se=R/O,B=p/H,j=R/2,Y=p/2,Q=A/2,X=O+1,Z=H+1;let le=0,de=0;const we=new P;for(let Ne=0;Ne<Z;Ne++){const Re=Ne*B-Y;for(let Je=0;Je<X;Je++){const tt=Je*se-j;we[w]=tt*v,we[M]=Re*E,we[_]=Q,l.push(we.x,we.y,we.z),we[w]=0,we[M]=0,we[_]=A>0?1:-1,d.push(we.x,we.y,we.z),h.push(Je/O),h.push(1-Ne/H),le+=1}}for(let Ne=0;Ne<H;Ne++)for(let Re=0;Re<O;Re++){const Je=g+Re+X*Ne,tt=g+Re+X*(Ne+1),_t=g+(Re+1)+X*(Ne+1),ue=g+(Re+1)+X*Ne;u.push(Je,tt,ue),u.push(tt,_t,ue),de+=6}a.addGroup(m,de,ne),m+=de,g+=le}}}function rs(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function ln(t){const e={};for(let n=0;n<t.length;n++){const i=rs(t[n]);for(const r in i)e[r]=i[r]}return e}const cm={clone:rs,merge:ln};var lm=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,um=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function bn(t){Ye.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=lm,this.fragmentShader=um,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}bn.prototype=Object.create(Ye.prototype);bn.prototype.constructor=bn;bn.prototype.isShaderMaterial=!0;bn.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=rs(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this};bn.prototype.toJSON=function(t){const e=Ye.prototype.toJSON.call(this,t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const s=this.uniforms[i].value;s&&s.isTexture?e.uniforms[i]={type:"t",value:s.toJSON(t).uuid}:s&&s.isColor?e.uniforms[i]={type:"c",value:s.getHex()}:s&&s.isVector2?e.uniforms[i]={type:"v2",value:s.toArray()}:s&&s.isVector3?e.uniforms[i]={type:"v3",value:s.toArray()}:s&&s.isVector4?e.uniforms[i]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?e.uniforms[i]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?e.uniforms[i]={type:"m4",value:s.toArray()}:e.uniforms[i]={value:s}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e};function $i(){je.call(this),this.type="Camera",this.matrixWorldInverse=new ht,this.projectionMatrix=new ht,this.projectionMatrixInverse=new ht}$i.prototype=Object.assign(Object.create(je.prototype),{constructor:$i,isCamera:!0,copy:function(t,e){return je.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new P),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){je.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){je.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function en(t,e,n,i){$i.call(this),this.type="PerspectiveCamera",this.fov=t!==void 0?t:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=i!==void 0?i:2e3,this.focus=10,this.aspect=e!==void 0?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}en.prototype=Object.assign(Object.create($i.prototype),{constructor:en,isPerspectiveCamera:!0,copy:function(t,e){return $i.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const e=.5*this.getFilmHeight()/t;this.fov=at.RAD2DEG*2*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(at.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return at.RAD2DEG*2*Math.atan(Math.tan(at.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=this.near;let e=t*Math.tan(at.DEG2RAD*.5*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const s=this.view;if(this.view!==null&&this.view.enabled){const a=s.fullWidth,u=s.fullHeight;r+=s.offsetX*i/a,e-=s.offsetY*n/u,i*=s.width/a,n*=s.height/u}const o=this.filmOffset;o!==0&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const e=je.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});const Hr=90,Vr=1;function ss(t,e,n){if(je.call(this),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const i=new en(Hr,Vr,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new P(1,0,0)),this.add(i);const r=new en(Hr,Vr,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new P(-1,0,0)),this.add(r);const s=new en(Hr,Vr,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new P(0,1,0)),this.add(s);const o=new en(Hr,Vr,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new P(0,-1,0)),this.add(o);const a=new en(Hr,Vr,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new P(0,0,1)),this.add(a);const u=new en(Hr,Vr,t,e);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new P(0,0,-1)),this.add(u),this.update=function(l,d){this.parent===null&&this.updateMatrixWorld();const h=l.xr.enabled,g=l.getRenderTarget();l.xr.enabled=!1;const m=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,l.setRenderTarget(n,0),l.render(d,i),l.setRenderTarget(n,1),l.render(d,r),l.setRenderTarget(n,2),l.render(d,s),l.setRenderTarget(n,3),l.render(d,o),l.setRenderTarget(n,4),l.render(d,a),n.texture.generateMipmaps=m,l.setRenderTarget(n,5),l.render(d,u),l.setRenderTarget(g),l.xr.enabled=h}}ss.prototype=Object.create(je.prototype);ss.prototype.constructor=ss;function Li(t,e,n,i,r,s,o,a,u,l){t=t!==void 0?t:[],e=e!==void 0?e:Ca,o=o!==void 0?o:fr,Ct.call(this,t,e,n,i,r,s,o,a,u,l),this.flipY=!1,this._needsFlipEnvMap=!0}Li.prototype=Object.create(Ct.prototype);Li.prototype.constructor=Li;Li.prototype.isCubeTexture=!0;Object.defineProperty(Li.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});function gr(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),Kn.call(this,t,t,e),e=e||{},this.texture=new Li(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture._needsFlipEnvMap=!1}gr.prototype=Object.create(Kn.prototype);gr.prototype.constructor=gr;gr.prototype.isWebGLCubeRenderTarget=!0;gr.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=Qn,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},i=new Na(5,5,5),r=new bn({name:"CubemapFromEquirect",uniforms:rs(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:nn,blending:Os});r.uniforms.tEquirect.value=e;const s=new Jt(i,r),o=e.minFilter;return e.minFilter===lo&&(e.minFilter=sn),new ss(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this};gr.prototype.clear=function(t,e,n,i){const r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)};function os(t,e,n,i,r,s,o,a,u,l,d,h){Ct.call(this,null,s,o,a,u,l,i,r,d,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=u!==void 0?u:un,this.minFilter=l!==void 0?l:un,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}os.prototype=Object.create(Ct.prototype);os.prototype.constructor=os;os.prototype.isDataTexture=!0;const Wr=new er,Uo=new P;class Oa{constructor(e,n,i,r,s,o){this.planes=[e!==void 0?e:new Ai,n!==void 0?n:new Ai,i!==void 0?i:new Ai,r!==void 0?r:new Ai,s!==void 0?s:new Ai,o!==void 0?o:new Ai]}set(e,n,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}clone(){return new this.constructor().copy(this)}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],u=i[4],l=i[5],d=i[6],h=i[7],g=i[8],m=i[9],y=i[10],w=i[11],M=i[12],_=i[13],v=i[14],E=i[15];return n[0].setComponents(a-r,h-u,w-g,E-M).normalize(),n[1].setComponents(a+r,h+u,w+g,E+M).normalize(),n[2].setComponents(a+s,h+l,w+m,E+_).normalize(),n[3].setComponents(a-s,h-l,w-m,E-_).normalize(),n[4].setComponents(a-o,h-d,w-y,E-v).normalize(),n[5].setComponents(a+o,h+d,w+y,E+v).normalize(),this}intersectsObject(e){const n=e.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Wr.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Wr)}intersectsSprite(e){return Wr.center.set(0,0,0),Wr.radius=.7071067811865476,Wr.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wr)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(Uo.x=r.normal.x>0?e.max.x:e.min.x,Uo.y=r.normal.y>0?e.max.y:e.min.y,Uo.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Uo)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}}function Vh(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function hm(t,e){const n=e.isWebGL2,i=new WeakMap;function r(l,d){const h=l.array,g=l.usage,m=t.createBuffer();t.bindBuffer(d,m),t.bufferData(d,h,g),l.onUploadCallback();let y=5126;return h instanceof Float32Array?y=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?y=5123:h instanceof Int16Array?y=5122:h instanceof Uint32Array?y=5125:h instanceof Int32Array?y=5124:h instanceof Int8Array?y=5120:h instanceof Uint8Array&&(y=5121),{buffer:m,type:y,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version}}function s(l,d,h){const g=d.array,m=d.updateRange;t.bindBuffer(h,l),m.count===-1?t.bufferSubData(h,0,g):(n?t.bufferSubData(h,m.offset*g.BYTES_PER_ELEMENT,g,m.offset,m.count):t.bufferSubData(h,m.offset*g.BYTES_PER_ELEMENT,g.subarray(m.offset,m.offset+m.count)),m.count=-1)}function o(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)}function a(l){l.isInterleavedBufferAttribute&&(l=l.data);const d=i.get(l);d&&(t.deleteBuffer(d.buffer),i.delete(l))}function u(l,d){if(l.isGLBufferAttribute){var h=i.get(l);(!h||h.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);const g=i.get(l);g===void 0?i.set(l,r(l,d)):g.version<l.version&&(s(g.buffer,l,d),g.version=l.version)}return{get:o,remove:a,update:u}}class Ll extends lt{constructor(e,n,i,r){super(),this.type="PlaneBufferGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r},e=e||1,n=n||1;const s=e/2,o=n/2,a=Math.floor(i)||1,u=Math.floor(r)||1,l=a+1,d=u+1,h=e/a,g=n/u,m=[],y=[],w=[],M=[];for(let _=0;_<d;_++){const v=_*g-o;for(let E=0;E<l;E++){const R=E*h-s;y.push(R,-v,0),w.push(0,0,1),M.push(E/a),M.push(1-_/u)}}for(let _=0;_<u;_++)for(let v=0;v<a;v++){const E=v+l*_,R=v+l*(_+1),p=v+1+l*(_+1),A=v+1+l*_;m.push(E,R,A),m.push(R,p,A)}this.setIndex(m),this.setAttribute("position",new Ue(y,3)),this.setAttribute("normal",new Ue(w,3)),this.setAttribute("uv",new Ue(M,2))}}var fm=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,dm=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,pm=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,mm=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,gm=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,ym="vec3 transformed = vec3( position );",vm=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,xm=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,_m=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,bm=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,wm=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Mm=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Sm=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Tm=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,Em=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,Am=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Lm=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Cm=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Rm=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Pm=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Dm=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Im=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Nm=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Om=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Bm="gl_FragColor = linearToOutputTexel( gl_FragColor );",Fm=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,zm=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,km=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Um=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Gm=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Hm=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Vm=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,Wm=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,jm=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,qm=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Xm=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Ym=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,Zm=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Jm=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,$m=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,Qm=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,Km=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,eg=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,tg=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ng=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,ig=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,rg=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,sg=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,og=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,ag=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,cg=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,lg=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,ug=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,hg=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,fg=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,dg=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,pg=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,mg=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gg=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,yg=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,vg=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,xg=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,_g=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,bg=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,wg=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,Mg=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,Sg=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Tg=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,Eg=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Ag=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Lg=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Cg=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Rg=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Pg=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Dg=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Ig=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Ng=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Og=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Bg=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Fg=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,zg=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,kg=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,Ug=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Gg=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Hg=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Vg=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Wg=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,jg=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,qg=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,Xg=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,Yg=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Zg=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Jg=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,$g=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Qg=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Kg=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,ey=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,ty=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ny=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,iy=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ry=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sy=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,oy=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ay=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,cy=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ly=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,uy=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,hy=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,fy=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dy=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,py=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,my=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gy=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yy=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vy=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,xy=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_y=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,by=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wy=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,My=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Sy=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ty=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,Ey=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Ay=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ly=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Cy=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Ry=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Py=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Dy=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const pt={alphamap_fragment:fm,alphamap_pars_fragment:dm,alphatest_fragment:pm,aomap_fragment:mm,aomap_pars_fragment:gm,begin_vertex:ym,beginnormal_vertex:vm,bsdfs:xm,bumpmap_pars_fragment:_m,clipping_planes_fragment:bm,clipping_planes_pars_fragment:wm,clipping_planes_pars_vertex:Mm,clipping_planes_vertex:Sm,color_fragment:Tm,color_pars_fragment:Em,color_pars_vertex:Am,color_vertex:Lm,common:Cm,cube_uv_reflection_fragment:Rm,defaultnormal_vertex:Pm,displacementmap_pars_vertex:Dm,displacementmap_vertex:Im,emissivemap_fragment:Nm,emissivemap_pars_fragment:Om,encodings_fragment:Bm,encodings_pars_fragment:Fm,envmap_fragment:zm,envmap_common_pars_fragment:km,envmap_pars_fragment:Um,envmap_pars_vertex:Gm,envmap_physical_pars_fragment:Qm,envmap_vertex:Hm,fog_vertex:Vm,fog_pars_vertex:Wm,fog_fragment:jm,fog_pars_fragment:qm,gradientmap_pars_fragment:Xm,lightmap_fragment:Ym,lightmap_pars_fragment:Zm,lights_lambert_vertex:Jm,lights_pars_begin:$m,lights_toon_fragment:Km,lights_toon_pars_fragment:eg,lights_phong_fragment:tg,lights_phong_pars_fragment:ng,lights_physical_fragment:ig,lights_physical_pars_fragment:rg,lights_fragment_begin:sg,lights_fragment_maps:og,lights_fragment_end:ag,logdepthbuf_fragment:cg,logdepthbuf_pars_fragment:lg,logdepthbuf_pars_vertex:ug,logdepthbuf_vertex:hg,map_fragment:fg,map_pars_fragment:dg,map_particle_fragment:pg,map_particle_pars_fragment:mg,metalnessmap_fragment:gg,metalnessmap_pars_fragment:yg,morphnormal_vertex:vg,morphtarget_pars_vertex:xg,morphtarget_vertex:_g,normal_fragment_begin:bg,normal_fragment_maps:wg,normalmap_pars_fragment:Mg,clearcoat_normal_fragment_begin:Sg,clearcoat_normal_fragment_maps:Tg,clearcoat_pars_fragment:Eg,packing:Ag,premultiplied_alpha_fragment:Lg,project_vertex:Cg,dithering_fragment:Rg,dithering_pars_fragment:Pg,roughnessmap_fragment:Dg,roughnessmap_pars_fragment:Ig,shadowmap_pars_fragment:Ng,shadowmap_pars_vertex:Og,shadowmap_vertex:Bg,shadowmask_pars_fragment:Fg,skinbase_vertex:zg,skinning_pars_vertex:kg,skinning_vertex:Ug,skinnormal_vertex:Gg,specularmap_fragment:Hg,specularmap_pars_fragment:Vg,tonemapping_fragment:Wg,tonemapping_pars_fragment:jg,transmissionmap_fragment:qg,transmissionmap_pars_fragment:Xg,uv_pars_fragment:Yg,uv_pars_vertex:Zg,uv_vertex:Jg,uv2_pars_fragment:$g,uv2_pars_vertex:Qg,uv2_vertex:Kg,worldpos_vertex:ey,background_frag:ty,background_vert:ny,cube_frag:iy,cube_vert:ry,depth_frag:sy,depth_vert:oy,distanceRGBA_frag:ay,distanceRGBA_vert:cy,equirect_frag:ly,equirect_vert:uy,linedashed_frag:hy,linedashed_vert:fy,meshbasic_frag:dy,meshbasic_vert:py,meshlambert_frag:my,meshlambert_vert:gy,meshmatcap_frag:yy,meshmatcap_vert:vy,meshtoon_frag:xy,meshtoon_vert:_y,meshphong_frag:by,meshphong_vert:wy,meshphysical_frag:My,meshphysical_vert:Sy,normal_frag:Ty,normal_vert:Ey,points_frag:Ay,points_vert:Ly,shadow_frag:Cy,shadow_vert:Ry,sprite_frag:Py,sprite_vert:Dy},Ae={common:{diffuse:{value:new He(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new _n},uv2Transform:{value:new _n},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new He(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new He(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _n}},sprite:{diffuse:{value:new He(15658734)},opacity:{value:1},center:{value:new oe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _n}}},li={basic:{uniforms:ln([Ae.common,Ae.specularmap,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.fog]),vertexShader:pt.meshbasic_vert,fragmentShader:pt.meshbasic_frag},lambert:{uniforms:ln([Ae.common,Ae.specularmap,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.fog,Ae.lights,{emissive:{value:new He(0)}}]),vertexShader:pt.meshlambert_vert,fragmentShader:pt.meshlambert_frag},phong:{uniforms:ln([Ae.common,Ae.specularmap,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.fog,Ae.lights,{emissive:{value:new He(0)},specular:{value:new He(1118481)},shininess:{value:30}}]),vertexShader:pt.meshphong_vert,fragmentShader:pt.meshphong_frag},standard:{uniforms:ln([Ae.common,Ae.envmap,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.roughnessmap,Ae.metalnessmap,Ae.fog,Ae.lights,{emissive:{value:new He(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pt.meshphysical_vert,fragmentShader:pt.meshphysical_frag},toon:{uniforms:ln([Ae.common,Ae.aomap,Ae.lightmap,Ae.emissivemap,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.gradientmap,Ae.fog,Ae.lights,{emissive:{value:new He(0)}}]),vertexShader:pt.meshtoon_vert,fragmentShader:pt.meshtoon_frag},matcap:{uniforms:ln([Ae.common,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,Ae.fog,{matcap:{value:null}}]),vertexShader:pt.meshmatcap_vert,fragmentShader:pt.meshmatcap_frag},points:{uniforms:ln([Ae.points,Ae.fog]),vertexShader:pt.points_vert,fragmentShader:pt.points_frag},dashed:{uniforms:ln([Ae.common,Ae.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pt.linedashed_vert,fragmentShader:pt.linedashed_frag},depth:{uniforms:ln([Ae.common,Ae.displacementmap]),vertexShader:pt.depth_vert,fragmentShader:pt.depth_frag},normal:{uniforms:ln([Ae.common,Ae.bumpmap,Ae.normalmap,Ae.displacementmap,{opacity:{value:1}}]),vertexShader:pt.normal_vert,fragmentShader:pt.normal_frag},sprite:{uniforms:ln([Ae.sprite,Ae.fog]),vertexShader:pt.sprite_vert,fragmentShader:pt.sprite_frag},background:{uniforms:{uvTransform:{value:new _n},t2D:{value:null}},vertexShader:pt.background_vert,fragmentShader:pt.background_frag},cube:{uniforms:ln([Ae.envmap,{opacity:{value:1}}]),vertexShader:pt.cube_vert,fragmentShader:pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pt.equirect_vert,fragmentShader:pt.equirect_frag},distanceRGBA:{uniforms:ln([Ae.common,Ae.displacementmap,{referencePosition:{value:new P},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pt.distanceRGBA_vert,fragmentShader:pt.distanceRGBA_frag},shadow:{uniforms:ln([Ae.lights,Ae.fog,{color:{value:new He(0)},opacity:{value:1}}]),vertexShader:pt.shadow_vert,fragmentShader:pt.shadow_frag}};li.physical={uniforms:ln([li.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new oe(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new He(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:pt.meshphysical_vert,fragmentShader:pt.meshphysical_frag};function Iy(t,e,n,i,r){const s=new He(0);let o=0,a,u,l=null,d=0,h=null;function g(y,w,M,_){let v=w.isScene===!0?w.background:null;v&&v.isTexture&&(v=e.get(v));const E=t.xr,R=E.getSession&&E.getSession();R&&R.environmentBlendMode==="additive"&&(v=null),v===null?m(s,o):v&&v.isColor&&(m(v,1),_=!0),(t.autoClear||_)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),v&&(v.isCubeTexture||v.isWebGLCubeRenderTarget||v.mapping===Pa)?(u===void 0&&(u=new Jt(new Na(1,1,1),new bn({name:"BackgroundCubeMaterial",uniforms:rs(li.cube.uniforms),vertexShader:li.cube.vertexShader,fragmentShader:li.cube.fragmentShader,side:nn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(p,A,O){this.matrixWorld.copyPosition(O.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),v.isWebGLCubeRenderTarget&&(v=v.texture),u.material.uniforms.envMap.value=v,u.material.uniforms.flipEnvMap.value=v.isCubeTexture&&v._needsFlipEnvMap?-1:1,(l!==v||d!==v.version||h!==t.toneMapping)&&(u.material.needsUpdate=!0,l=v,d=v.version,h=t.toneMapping),y.unshift(u,u.geometry,u.material,0,0,null)):v&&v.isTexture&&(a===void 0&&(a=new Jt(new Ll(2,2),new bn({name:"BackgroundMaterial",uniforms:rs(li.background.uniforms),vertexShader:li.background.vertexShader,fragmentShader:li.background.fragmentShader,side:Ea,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=v,v.matrixAutoUpdate===!0&&v.updateMatrix(),a.material.uniforms.uvTransform.value.copy(v.matrix),(l!==v||d!==v.version||h!==t.toneMapping)&&(a.material.needsUpdate=!0,l=v,d=v.version,h=t.toneMapping),y.unshift(a,a.geometry,a.material,0,0,null))}function m(y,w){n.buffers.color.setClear(y.r,y.g,y.b,w,r)}return{getClearColor:function(){return s},setClearColor:function(y,w){s.set(y),o=w!==void 0?w:1,m(s,o)},getClearAlpha:function(){return o},setClearAlpha:function(y){o=y,m(s,o)},render:g}}function Ny(t,e,n,i){const r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},u=w(null);let l=u;function d(Y,Q,X,Z,le){let de=!1;if(o){const we=y(Z,X,Q);l!==we&&(l=we,g(l.object)),de=M(Z,le),de&&_(Z,le)}else{const we=Q.wireframe===!0;(l.geometry!==Z.id||l.program!==X.id||l.wireframe!==we)&&(l.geometry=Z.id,l.program=X.id,l.wireframe=we,de=!0)}Y.isInstancedMesh===!0&&(de=!0),le!==null&&n.update(le,34963),de&&(O(Y,Q,X,Z),le!==null&&t.bindBuffer(34963,n.get(le).buffer))}function h(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function g(Y){return i.isWebGL2?t.bindVertexArray(Y):s.bindVertexArrayOES(Y)}function m(Y){return i.isWebGL2?t.deleteVertexArray(Y):s.deleteVertexArrayOES(Y)}function y(Y,Q,X){const Z=X.wireframe===!0;let le=a[Y.id];le===void 0&&(le={},a[Y.id]=le);let de=le[Q.id];de===void 0&&(de={},le[Q.id]=de);let we=de[Z];return we===void 0&&(we=w(h()),de[Z]=we),we}function w(Y){const Q=[],X=[],Z=[];for(let le=0;le<r;le++)Q[le]=0,X[le]=0,Z[le]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Q,enabledAttributes:X,attributeDivisors:Z,object:Y,attributes:{},index:null}}function M(Y,Q){const X=l.attributes,Z=Y.attributes;if(Object.keys(X).length!==Object.keys(Z).length)return!0;for(const le in Z){const de=X[le],we=Z[le];if(de===void 0||de.attribute!==we||de.data!==we.data)return!0}return l.index!==Q}function _(Y,Q){const X={},Z=Y.attributes;for(const le in Z){const de=Z[le],we={};we.attribute=de,de.data&&(we.data=de.data),X[le]=we}l.attributes=X,l.index=Q}function v(){const Y=l.newAttributes;for(let Q=0,X=Y.length;Q<X;Q++)Y[Q]=0}function E(Y){R(Y,0)}function R(Y,Q){const X=l.newAttributes,Z=l.enabledAttributes,le=l.attributeDivisors;X[Y]=1,Z[Y]===0&&(t.enableVertexAttribArray(Y),Z[Y]=1),le[Y]!==Q&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Y,Q),le[Y]=Q)}function p(){const Y=l.newAttributes,Q=l.enabledAttributes;for(let X=0,Z=Q.length;X<Z;X++)Q[X]!==Y[X]&&(t.disableVertexAttribArray(X),Q[X]=0)}function A(Y,Q,X,Z,le,de){i.isWebGL2===!0&&(X===5124||X===5125)?t.vertexAttribIPointer(Y,Q,X,le,de):t.vertexAttribPointer(Y,Q,X,Z,le,de)}function O(Y,Q,X,Z){if(i.isWebGL2===!1&&(Y.isInstancedMesh||Z.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;v();const le=Z.attributes,de=X.getAttributes(),we=Q.defaultAttributeValues;for(const Ne in de){const Re=de[Ne];if(Re>=0){const Je=le[Ne];if(Je!==void 0){const tt=Je.normalized,_t=Je.itemSize,ue=n.get(Je);if(ue===void 0)continue;const bt=ue.buffer,We=ue.type,ft=ue.bytesPerElement;if(Je.isInterleavedBufferAttribute){const Ke=Je.data,it=Ke.stride,Ze=Je.offset;Ke&&Ke.isInstancedInterleavedBuffer?(R(Re,Ke.meshPerAttribute),Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=Ke.meshPerAttribute*Ke.count)):E(Re),t.bindBuffer(34962,bt),A(Re,_t,We,tt,it*ft,Ze*ft)}else Je.isInstancedBufferAttribute?(R(Re,Je.meshPerAttribute),Z._maxInstanceCount===void 0&&(Z._maxInstanceCount=Je.meshPerAttribute*Je.count)):E(Re),t.bindBuffer(34962,bt),A(Re,_t,We,tt,0,0)}else if(Ne==="instanceMatrix"){const tt=n.get(Y.instanceMatrix);if(tt===void 0)continue;const _t=tt.buffer,ue=tt.type;R(Re+0,1),R(Re+1,1),R(Re+2,1),R(Re+3,1),t.bindBuffer(34962,_t),t.vertexAttribPointer(Re+0,4,ue,!1,64,0),t.vertexAttribPointer(Re+1,4,ue,!1,64,16),t.vertexAttribPointer(Re+2,4,ue,!1,64,32),t.vertexAttribPointer(Re+3,4,ue,!1,64,48)}else if(Ne==="instanceColor"){const tt=n.get(Y.instanceColor);if(tt===void 0)continue;const _t=tt.buffer,ue=tt.type;R(Re,1),t.bindBuffer(34962,_t),t.vertexAttribPointer(Re,3,ue,!1,12,0)}else if(we!==void 0){const tt=we[Ne];if(tt!==void 0)switch(tt.length){case 2:t.vertexAttrib2fv(Re,tt);break;case 3:t.vertexAttrib3fv(Re,tt);break;case 4:t.vertexAttrib4fv(Re,tt);break;default:t.vertexAttrib1fv(Re,tt)}}}}p()}function H(){B();for(const Y in a){const Q=a[Y];for(const X in Q){const Z=Q[X];for(const le in Z)m(Z[le].object),delete Z[le];delete Q[X]}delete a[Y]}}function ne(Y){if(a[Y.id]===void 0)return;const Q=a[Y.id];for(const X in Q){const Z=Q[X];for(const le in Z)m(Z[le].object),delete Z[le];delete Q[X]}delete a[Y.id]}function se(Y){for(const Q in a){const X=a[Q];if(X[Y.id]===void 0)continue;const Z=X[Y.id];for(const le in Z)m(Z[le].object),delete Z[le];delete X[Y.id]}}function B(){j(),l!==u&&(l=u,g(l.object))}function j(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:d,reset:B,resetDefaultState:j,dispose:H,releaseStatesOfGeometry:ne,releaseStatesOfProgram:se,initAttributes:v,enableAttribute:E,disableUnusedAttributes:p}}function Oy(t,e,n,i){const r=i.isWebGL2;let s;function o(l){s=l}function a(l,d){t.drawArrays(s,l,d),n.update(d,s,1)}function u(l,d,h){if(h===0)return;let g,m;if(r)g=t,m="drawArraysInstanced";else if(g=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[m](s,l,d,h),n.update(d,s,h)}this.setMode=o,this.render=a,this.renderInstances=u}function By(t,e,n){let i;function r(){if(i!==void 0)return i;const A=e.get("EXT_texture_filter_anisotropic");return A!==null?i=t.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT):i=0,i}function s(A){if(A==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&t instanceof WebGL2ComputeRenderingContext;let a=n.precision!==void 0?n.precision:"highp";const u=s(a);u!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",u,"instead."),a=u);const l=n.logarithmicDepthBuffer===!0,d=t.getParameter(34930),h=t.getParameter(35660),g=t.getParameter(3379),m=t.getParameter(34076),y=t.getParameter(34921),w=t.getParameter(36347),M=t.getParameter(36348),_=t.getParameter(36349),v=h>0,E=o||!!e.get("OES_texture_float"),R=v&&E,p=o?t.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:l,maxTextures:d,maxVertexTextures:h,maxTextureSize:g,maxCubemapSize:m,maxAttributes:y,maxVertexUniforms:w,maxVaryings:M,maxFragmentUniforms:_,vertexTextures:v,floatFragmentTextures:E,floatVertexTextures:R,maxSamples:p}}function Fy(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new Ai,a=new _n,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(h,g,m){const y=h.length!==0||g||i!==0||r;return r=g,n=d(h,m,0),i=h.length,y},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1,l()},this.setState=function(h,g,m){const y=h.clippingPlanes,w=h.clipIntersection,M=h.clipShadows,_=t.get(h);if(!r||y===null||y.length===0||s&&!M)s?d(null):l();else{const v=s?0:i,E=v*4;let R=_.clippingState||null;u.value=R,R=d(y,g,E,m);for(let p=0;p!==E;++p)R[p]=n[p];_.clippingState=R,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=v}};function l(){u.value!==n&&(u.value=n,u.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(h,g,m,y){const w=h!==null?h.length:0;let M=null;if(w!==0){if(M=u.value,y!==!0||M===null){const _=m+w*4,v=g.matrixWorldInverse;a.getNormalMatrix(v),(M===null||M.length<_)&&(M=new Float32Array(_));for(let E=0,R=m;E!==w;++E,R+=4)o.copy(h[E]).applyMatrix4(v,a),o.normal.toArray(M,R),M[R+3]=o.constant}u.value=M,u.needsUpdate=!0}return e.numPlanes=w,e.numIntersection=0,M}}function zy(t){let e=new WeakMap;function n(o,a){return a===Oc?o.mapping=Ca:a===Bc&&(o.mapping=Ra),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===Oc||a===Bc)if(e.has(o)){const u=e.get(o).texture;return n(u,o.mapping)}else{const u=o.image;if(u&&u.height>0){const l=t.getRenderList(),d=t.getRenderTarget(),h=t.getRenderState(),g=new gr(u.height/2);return g.fromEquirectangularTexture(t,o),e.set(o,g),t.setRenderTarget(d),t.setRenderList(l),t.setRenderState(h),o.addEventListener("dispose",r),n(g.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const u=e.get(a);u!==void 0&&(e.delete(a),u.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}function ky(t){const e={};return{has:function(n){if(e[n]!==void 0)return e[n]!==null;let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i!==null},get:function(n){return this.has(n)||console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]}}}function Uy(t,e,n,i){const r=new WeakMap,s=new WeakMap;function o(h){const g=h.target,m=r.get(g);m.index!==null&&e.remove(m.index);for(const w in m.attributes)e.remove(m.attributes[w]);g.removeEventListener("dispose",o),r.delete(g);const y=s.get(m);y&&(e.remove(y),s.delete(m)),i.releaseStatesOfGeometry(m),g.isInstancedBufferGeometry===!0&&delete g._maxInstanceCount,n.memory.geometries--}function a(h,g){let m=r.get(g);return m||(g.addEventListener("dispose",o),g.isBufferGeometry?m=g:g.isGeometry&&(g._bufferGeometry===void 0&&(g._bufferGeometry=new lt().setFromObject(h)),m=g._bufferGeometry),r.set(g,m),n.memory.geometries++,m)}function u(h){const g=h.attributes;for(const y in g)e.update(g[y],34962);const m=h.morphAttributes;for(const y in m){const w=m[y];for(let M=0,_=w.length;M<_;M++)e.update(w[M],34962)}}function l(h){const g=[],m=h.index,y=h.attributes.position;let w=0;if(m!==null){const v=m.array;w=m.version;for(let E=0,R=v.length;E<R;E+=3){const p=v[E+0],A=v[E+1],O=v[E+2];g.push(p,A,A,O,O,p)}}else{const v=y.array;w=y.version;for(let E=0,R=v.length/3-1;E<R;E+=3){const p=E+0,A=E+1,O=E+2;g.push(p,A,A,O,O,p)}}const M=new(Gh(g)>65535?qs:js)(g,1);M.version=w;const _=s.get(h);_&&e.remove(_),s.set(h,M)}function d(h){const g=s.get(h);if(g){const m=h.index;m!==null&&g.version<m.version&&l(h)}else l(h);return s.get(h)}return{get:a,update:u,getWireframeAttribute:d}}function Gy(t,e,n,i){const r=i.isWebGL2;let s;function o(g){s=g}let a,u;function l(g){a=g.type,u=g.bytesPerElement}function d(g,m){t.drawElements(s,m,a,g*u),n.update(m,s,1)}function h(g,m,y){if(y===0)return;let w,M;if(r)w=t,M="drawElementsInstanced";else if(w=e.get("ANGLE_instanced_arrays"),M="drawElementsInstancedANGLE",w===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}w[M](s,m,a,g*u,y),n.update(m,s,y)}this.setMode=o,this.setIndex=l,this.render=d,this.renderInstances=h}function Hy(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case 4:n.triangles+=a*(s/3);break;case 1:n.lines+=a*(s/2);break;case 3:n.lines+=a*(s-1);break;case 2:n.lines+=a*s;break;case 0:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function Vy(t,e){return t[0]-e[0]}function Wy(t,e){return Math.abs(e[1])-Math.abs(t[1])}function jy(t){const e={},n=new Float32Array(8),i=[];for(let s=0;s<8;s++)i[s]=[s,0];function r(s,o,a,u){const l=s.morphTargetInfluences,d=l===void 0?0:l.length;let h=e[o.id];if(h===void 0){h=[];for(let M=0;M<d;M++)h[M]=[M,0];e[o.id]=h}for(let M=0;M<d;M++){const _=h[M];_[0]=M,_[1]=l[M]}h.sort(Wy);for(let M=0;M<8;M++)M<d&&h[M][1]?(i[M][0]=h[M][0],i[M][1]=h[M][1]):(i[M][0]=Number.MAX_SAFE_INTEGER,i[M][1]=0);i.sort(Vy);const g=a.morphTargets&&o.morphAttributes.position,m=a.morphNormals&&o.morphAttributes.normal;let y=0;for(let M=0;M<8;M++){const _=i[M],v=_[0],E=_[1];v!==Number.MAX_SAFE_INTEGER&&E?(g&&o.getAttribute("morphTarget"+M)!==g[v]&&o.setAttribute("morphTarget"+M,g[v]),m&&o.getAttribute("morphNormal"+M)!==m[v]&&o.setAttribute("morphNormal"+M,m[v]),n[M]=E,y+=E):(g&&o.getAttribute("morphTarget"+M)!==void 0&&o.deleteAttribute("morphTarget"+M),m&&o.getAttribute("morphNormal"+M)!==void 0&&o.deleteAttribute("morphNormal"+M),n[M]=0)}const w=o.morphTargetsRelative?1:1-y;u.getUniforms().setValue(t,"morphTargetBaseInfluence",w),u.getUniforms().setValue(t,"morphTargetInfluences",n)}return{update:r}}function qy(t,e,n,i){let r=new WeakMap;function s(a){const u=i.render.frame,l=a.geometry,d=e.get(a,l);return r.get(d)!==u&&(l.isGeometry&&d.updateFromObject(a),e.update(d),r.set(d,u)),a.isInstancedMesh&&(n.update(a.instanceMatrix,34962),a.instanceColor!==null&&n.update(a.instanceColor,34962)),d}function o(){r=new WeakMap}return{update:s,dispose:o}}function Xs(t,e,n,i){Ct.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:i||1},this.magFilter=un,this.minFilter=un,this.wrapR=xn,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Xs.prototype=Object.create(Ct.prototype);Xs.prototype.constructor=Xs;Xs.prototype.isDataTexture2DArray=!0;function Ys(t,e,n,i){Ct.call(this,null),this.image={data:t||null,width:e||1,height:n||1,depth:i||1},this.magFilter=un,this.minFilter=un,this.wrapR=xn,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ys.prototype=Object.create(Ct.prototype);Ys.prototype.constructor=Ys;Ys.prototype.isDataTexture3D=!0;const Wh=new Ct,Xy=new Xs,Yy=new Ys,jh=new Li,Bu=[],Fu=[],zu=new Float32Array(16),ku=new Float32Array(9),Uu=new Float32Array(4);function ms(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=Bu[r];if(s===void 0&&(s=new Float32Array(r),Bu[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function Fn(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Rn(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function qh(t,e){let n=Fu[e];n===void 0&&(n=new Int32Array(e),Fu[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Zy(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Jy(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Fn(n,e))return;t.uniform2fv(this.addr,e),Rn(n,e)}}function $y(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Fn(n,e))return;t.uniform3fv(this.addr,e),Rn(n,e)}}function Qy(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Fn(n,e))return;t.uniform4fv(this.addr,e),Rn(n,e)}}function Ky(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Fn(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Rn(n,e)}else{if(Fn(n,i))return;Uu.set(i),t.uniformMatrix2fv(this.addr,!1,Uu),Rn(n,i)}}function ev(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Fn(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Rn(n,e)}else{if(Fn(n,i))return;ku.set(i),t.uniformMatrix3fv(this.addr,!1,ku),Rn(n,i)}}function tv(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Fn(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Rn(n,e)}else{if(Fn(n,i))return;zu.set(i),t.uniformMatrix4fv(this.addr,!1,zu),Rn(n,i)}}function nv(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||Wh,r)}function iv(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Xy,r)}function rv(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Yy,r)}function sv(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||jh,r)}function ov(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function av(t,e){const n=this.cache;Fn(n,e)||(t.uniform2iv(this.addr,e),Rn(n,e))}function cv(t,e){const n=this.cache;Fn(n,e)||(t.uniform3iv(this.addr,e),Rn(n,e))}function lv(t,e){const n=this.cache;Fn(n,e)||(t.uniform4iv(this.addr,e),Rn(n,e))}function uv(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function hv(t){switch(t){case 5126:return Zy;case 35664:return Jy;case 35665:return $y;case 35666:return Qy;case 35674:return Ky;case 35675:return ev;case 35676:return tv;case 5124:case 35670:return ov;case 35667:case 35671:return av;case 35668:case 35672:return cv;case 35669:case 35673:return lv;case 5125:return uv;case 35678:case 36198:case 36298:case 36306:case 35682:return nv;case 35679:case 36299:case 36307:return rv;case 35680:case 36300:case 36308:case 36293:return sv;case 36289:case 36303:case 36311:case 36292:return iv}}function fv(t,e){t.uniform1fv(this.addr,e)}function dv(t,e){t.uniform1iv(this.addr,e)}function pv(t,e){t.uniform2iv(this.addr,e)}function mv(t,e){t.uniform3iv(this.addr,e)}function gv(t,e){t.uniform4iv(this.addr,e)}function yv(t,e){const n=ms(e,this.size,2);t.uniform2fv(this.addr,n)}function vv(t,e){const n=ms(e,this.size,3);t.uniform3fv(this.addr,n)}function xv(t,e){const n=ms(e,this.size,4);t.uniform4fv(this.addr,n)}function _v(t,e){const n=ms(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function bv(t,e){const n=ms(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function wv(t,e){const n=ms(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Mv(t,e,n){const i=e.length,r=qh(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.safeSetTexture2D(e[s]||Wh,r[s])}function Sv(t,e,n){const i=e.length,r=qh(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.safeSetTextureCube(e[s]||jh,r[s])}function Tv(t){switch(t){case 5126:return fv;case 35664:return yv;case 35665:return vv;case 35666:return xv;case 35674:return _v;case 35675:return bv;case 35676:return wv;case 5124:case 35670:return dv;case 35667:case 35671:return pv;case 35668:case 35672:return mv;case 35669:case 35673:return gv;case 35678:case 36198:case 36298:case 36306:case 35682:return Mv;case 35680:case 36300:case 36308:case 36293:return Sv}}function Ev(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=hv(e.type)}function Xh(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=Tv(e.type)}Xh.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Rn(e,t)};function Yh(t){this.id=t,this.seq=[],this.map={}}Yh.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const o=i[r];o.setValue(t,e[o.id],n)}};const Tc=/([\w\d_]+)(\])?(\[|\.)?/g;function Gu(t,e){t.seq.push(e),t.map[e.id]=e}function Av(t,e,n){const i=t.name,r=i.length;for(Tc.lastIndex=0;;){const s=Tc.exec(i),o=Tc.lastIndex;let a=s[1];const u=s[2]==="]",l=s[3];if(u&&(a=a|0),l===void 0||l==="["&&o+2===r){Gu(n,l===void 0?new Ev(a,t,e):new Xh(a,t,e));break}else{let h=n.map[a];h===void 0&&(h=new Yh(a),Gu(n,h)),n=h}}}function Yi(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const r=t.getActiveUniform(e,i),s=t.getUniformLocation(e,r.name);Av(r,s,this)}}Yi.prototype.setValue=function(t,e,n,i){const r=this.map[e];r!==void 0&&r.setValue(t,n,i)};Yi.prototype.setOptional=function(t,e,n){const i=e[n];i!==void 0&&this.setValue(t,n,i)};Yi.upload=function(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const o=e[r],a=n[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,i)}};Yi.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.id in e&&n.push(s)}return n};function Hu(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}let Lv=0;function Cv(t){const e=t.split(`
`);for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join(`
`)}function Zh(t){switch(t){case uo:return["Linear","( value )"];case zh:return["sRGB","( value )"];case Up:return["RGBE","( value )"];case Hp:return["RGBM","( value, 7.0 )"];case Vp:return["RGBM","( value, 16.0 )"];case Wp:return["RGBD","( value, 256.0 )"];case kp:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Gp:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function Vu(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=t.getShaderSource(e);return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+r+Cv(s)}function As(t,e){const n=Zh(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Rv(t,e){const n=Zh(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Pv(t,e){let n;switch(e){case kd:n="Linear";break;case Ud:n="Reinhard";break;case Gd:n="OptimizedCineon";break;case Hd:n="ACESFilmic";break;case Vd:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Dv(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Is).join(`
`)}function Iv(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function Nv(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const o=t.getActiveAttrib(e,r).name;n[o]=t.getAttribLocation(e,o)}return n}function Is(t){return t!==""}function Wu(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function ju(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Ov=/^[ \t]*#include +<([\w\d./]+)>/gm;function qc(t){return t.replace(Ov,Bv)}function Bv(t,e){const n=pt[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return qc(n)}const Fv=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,zv=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function qu(t){return t.replace(zv,Jh).replace(Fv,kv)}function kv(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Jh(t,e,n,i)}function Jh(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Xu(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Uv(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Dh?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===yd?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Ds&&(e="SHADOWMAP_TYPE_VSM"),e}function Gv(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ca:case Ra:e="ENVMAP_TYPE_CUBE";break;case Pa:case Da:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Hv(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Ra:case Da:e="ENVMAP_MODE_REFRACTION";break}return e}function Vv(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case La:e="ENVMAP_BLENDING_MULTIPLY";break;case Fd:e="ENVMAP_BLENDING_MIX";break;case zd:e="ENVMAP_BLENDING_ADD";break}return e}function Wv(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const u=Uv(n),l=Gv(n),d=Hv(n),h=Vv(n),g=t.gammaFactor>0?t.gammaFactor:1,m=n.isWebGL2?"":Dv(n),y=Iv(s),w=r.createProgram();let M,_,v=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(M=[y].filter(Is).join(`
`),M.length>0&&(M+=`
`),_=[m,y].filter(Is).join(`
`),_.length>0&&(_+=`
`)):(M=[Xu(n),"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Is).join(`
`),_=[m,Xu(n),"#define SHADER_NAME "+n.shaderName,y,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+d:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Fs?"#define TONE_MAPPING":"",n.toneMapping!==Fs?pt.tonemapping_pars_fragment:"",n.toneMapping!==Fs?Pv("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",pt.encodings_pars_fragment,n.map?As("mapTexelToLinear",n.mapEncoding):"",n.matcap?As("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?As("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?As("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?As("lightMapTexelToLinear",n.lightMapEncoding):"",Rv("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Is).join(`
`)),o=qc(o),o=Wu(o,n),o=ju(o,n),a=qc(a),a=Wu(a,n),a=ju(a,n),o=qu(o),a=qu(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,M=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,_=["#define varying in",n.glslVersion===Su?"":"out highp vec4 pc_fragColor;",n.glslVersion===Su?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+_);const E=v+M+o,R=v+_+a,p=Hu(r,35633,E),A=Hu(r,35632,R);if(r.attachShader(w,p),r.attachShader(w,A),n.index0AttributeName!==void 0?r.bindAttribLocation(w,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(w,0,"position"),r.linkProgram(w),t.debug.checkShaderErrors){const ne=r.getProgramInfoLog(w).trim(),se=r.getShaderInfoLog(p).trim(),B=r.getShaderInfoLog(A).trim();let j=!0,Y=!0;if(r.getProgramParameter(w,35714)===!1){j=!1;const Q=Vu(r,p,"vertex"),X=Vu(r,A,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(w,35715),"gl.getProgramInfoLog",ne,Q,X)}else ne!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",ne):(se===""||B==="")&&(Y=!1);Y&&(this.diagnostics={runnable:j,programLog:ne,vertexShader:{log:se,prefix:M},fragmentShader:{log:B,prefix:_}})}r.deleteShader(p),r.deleteShader(A);let O;this.getUniforms=function(){return O===void 0&&(O=new Yi(r,w)),O};let H;return this.getAttributes=function(){return H===void 0&&(H=Nv(r,w)),H},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(w),this.program=void 0},this.name=n.shaderName,this.id=Lv++,this.cacheKey=e,this.usedTimes=1,this.program=w,this.vertexShader=p,this.fragmentShader=A,this}function jv(t,e,n,i,r,s){const o=[],a=i.isWebGL2,u=i.logarithmicDepthBuffer,l=i.floatVertexTextures,d=i.maxVertexUniforms,h=i.vertexTextures;let g=i.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},y=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function w(A){const H=A.skeleton.bones;if(l)return 1024;{const se=Math.floor((d-20)/4),B=Math.min(se,H.length);return B<H.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+H.length+" bones. This GPU supports "+B+"."),0):B}}function M(A){let O;return A?A.isTexture?O=A.encoding:A.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),O=A.texture.encoding):O=uo,O}function _(A,O,H,ne,se){const B=ne.fog,j=A.isMeshStandardMaterial?ne.environment:null,Y=e.get(A.envMap||j),Q=m[A.type],X=se.isSkinnedMesh?w(se):0;A.precision!==null&&(g=i.getMaxPrecision(A.precision),g!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",g,"instead."));let Z,le;if(Q){const Ne=li[Q];Z=Ne.vertexShader,le=Ne.fragmentShader}else Z=A.vertexShader,le=A.fragmentShader;const de=t.getRenderTarget();return{isWebGL2:a,shaderID:Q,shaderName:A.type,vertexShader:Z,fragmentShader:le,defines:A.defines,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:g,instancing:se.isInstancedMesh===!0,instancingColor:se.isInstancedMesh===!0&&se.instanceColor!==null,supportsVertexTextures:h,outputEncoding:de!==null?M(de.texture):t.outputEncoding,map:!!A.map,mapEncoding:M(A.map),matcap:!!A.matcap,matcapEncoding:M(A.matcap),envMap:!!Y,envMapMode:Y&&Y.mapping,envMapEncoding:M(Y),envMapCubeUV:!!Y&&(Y.mapping===Pa||Y.mapping===Da),lightMap:!!A.lightMap,lightMapEncoding:M(A.lightMap),aoMap:!!A.aoMap,emissiveMap:!!A.emissiveMap,emissiveMapEncoding:M(A.emissiveMap),bumpMap:!!A.bumpMap,normalMap:!!A.normalMap,objectSpaceNormalMap:A.normalMapType===Xp,tangentSpaceNormalMap:A.normalMapType===ps,clearcoatMap:!!A.clearcoatMap,clearcoatRoughnessMap:!!A.clearcoatRoughnessMap,clearcoatNormalMap:!!A.clearcoatNormalMap,displacementMap:!!A.displacementMap,roughnessMap:!!A.roughnessMap,metalnessMap:!!A.metalnessMap,specularMap:!!A.specularMap,alphaMap:!!A.alphaMap,gradientMap:!!A.gradientMap,sheen:!!A.sheen,transmissionMap:!!A.transmissionMap,combine:A.combine,vertexTangents:A.normalMap&&A.vertexTangents,vertexColors:A.vertexColors,vertexUvs:!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatMap||!!A.clearcoatRoughnessMap||!!A.clearcoatNormalMap||!!A.displacementMap||!!A.transmissionMap,uvsVertexOnly:!(A.map||A.bumpMap||A.normalMap||A.specularMap||A.alphaMap||A.emissiveMap||A.roughnessMap||A.metalnessMap||A.clearcoatNormalMap||A.transmissionMap)&&!!A.displacementMap,fog:!!B,useFog:A.fog,fogExp2:B&&B.isFogExp2,flatShading:A.flatShading,sizeAttenuation:A.sizeAttenuation,logarithmicDepthBuffer:u,skinning:A.skinning&&X>0,maxBones:X,useVertexTexture:l,morphTargets:A.morphTargets,morphNormals:A.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:A.dithering,shadowMapEnabled:t.shadowMap.enabled&&H.length>0,shadowMapType:t.shadowMap.type,toneMapping:A.toneMapped?t.toneMapping:Fs,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:A.premultipliedAlpha,alphaTest:A.alphaTest,doubleSided:A.side===Aa,flipSided:A.side===nn,depthPacking:A.depthPacking!==void 0?A.depthPacking:!1,index0AttributeName:A.index0AttributeName,extensionDerivatives:A.extensions&&A.extensions.derivatives,extensionFragDepth:A.extensions&&A.extensions.fragDepth,extensionDrawBuffers:A.extensions&&A.extensions.drawBuffers,extensionShaderTextureLOD:A.extensions&&A.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||n.has("EXT_shader_texture_lod"),customProgramCacheKey:A.customProgramCacheKey()}}function v(A){const O=[];if(A.shaderID?O.push(A.shaderID):(O.push(A.fragmentShader),O.push(A.vertexShader)),A.defines!==void 0)for(const H in A.defines)O.push(H),O.push(A.defines[H]);if(A.isRawShaderMaterial===!1){for(let H=0;H<y.length;H++)O.push(A[y[H]]);O.push(t.outputEncoding),O.push(t.gammaFactor)}return O.push(A.customProgramCacheKey),O.join()}function E(A){const O=m[A.type];let H;if(O){const ne=li[O];H=cm.clone(ne.uniforms)}else H=A.uniforms;return H}function R(A,O){let H;for(let ne=0,se=o.length;ne<se;ne++){const B=o[ne];if(B.cacheKey===O){H=B,++H.usedTimes;break}}return H===void 0&&(H=new Wv(t,O,A,r),o.push(H)),H}function p(A){if(--A.usedTimes===0){const O=o.indexOf(A);o[O]=o[o.length-1],o.pop(),A.destroy()}}return{getParameters:_,getProgramCacheKey:v,getUniforms:E,acquireProgram:R,releaseProgram:p,programs:o}}function qv(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function Xv(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Yv(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Yu(t){const e=[];let n=0;const i=[],r=[],s={id:-1};function o(){n=0,i.length=0,r.length=0}function a(g,m,y,w,M,_){let v=e[n];const E=t.get(y);return v===void 0?(v={id:g.id,object:g,geometry:m,material:y,program:E.program||s,groupOrder:w,renderOrder:g.renderOrder,z:M,group:_},e[n]=v):(v.id=g.id,v.object=g,v.geometry=m,v.material=y,v.program=E.program||s,v.groupOrder=w,v.renderOrder=g.renderOrder,v.z=M,v.group=_),n++,v}function u(g,m,y,w,M,_){const v=a(g,m,y,w,M,_);(y.transparent===!0?r:i).push(v)}function l(g,m,y,w,M,_){const v=a(g,m,y,w,M,_);(y.transparent===!0?r:i).unshift(v)}function d(g,m){i.length>1&&i.sort(g||Xv),r.length>1&&r.sort(m||Yv)}function h(){for(let g=n,m=e.length;g<m;g++){const y=e[g];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.program=null,y.group=null}}return{opaque:i,transparent:r,init:o,push:u,unshift:l,finish:h,sort:d}}function Zv(t){let e=new WeakMap;function n(r,s){const o=e.get(r);let a;return o===void 0?(a=new Yu(t),e.set(r,new WeakMap),e.get(r).set(s,a)):(a=o.get(s),a===void 0&&(a=new Yu(t),o.set(s,a))),a}function i(){e=new WeakMap}return{get:n,dispose:i}}function Jv(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new P,color:new He};break;case"SpotLight":n={position:new P,direction:new P,color:new He,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new P,color:new He,distance:0,decay:0};break;case"HemisphereLight":n={direction:new P,skyColor:new He,groundColor:new He};break;case"RectAreaLight":n={color:new He,position:new P,halfWidth:new P,halfHeight:new P};break}return t[e.id]=n,n}}}function $v(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new oe,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Qv=0;function Kv(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function ex(t,e){const n=new Jv,i=$v(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)r.probe.push(new P);const s=new P,o=new ht,a=new ht;function u(l,d,h){let g=0,m=0,y=0;for(let ne=0;ne<9;ne++)r.probe[ne].set(0,0,0);let w=0,M=0,_=0,v=0,E=0,R=0,p=0,A=0;const O=h.matrixWorldInverse;l.sort(Kv);for(let ne=0,se=l.length;ne<se;ne++){const B=l[ne],j=B.color,Y=B.intensity,Q=B.distance,X=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)g+=j.r*Y,m+=j.g*Y,y+=j.b*Y;else if(B.isLightProbe)for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(B.sh.coefficients[Z],Y);else if(B.isDirectionalLight){const Z=n.get(B);if(Z.color.copy(B.color).multiplyScalar(B.intensity),Z.direction.setFromMatrixPosition(B.matrixWorld),s.setFromMatrixPosition(B.target.matrixWorld),Z.direction.sub(s),Z.direction.transformDirection(O),B.castShadow){const le=B.shadow,de=i.get(B);de.shadowBias=le.bias,de.shadowNormalBias=le.normalBias,de.shadowRadius=le.radius,de.shadowMapSize=le.mapSize,r.directionalShadow[w]=de,r.directionalShadowMap[w]=X,r.directionalShadowMatrix[w]=B.shadow.matrix,R++}r.directional[w]=Z,w++}else if(B.isSpotLight){const Z=n.get(B);if(Z.position.setFromMatrixPosition(B.matrixWorld),Z.position.applyMatrix4(O),Z.color.copy(j).multiplyScalar(Y),Z.distance=Q,Z.direction.setFromMatrixPosition(B.matrixWorld),s.setFromMatrixPosition(B.target.matrixWorld),Z.direction.sub(s),Z.direction.transformDirection(O),Z.coneCos=Math.cos(B.angle),Z.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),Z.decay=B.decay,B.castShadow){const le=B.shadow,de=i.get(B);de.shadowBias=le.bias,de.shadowNormalBias=le.normalBias,de.shadowRadius=le.radius,de.shadowMapSize=le.mapSize,r.spotShadow[_]=de,r.spotShadowMap[_]=X,r.spotShadowMatrix[_]=B.shadow.matrix,A++}r.spot[_]=Z,_++}else if(B.isRectAreaLight){const Z=n.get(B);Z.color.copy(j).multiplyScalar(Y),Z.position.setFromMatrixPosition(B.matrixWorld),Z.position.applyMatrix4(O),a.identity(),o.copy(B.matrixWorld),o.premultiply(O),a.extractRotation(o),Z.halfWidth.set(B.width*.5,0,0),Z.halfHeight.set(0,B.height*.5,0),Z.halfWidth.applyMatrix4(a),Z.halfHeight.applyMatrix4(a),r.rectArea[v]=Z,v++}else if(B.isPointLight){const Z=n.get(B);if(Z.position.setFromMatrixPosition(B.matrixWorld),Z.position.applyMatrix4(O),Z.color.copy(B.color).multiplyScalar(B.intensity),Z.distance=B.distance,Z.decay=B.decay,B.castShadow){const le=B.shadow,de=i.get(B);de.shadowBias=le.bias,de.shadowNormalBias=le.normalBias,de.shadowRadius=le.radius,de.shadowMapSize=le.mapSize,de.shadowCameraNear=le.camera.near,de.shadowCameraFar=le.camera.far,r.pointShadow[M]=de,r.pointShadowMap[M]=X,r.pointShadowMatrix[M]=B.shadow.matrix,p++}r.point[M]=Z,M++}else if(B.isHemisphereLight){const Z=n.get(B);Z.direction.setFromMatrixPosition(B.matrixWorld),Z.direction.transformDirection(O),Z.direction.normalize(),Z.skyColor.copy(B.color).multiplyScalar(Y),Z.groundColor.copy(B.groundColor).multiplyScalar(Y),r.hemi[E]=Z,E++}}v>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Ae.LTC_FLOAT_1,r.rectAreaLTC2=Ae.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Ae.LTC_HALF_1,r.rectAreaLTC2=Ae.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=g,r.ambient[1]=m,r.ambient[2]=y;const H=r.hash;(H.directionalLength!==w||H.pointLength!==M||H.spotLength!==_||H.rectAreaLength!==v||H.hemiLength!==E||H.numDirectionalShadows!==R||H.numPointShadows!==p||H.numSpotShadows!==A)&&(r.directional.length=w,r.spot.length=_,r.rectArea.length=v,r.point.length=M,r.hemi.length=E,r.directionalShadow.length=R,r.directionalShadowMap.length=R,r.pointShadow.length=p,r.pointShadowMap.length=p,r.spotShadow.length=A,r.spotShadowMap.length=A,r.directionalShadowMatrix.length=R,r.pointShadowMatrix.length=p,r.spotShadowMatrix.length=A,H.directionalLength=w,H.pointLength=M,H.spotLength=_,H.rectAreaLength=v,H.hemiLength=E,H.numDirectionalShadows=R,H.numPointShadows=p,H.numSpotShadows=A,r.version=Qv++)}return{setup:u,state:r}}function Zu(t,e){const n=new ex(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(d){i.push(d)}function a(d){r.push(d)}function u(d){n.setup(i,r,d)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:u,pushLight:o,pushShadow:a}}function tx(t,e){let n=new WeakMap;function i(s,o){let a;return n.has(s)===!1?(a=new Zu(t,e),n.set(s,new WeakMap),n.get(s).set(o,a)):n.get(s).has(o)===!1?(a=new Zu(t,e),n.get(s).set(o,a)):a=n.get(s).get(o),a}function r(){n=new WeakMap}return{get:i,dispose:r}}function yr(t){Ye.call(this),this.type="MeshDepthMaterial",this.depthPacking=jp,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}yr.prototype=Object.create(Ye.prototype);yr.prototype.constructor=yr;yr.prototype.isMeshDepthMaterial=!0;yr.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this};function vr(t){Ye.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new P,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}vr.prototype=Object.create(Ye.prototype);vr.prototype.constructor=vr;vr.prototype.isMeshDistanceMaterial=!0;vr.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var nx=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,ix=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function $h(t,e,n){let i=new Oa;const r=new oe,s=new oe,o=new At,a=[],u=[],l={},d={0:nn,1:Ea,2:Aa},h=new bn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new oe},radius:{value:4}},vertexShader:ix,fragmentShader:nx}),g=h.clone();g.defines.HORIZONAL_PASS=1;const m=new lt;m.setAttribute("position",new ct(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new Jt(m,h),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Dh,this.render=function(p,A,O){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||p.length===0)return;const H=t.getRenderTarget(),ne=t.getActiveCubeFace(),se=t.getActiveMipmapLevel(),B=t.state;B.setBlending(Os),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);for(let j=0,Y=p.length;j<Y;j++){const Q=p[j],X=Q.shadow;if(X===void 0){console.warn("THREE.WebGLShadowMap:",Q,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;r.copy(X.mapSize);const Z=X.getFrameExtents();if(r.multiply(Z),s.copy(X.mapSize),(r.x>n||r.y>n)&&(r.x>n&&(s.x=Math.floor(n/Z.x),r.x=s.x*Z.x,X.mapSize.x=s.x),r.y>n&&(s.y=Math.floor(n/Z.y),r.y=s.y*Z.y,X.mapSize.y=s.y)),X.map===null&&!X.isPointLightShadow&&this.type===Ds){const de={minFilter:sn,magFilter:sn,format:Qn};X.map=new Kn(r.x,r.y,de),X.map.texture.name=Q.name+".shadowMap",X.mapPass=new Kn(r.x,r.y,de),X.camera.updateProjectionMatrix()}if(X.map===null){const de={minFilter:un,magFilter:un,format:Qn};X.map=new Kn(r.x,r.y,de),X.map.texture.name=Q.name+".shadowMap",X.camera.updateProjectionMatrix()}t.setRenderTarget(X.map),t.clear();const le=X.getViewportCount();for(let de=0;de<le;de++){const we=X.getViewport(de);o.set(s.x*we.x,s.y*we.y,s.x*we.z,s.y*we.w),B.viewport(o),X.updateMatrices(Q,de),i=X.getFrustum(),R(A,O,X.camera,Q,this.type)}!X.isPointLightShadow&&this.type===Ds&&M(X,O),X.needsUpdate=!1}w.needsUpdate=!1,t.setRenderTarget(H,ne,se)};function M(p,A){const O=e.update(y);h.uniforms.shadow_pass.value=p.map.texture,h.uniforms.resolution.value=p.mapSize,h.uniforms.radius.value=p.radius,t.setRenderTarget(p.mapPass),t.clear(),t.renderBufferDirect(A,null,O,h,y,null),g.uniforms.shadow_pass.value=p.mapPass.texture,g.uniforms.resolution.value=p.mapSize,g.uniforms.radius.value=p.radius,t.setRenderTarget(p.map),t.clear(),t.renderBufferDirect(A,null,O,g,y,null)}function _(p,A,O){const H=p<<0|A<<1|O<<2;let ne=a[H];return ne===void 0&&(ne=new yr({depthPacking:qp,morphTargets:p,skinning:A}),a[H]=ne),ne}function v(p,A,O){const H=p<<0|A<<1|O<<2;let ne=u[H];return ne===void 0&&(ne=new vr({morphTargets:p,skinning:A}),u[H]=ne),ne}function E(p,A,O,H,ne,se,B){let j=null,Y=_,Q=p.customDepthMaterial;if(H.isPointLight===!0&&(Y=v,Q=p.customDistanceMaterial),Q===void 0){let X=!1;O.morphTargets===!0&&(X=A.morphAttributes&&A.morphAttributes.position&&A.morphAttributes.position.length>0);let Z=!1;p.isSkinnedMesh===!0&&(O.skinning===!0?Z=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",p));const le=p.isInstancedMesh===!0;j=Y(X,Z,le)}else j=Q;if(t.localClippingEnabled&&O.clipShadows===!0&&O.clippingPlanes.length!==0){const X=j.uuid,Z=O.uuid;let le=l[X];le===void 0&&(le={},l[X]=le);let de=le[Z];de===void 0&&(de=j.clone(),le[Z]=de),j=de}return j.visible=O.visible,j.wireframe=O.wireframe,B===Ds?j.side=O.shadowSide!==null?O.shadowSide:O.side:j.side=O.shadowSide!==null?O.shadowSide:d[O.side],j.clipShadows=O.clipShadows,j.clippingPlanes=O.clippingPlanes,j.clipIntersection=O.clipIntersection,j.wireframeLinewidth=O.wireframeLinewidth,j.linewidth=O.linewidth,H.isPointLight===!0&&j.isMeshDistanceMaterial===!0&&(j.referencePosition.setFromMatrixPosition(H.matrixWorld),j.nearDistance=ne,j.farDistance=se),j}function R(p,A,O,H,ne){if(p.visible===!1)return;if(p.layers.test(A.layers)&&(p.isMesh||p.isLine||p.isPoints)&&(p.castShadow||p.receiveShadow&&ne===Ds)&&(!p.frustumCulled||i.intersectsObject(p))){p.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,p.matrixWorld);const j=e.update(p),Y=p.material;if(Array.isArray(Y)){const Q=j.groups;for(let X=0,Z=Q.length;X<Z;X++){const le=Q[X],de=Y[le.materialIndex];if(de&&de.visible){const we=E(p,j,de,H,O.near,O.far,ne);t.renderBufferDirect(O,null,j,we,p,le)}}}else if(Y.visible){const Q=E(p,j,Y,H,O.near,O.far,ne);t.renderBufferDirect(O,null,j,Q,p,null)}}const B=p.children;for(let j=0,Y=B.length;j<Y;j++)R(B[j],A,O,H,ne)}}function rx(t,e,n){const i=n.isWebGL2;function r(){let G=!1;const ge=new At;let Ee=null;const Be=new At(0,0,0,0);return{setMask:function(Se){Ee!==Se&&!G&&(t.colorMask(Se,Se,Se,Se),Ee=Se)},setLocked:function(Se){G=Se},setClear:function(Se,k,xe,Pe,Me){Me===!0&&(Se*=Pe,k*=Pe,xe*=Pe),ge.set(Se,k,xe,Pe),Be.equals(ge)===!1&&(t.clearColor(Se,k,xe,Pe),Be.copy(ge))},reset:function(){G=!1,Ee=null,Be.set(-1,0,0,0)}}}function s(){let G=!1,ge=null,Ee=null,Be=null;return{setTest:function(Se){Se?Ne(2929):Re(2929)},setMask:function(Se){ge!==Se&&!G&&(t.depthMask(Se),ge=Se)},setFunc:function(Se){if(Ee!==Se){if(Se)switch(Se){case Rd:t.depthFunc(512);break;case Pd:t.depthFunc(519);break;case Dd:t.depthFunc(513);break;case Nc:t.depthFunc(515);break;case Id:t.depthFunc(514);break;case Nd:t.depthFunc(518);break;case Od:t.depthFunc(516);break;case Bd:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);Ee=Se}},setLocked:function(Se){G=Se},setClear:function(Se){Be!==Se&&(t.clearDepth(Se),Be=Se)},reset:function(){G=!1,ge=null,Ee=null,Be=null}}}function o(){let G=!1,ge=null,Ee=null,Be=null,Se=null,k=null,xe=null,Pe=null,Me=null;return{setTest:function(ze){G||(ze?Ne(2960):Re(2960))},setMask:function(ze){ge!==ze&&!G&&(t.stencilMask(ze),ge=ze)},setFunc:function(ze,gt,Gt){(Ee!==ze||Be!==gt||Se!==Gt)&&(t.stencilFunc(ze,gt,Gt),Ee=ze,Be=gt,Se=Gt)},setOp:function(ze,gt,Gt){(k!==ze||xe!==gt||Pe!==Gt)&&(t.stencilOp(ze,gt,Gt),k=ze,xe=gt,Pe=Gt)},setLocked:function(ze){G=ze},setClear:function(ze){Me!==ze&&(t.clearStencil(ze),Me=ze)},reset:function(){G=!1,ge=null,Ee=null,Be=null,Se=null,k=null,xe=null,Pe=null,Me=null}}}const a=new r,u=new s,l=new o;let d={},h=null,g=null,m=null,y=null,w=null,M=null,_=null,v=null,E=null,R=!1,p=null,A=null,O=null,H=null,ne=null;const se=t.getParameter(35661);let B=!1,j=0;const Y=t.getParameter(7938);Y.indexOf("WebGL")!==-1?(j=parseFloat(/^WebGL\ ([0-9])/.exec(Y)[1]),B=j>=1):Y.indexOf("OpenGL ES")!==-1&&(j=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Y)[1]),B=j>=2);let Q=null,X={};const Z=new At,le=new At;function de(G,ge,Ee){const Be=new Uint8Array(4),Se=t.createTexture();t.bindTexture(G,Se),t.texParameteri(G,10241,9728),t.texParameteri(G,10240,9728);for(let k=0;k<Ee;k++)t.texImage2D(ge+k,0,6408,1,1,0,6408,5121,Be);return Se}const we={};we[3553]=de(3553,3553,1),we[34067]=de(34067,34069,6),a.setClear(0,0,0,1),u.setClear(1),l.setClear(0),Ne(2929),u.setFunc(Nc),We(!1),ft(cu),Ne(2884),ue(Os);function Ne(G){d[G]!==!0&&(t.enable(G),d[G]=!0)}function Re(G){d[G]!==!1&&(t.disable(G),d[G]=!1)}function Je(G){return h!==G?(t.useProgram(G),h=G,!0):!1}const tt={[Zr]:32774,[xd]:32778,[_d]:32779};if(i)tt[fu]=32775,tt[du]=32776;else{const G=e.get("EXT_blend_minmax");G!==null&&(tt[fu]=G.MIN_EXT,tt[du]=G.MAX_EXT)}const _t={[bd]:0,[wd]:1,[Md]:768,[Nh]:770,[Cd]:776,[Ad]:774,[Td]:772,[Sd]:769,[Oh]:771,[Ld]:775,[Ed]:773};function ue(G,ge,Ee,Be,Se,k,xe,Pe){if(G===Os){g&&(Re(3042),g=!1);return}if(g||(Ne(3042),g=!0),G!==vd){if(G!==m||Pe!==R){if((y!==Zr||_!==Zr)&&(t.blendEquation(32774),y=Zr,_=Zr),Pe)switch(G){case Bs:t.blendFuncSeparate(1,771,1,771);break;case lu:t.blendFunc(1,1);break;case uu:t.blendFuncSeparate(0,0,769,771);break;case hu:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}else switch(G){case Bs:t.blendFuncSeparate(770,771,1,771);break;case lu:t.blendFunc(770,1);break;case uu:t.blendFunc(0,769);break;case hu:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",G);break}w=null,M=null,v=null,E=null,m=G,R=Pe}return}Se=Se||ge,k=k||Ee,xe=xe||Be,(ge!==y||Se!==_)&&(t.blendEquationSeparate(tt[ge],tt[Se]),y=ge,_=Se),(Ee!==w||Be!==M||k!==v||xe!==E)&&(t.blendFuncSeparate(_t[Ee],_t[Be],_t[k],_t[xe]),w=Ee,M=Be,v=k,E=xe),m=G,R=null}function bt(G,ge){G.side===Aa?Re(2884):Ne(2884);let Ee=G.side===nn;ge&&(Ee=!Ee),We(Ee),G.blending===Bs&&G.transparent===!1?ue(Os):ue(G.blending,G.blendEquation,G.blendSrc,G.blendDst,G.blendEquationAlpha,G.blendSrcAlpha,G.blendDstAlpha,G.premultipliedAlpha),u.setFunc(G.depthFunc),u.setTest(G.depthTest),u.setMask(G.depthWrite),a.setMask(G.colorWrite);const Be=G.stencilWrite;l.setTest(Be),Be&&(l.setMask(G.stencilWriteMask),l.setFunc(G.stencilFunc,G.stencilRef,G.stencilFuncMask),l.setOp(G.stencilFail,G.stencilZFail,G.stencilZPass)),it(G.polygonOffset,G.polygonOffsetFactor,G.polygonOffsetUnits)}function We(G){p!==G&&(G?t.frontFace(2304):t.frontFace(2305),p=G)}function ft(G){G!==md?(Ne(2884),G!==A&&(G===cu?t.cullFace(1029):G===gd?t.cullFace(1028):t.cullFace(1032))):Re(2884),A=G}function Ke(G){G!==O&&(B&&t.lineWidth(G),O=G)}function it(G,ge,Ee){G?(Ne(32823),(H!==ge||ne!==Ee)&&(t.polygonOffset(ge,Ee),H=ge,ne=Ee)):Re(32823)}function Ze(G){G?Ne(3089):Re(3089)}function me(G){G===void 0&&(G=33984+se-1),Q!==G&&(t.activeTexture(G),Q=G)}function ie(G,ge){Q===null&&me();let Ee=X[Q];Ee===void 0&&(Ee={type:void 0,texture:void 0},X[Q]=Ee),(Ee.type!==G||Ee.texture!==ge)&&(t.bindTexture(G,ge||we[G]),Ee.type=G,Ee.texture=ge)}function _e(){const G=X[Q];G!==void 0&&G.type!==void 0&&(t.bindTexture(G.type,null),G.type=void 0,G.texture=void 0)}function ke(){try{t.compressedTexImage2D.apply(t,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function Le(){try{t.texImage2D.apply(t,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function N(){try{t.texImage3D.apply(t,arguments)}catch(G){console.error("THREE.WebGLState:",G)}}function D(G){Z.equals(G)===!1&&(t.scissor(G.x,G.y,G.z,G.w),Z.copy(G))}function ve(G){le.equals(G)===!1&&(t.viewport(G.x,G.y,G.z,G.w),le.copy(G))}function fe(){d={},Q=null,X={},h=null,m=null,p=null,A=null,a.reset(),u.reset(),l.reset()}return{buffers:{color:a,depth:u,stencil:l},enable:Ne,disable:Re,useProgram:Je,setBlending:ue,setMaterial:bt,setFlipSided:We,setCullFace:ft,setLineWidth:Ke,setPolygonOffset:it,setScissorTest:Ze,activeTexture:me,bindTexture:ie,unbindTexture:_e,compressedTexImage2D:ke,texImage2D:Le,texImage3D:N,scissor:D,viewport:ve,reset:fe}}function sx(t,e,n,i,r,s,o){const a=r.isWebGL2,u=r.maxTextures,l=r.maxCubemapSize,d=r.maxTextureSize,h=r.maxSamples,g=new WeakMap;let m,y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function w(N,D){return y?new OffscreenCanvas(N,D):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function M(N,D,ve,fe){let G=1;if((N.width>fe||N.height>fe)&&(G=fe/Math.max(N.width,N.height)),G<1||D===!0)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){const ge=D?at.floorPowerOfTwo:Math.floor,Ee=ge(G*N.width),Be=ge(G*N.height);m===void 0&&(m=w(Ee,Be));const Se=ve?w(Ee,Be):m;return Se.width=Ee,Se.height=Be,Se.getContext("2d").drawImage(N,0,0,Ee,Be),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+Ee+"x"+Be+")."),Se}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N;return N}function _(N){return at.isPowerOfTwo(N.width)&&at.isPowerOfTwo(N.height)}function v(N){return a?!1:N.wrapS!==xn||N.wrapT!==xn||N.minFilter!==un&&N.minFilter!==sn}function E(N,D){return N.generateMipmaps&&D&&N.minFilter!==un&&N.minFilter!==sn}function R(N,D,ve,fe){t.generateMipmap(N);const G=i.get(D);G.__maxMipLevel=Math.log(Math.max(ve,fe))*Math.LOG2E}function p(N,D,ve){if(a===!1)return D;if(N!==null){if(t[N]!==void 0)return t[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let fe=D;return D===6403&&(ve===5126&&(fe=33326),ve===5131&&(fe=33325),ve===5121&&(fe=33321)),D===6407&&(ve===5126&&(fe=34837),ve===5131&&(fe=34843),ve===5121&&(fe=32849)),D===6408&&(ve===5126&&(fe=34836),ve===5131&&(fe=34842),ve===5121&&(fe=32856)),(fe===33325||fe===33326||fe===34842||fe===34836)&&e.get("EXT_color_buffer_float"),fe}function A(N){return N===un||N===Fc||N===zc?9728:9729}function O(N){const D=N.target;D.removeEventListener("dispose",O),ne(D),D.isVideoTexture&&g.delete(D),o.memory.textures--}function H(N){const D=N.target;D.removeEventListener("dispose",H),se(D),o.memory.textures--}function ne(N){const D=i.get(N);D.__webglInit!==void 0&&(t.deleteTexture(D.__webglTexture),i.remove(N))}function se(N){const D=i.get(N),ve=i.get(N.texture);if(N){if(ve.__webglTexture!==void 0&&t.deleteTexture(ve.__webglTexture),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let fe=0;fe<6;fe++)t.deleteFramebuffer(D.__webglFramebuffer[fe]),D.__webglDepthbuffer&&t.deleteRenderbuffer(D.__webglDepthbuffer[fe]);else t.deleteFramebuffer(D.__webglFramebuffer),D.__webglDepthbuffer&&t.deleteRenderbuffer(D.__webglDepthbuffer),D.__webglMultisampledFramebuffer&&t.deleteFramebuffer(D.__webglMultisampledFramebuffer),D.__webglColorRenderbuffer&&t.deleteRenderbuffer(D.__webglColorRenderbuffer),D.__webglDepthRenderbuffer&&t.deleteRenderbuffer(D.__webglDepthRenderbuffer);i.remove(N.texture),i.remove(N)}}let B=0;function j(){B=0}function Y(){const N=B;return N>=u&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+u),B+=1,N}function Q(N,D){const ve=i.get(N);if(N.isVideoTexture&&me(N),N.version>0&&ve.__version!==N.version){const fe=N.image;if(fe===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Je(ve,N,D);return}}n.activeTexture(33984+D),n.bindTexture(3553,ve.__webglTexture)}function X(N,D){const ve=i.get(N);if(N.version>0&&ve.__version!==N.version){Je(ve,N,D);return}n.activeTexture(33984+D),n.bindTexture(35866,ve.__webglTexture)}function Z(N,D){const ve=i.get(N);if(N.version>0&&ve.__version!==N.version){Je(ve,N,D);return}n.activeTexture(33984+D),n.bindTexture(32879,ve.__webglTexture)}function le(N,D){const ve=i.get(N);if(N.version>0&&ve.__version!==N.version){tt(ve,N,D);return}n.activeTexture(33984+D),n.bindTexture(34067,ve.__webglTexture)}const de={[ha]:10497,[xn]:33071,[fa]:33648},we={[un]:9728,[Fc]:9984,[zc]:9986,[sn]:9729,[Bh]:9985,[lo]:9987};function Ne(N,D,ve){ve?(t.texParameteri(N,10242,de[D.wrapS]),t.texParameteri(N,10243,de[D.wrapT]),(N===32879||N===35866)&&t.texParameteri(N,32882,de[D.wrapR]),t.texParameteri(N,10240,we[D.magFilter]),t.texParameteri(N,10241,we[D.minFilter])):(t.texParameteri(N,10242,33071),t.texParameteri(N,10243,33071),(N===32879||N===35866)&&t.texParameteri(N,32882,33071),(D.wrapS!==xn||D.wrapT!==xn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(N,10240,A(D.magFilter)),t.texParameteri(N,10241,A(D.minFilter)),D.minFilter!==un&&D.minFilter!==sn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const fe=e.get("EXT_texture_filter_anisotropic");if(fe){if(D.type===qi&&e.get("OES_texture_float_linear")===null||D.type===pa&&(a||e.get("OES_texture_half_float_linear"))===null)return;(D.anisotropy>1||i.get(D).__currentAnisotropy)&&(t.texParameterf(N,fe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,r.getMaxAnisotropy())),i.get(D).__currentAnisotropy=D.anisotropy)}}function Re(N,D){N.__webglInit===void 0&&(N.__webglInit=!0,D.addEventListener("dispose",O),N.__webglTexture=t.createTexture(),o.memory.textures++)}function Je(N,D,ve){let fe=3553;D.isDataTexture2DArray&&(fe=35866),D.isDataTexture3D&&(fe=32879),Re(N,D),n.activeTexture(33984+ve),n.bindTexture(fe,N.__webglTexture),t.pixelStorei(37440,D.flipY),t.pixelStorei(37441,D.premultiplyAlpha),t.pixelStorei(3317,D.unpackAlignment);const G=v(D)&&_(D.image)===!1,ge=M(D.image,G,!1,d),Ee=_(ge)||a,Be=s.convert(D.format);let Se=s.convert(D.type),k=p(D.internalFormat,Be,Se);Ne(fe,D,Ee);let xe;const Pe=D.mipmaps;if(D.isDepthTexture)k=6402,a?D.type===qi?k=36012:D.type===ca?k=33190:D.type===zs?k=35056:k=33189:D.type===qi&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),D.format===ns&&k===6402&&D.type!==da&&D.type!==ca&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),D.type=da,Se=s.convert(D.type)),D.format===Vs&&k===6402&&(k=34041,D.type!==zs&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),D.type=zs,Se=s.convert(D.type))),n.texImage2D(3553,0,k,ge.width,ge.height,0,Be,Se,null);else if(D.isDataTexture)if(Pe.length>0&&Ee){for(let Me=0,ze=Pe.length;Me<ze;Me++)xe=Pe[Me],n.texImage2D(3553,Me,k,xe.width,xe.height,0,Be,Se,xe.data);D.generateMipmaps=!1,N.__maxMipLevel=Pe.length-1}else n.texImage2D(3553,0,k,ge.width,ge.height,0,Be,Se,ge.data),N.__maxMipLevel=0;else if(D.isCompressedTexture){for(let Me=0,ze=Pe.length;Me<ze;Me++)xe=Pe[Me],D.format!==Qn&&D.format!==fr?Be!==null?n.compressedTexImage2D(3553,Me,k,xe.width,xe.height,0,xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,Me,k,xe.width,xe.height,0,Be,Se,xe.data);N.__maxMipLevel=Pe.length-1}else if(D.isDataTexture2DArray)n.texImage3D(35866,0,k,ge.width,ge.height,ge.depth,0,Be,Se,ge.data),N.__maxMipLevel=0;else if(D.isDataTexture3D)n.texImage3D(32879,0,k,ge.width,ge.height,ge.depth,0,Be,Se,ge.data),N.__maxMipLevel=0;else if(Pe.length>0&&Ee){for(let Me=0,ze=Pe.length;Me<ze;Me++)xe=Pe[Me],n.texImage2D(3553,Me,k,Be,Se,xe);D.generateMipmaps=!1,N.__maxMipLevel=Pe.length-1}else n.texImage2D(3553,0,k,Be,Se,ge),N.__maxMipLevel=0;E(D,Ee)&&R(fe,D,ge.width,ge.height),N.__version=D.version,D.onUpdate&&D.onUpdate(D)}function tt(N,D,ve){if(D.image.length!==6)return;Re(N,D),n.activeTexture(33984+ve),n.bindTexture(34067,N.__webglTexture),t.pixelStorei(37440,D.flipY);const fe=D&&(D.isCompressedTexture||D.image[0].isCompressedTexture),G=D.image[0]&&D.image[0].isDataTexture,ge=[];for(let Me=0;Me<6;Me++)!fe&&!G?ge[Me]=M(D.image[Me],!1,!0,l):ge[Me]=G?D.image[Me].image:D.image[Me];const Ee=ge[0],Be=_(Ee)||a,Se=s.convert(D.format),k=s.convert(D.type),xe=p(D.internalFormat,Se,k);Ne(34067,D,Be);let Pe;if(fe){for(let Me=0;Me<6;Me++){Pe=ge[Me].mipmaps;for(let ze=0;ze<Pe.length;ze++){const gt=Pe[ze];D.format!==Qn&&D.format!==fr?Se!==null?n.compressedTexImage2D(34069+Me,ze,xe,gt.width,gt.height,0,gt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+Me,ze,xe,gt.width,gt.height,0,Se,k,gt.data)}}N.__maxMipLevel=Pe.length-1}else{Pe=D.mipmaps;for(let Me=0;Me<6;Me++)if(G){n.texImage2D(34069+Me,0,xe,ge[Me].width,ge[Me].height,0,Se,k,ge[Me].data);for(let ze=0;ze<Pe.length;ze++){const Gt=Pe[ze].image[Me].image;n.texImage2D(34069+Me,ze+1,xe,Gt.width,Gt.height,0,Se,k,Gt.data)}}else{n.texImage2D(34069+Me,0,xe,Se,k,ge[Me]);for(let ze=0;ze<Pe.length;ze++){const gt=Pe[ze];n.texImage2D(34069+Me,ze+1,xe,Se,k,gt.image[Me])}}N.__maxMipLevel=Pe.length}E(D,Be)&&R(34067,D,Ee.width,Ee.height),N.__version=D.version,D.onUpdate&&D.onUpdate(D)}function _t(N,D,ve,fe){const G=s.convert(D.texture.format),ge=s.convert(D.texture.type),Ee=p(D.texture.internalFormat,G,ge);n.texImage2D(fe,0,Ee,D.width,D.height,0,G,ge,null),t.bindFramebuffer(36160,N),t.framebufferTexture2D(36160,ve,fe,i.get(D.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function ue(N,D,ve){if(t.bindRenderbuffer(36161,N),D.depthBuffer&&!D.stencilBuffer){let fe=33189;if(ve){const G=D.depthTexture;G&&G.isDepthTexture&&(G.type===qi?fe=36012:G.type===ca&&(fe=33190));const ge=Ze(D);t.renderbufferStorageMultisample(36161,ge,fe,D.width,D.height)}else t.renderbufferStorage(36161,fe,D.width,D.height);t.framebufferRenderbuffer(36160,36096,36161,N)}else if(D.depthBuffer&&D.stencilBuffer){if(ve){const fe=Ze(D);t.renderbufferStorageMultisample(36161,fe,35056,D.width,D.height)}else t.renderbufferStorage(36161,34041,D.width,D.height);t.framebufferRenderbuffer(36160,33306,36161,N)}else{const fe=s.convert(D.texture.format),G=s.convert(D.texture.type),ge=p(D.texture.internalFormat,fe,G);if(ve){const Ee=Ze(D);t.renderbufferStorageMultisample(36161,Ee,ge,D.width,D.height)}else t.renderbufferStorage(36161,ge,D.width,D.height)}t.bindRenderbuffer(36161,null)}function bt(N,D){if(D&&D.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,N),!(D.depthTexture&&D.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(D.depthTexture).__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),Q(D.depthTexture,0);const fe=i.get(D.depthTexture).__webglTexture;if(D.depthTexture.format===ns)t.framebufferTexture2D(36160,36096,3553,fe,0);else if(D.depthTexture.format===Vs)t.framebufferTexture2D(36160,33306,3553,fe,0);else throw new Error("Unknown depthTexture format")}function We(N){const D=i.get(N),ve=N.isWebGLCubeRenderTarget===!0;if(N.depthTexture){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");bt(D.__webglFramebuffer,N)}else if(ve){D.__webglDepthbuffer=[];for(let fe=0;fe<6;fe++)t.bindFramebuffer(36160,D.__webglFramebuffer[fe]),D.__webglDepthbuffer[fe]=t.createRenderbuffer(),ue(D.__webglDepthbuffer[fe],N,!1)}else t.bindFramebuffer(36160,D.__webglFramebuffer),D.__webglDepthbuffer=t.createRenderbuffer(),ue(D.__webglDepthbuffer,N,!1);t.bindFramebuffer(36160,null)}function ft(N){const D=i.get(N),ve=i.get(N.texture);N.addEventListener("dispose",H),ve.__webglTexture=t.createTexture(),o.memory.textures++;const fe=N.isWebGLCubeRenderTarget===!0,G=N.isWebGLMultisampleRenderTarget===!0,ge=_(N)||a;if(a&&N.texture.format===fr&&(N.texture.type===qi||N.texture.type===pa)&&(N.texture.format=Qn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),fe){D.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)D.__webglFramebuffer[Ee]=t.createFramebuffer()}else if(D.__webglFramebuffer=t.createFramebuffer(),G)if(a){D.__webglMultisampledFramebuffer=t.createFramebuffer(),D.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,D.__webglColorRenderbuffer);const Ee=s.convert(N.texture.format),Be=s.convert(N.texture.type),Se=p(N.texture.internalFormat,Ee,Be),k=Ze(N);t.renderbufferStorageMultisample(36161,k,Se,N.width,N.height),t.bindFramebuffer(36160,D.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,D.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),N.depthBuffer&&(D.__webglDepthRenderbuffer=t.createRenderbuffer(),ue(D.__webglDepthRenderbuffer,N,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(fe){n.bindTexture(34067,ve.__webglTexture),Ne(34067,N.texture,ge);for(let Ee=0;Ee<6;Ee++)_t(D.__webglFramebuffer[Ee],N,36064,34069+Ee);E(N.texture,ge)&&R(34067,N.texture,N.width,N.height),n.bindTexture(34067,null)}else n.bindTexture(3553,ve.__webglTexture),Ne(3553,N.texture,ge),_t(D.__webglFramebuffer,N,36064,3553),E(N.texture,ge)&&R(3553,N.texture,N.width,N.height),n.bindTexture(3553,null);N.depthBuffer&&We(N)}function Ke(N){const D=N.texture,ve=_(N)||a;if(E(D,ve)){const fe=N.isWebGLCubeRenderTarget?34067:3553,G=i.get(D).__webglTexture;n.bindTexture(fe,G),R(fe,D,N.width,N.height),n.bindTexture(fe,null)}}function it(N){if(N.isWebGLMultisampleRenderTarget)if(a){const D=i.get(N);t.bindFramebuffer(36008,D.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,D.__webglFramebuffer);const ve=N.width,fe=N.height;let G=16384;N.depthBuffer&&(G|=256),N.stencilBuffer&&(G|=1024),t.blitFramebuffer(0,0,ve,fe,0,0,ve,fe,G,9728),t.bindFramebuffer(36160,D.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Ze(N){return a&&N.isWebGLMultisampleRenderTarget?Math.min(h,N.samples):0}function me(N){const D=o.render.frame;g.get(N)!==D&&(g.set(N,D),N.update())}let ie=!1,_e=!1;function ke(N,D){N&&N.isWebGLRenderTarget&&(ie===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),ie=!0),N=N.texture),Q(N,D)}function Le(N,D){N&&N.isWebGLCubeRenderTarget&&(_e===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),_e=!0),N=N.texture),le(N,D)}this.allocateTextureUnit=Y,this.resetTextureUnits=j,this.setTexture2D=Q,this.setTexture2DArray=X,this.setTexture3D=Z,this.setTextureCube=le,this.setupRenderTarget=ft,this.updateRenderTargetMipmap=Ke,this.updateMultisampleRenderTarget=it,this.safeSetTexture2D=ke,this.safeSetTextureCube=Le}function ox(t,e,n){const i=n.isWebGL2;function r(s){let o;if(s===El)return 5121;if(s===Xd)return 32819;if(s===Yd)return 32820;if(s===Zd)return 33635;if(s===Wd)return 5120;if(s===jd)return 5122;if(s===da)return 5123;if(s===qd)return 5124;if(s===ca)return 5125;if(s===qi)return 5126;if(s===pa)return i?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===Jd)return 6406;if(s===fr)return 6407;if(s===Qn)return 6408;if(s===$d)return 6409;if(s===Qd)return 6410;if(s===ns)return 6402;if(s===Vs)return 34041;if(s===Kd)return 6403;if(s===ep)return 36244;if(s===tp)return 33319;if(s===np)return 33320;if(s===ip)return 36248;if(s===rp)return 36249;if(s===pu||s===mu||s===gu||s===yu)if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===pu)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===mu)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===gu)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===yu)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===vu||s===xu||s===_u||s===bu)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===vu)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===xu)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===_u)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===bu)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===sp)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if((s===wu||s===Mu)&&(o=e.get("WEBGL_compressed_texture_etc"),o!==null)){if(s===wu)return o.COMPRESSED_RGB8_ETC2;if(s===Mu)return o.COMPRESSED_RGBA8_ETC2_EAC}if(s===op||s===ap||s===cp||s===lp||s===up||s===hp||s===fp||s===dp||s===pp||s===mp||s===gp||s===yp||s===vp||s===xp||s===bp||s===wp||s===Mp||s===Sp||s===Tp||s===Ep||s===Ap||s===Lp||s===Cp||s===Rp||s===Pp||s===Dp||s===Ip||s===Np)return o=e.get("WEBGL_compressed_texture_astc"),o!==null?s:null;if(s===_p)return o=e.get("EXT_texture_compression_bptc"),o!==null?s:null;if(s===zs)return i?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:r}}function Xc(t){en.call(this),this.cameras=t||[]}Xc.prototype=Object.assign(Object.create(en.prototype),{constructor:Xc,isArrayCamera:!0});function hr(){je.call(this),this.type="Group"}hr.prototype=Object.assign(Object.create(je.prototype),{constructor:hr,isGroup:!0});function Us(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(Us.prototype,{constructor:Us,getHandSpace:function(){if(this._hand===null&&(this._hand=new hr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let t=0;t<=window.XRHand.LITTLE_PHALANX_TIP;t++){const e=new hr;e.matrixAutoUpdate=!1,e.visible=!1,this._hand.joints.push(e),this._hand.add(e)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new hr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new hr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(t,e,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,u=this._hand;if(t)if(u&&t.hand){s=!0;for(let l=0;l<=window.XRHand.LITTLE_PHALANX_TIP;l++)if(t.hand[l]){const d=e.getJointPose(t.hand[l],n),h=u.joints[l];d!==null&&(h.matrix.fromArray(d.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.jointRadius=d.radius),h.visible=d!==null;const g=u.joints[window.XRHand.INDEX_PHALANX_TIP],m=u.joints[window.XRHand.THUMB_PHALANX_TIP],y=g.position.distanceTo(m.position),w=.02,M=.005;u.inputState.pinching&&y>w+M?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!u.inputState.pinching&&y<=w-M&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}}else o!==null&&(i=e.getPose(t.targetRaySpace,n),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),a!==null&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)));return o!==null&&(o.visible=i!==null),a!==null&&(a.visible=r!==null),u!==null&&(u.visible=s!==null),this}});function Qh(t,e){const n=this;let i=null,r=1,s=null,o="local-floor",a=null;const u=[],l=new Map,d=new en;d.layers.enable(1),d.viewport=new At;const h=new en;h.layers.enable(2),h.viewport=new At;const g=[d,h],m=new Xc;m.layers.enable(1),m.layers.enable(2);let y=null,w=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(B){let j=u[B];return j===void 0&&(j=new Us,u[B]=j),j.getTargetRaySpace()},this.getControllerGrip=function(B){let j=u[B];return j===void 0&&(j=new Us,u[B]=j),j.getGripSpace()},this.getHand=function(B){let j=u[B];return j===void 0&&(j=new Us,u[B]=j),j.getHandSpace()};function M(B){const j=l.get(B.inputSource);j&&j.dispatchEvent({type:B.type,data:B.inputSource})}function _(){l.forEach(function(B,j){B.disconnect(j)}),l.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),se.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(B){s=B,se.setContext(i),se.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(B){r=B,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(B){o=B,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getSession=function(){return i},this.setSession=function(B){if(i=B,i!==null){i.addEventListener("select",M),i.addEventListener("selectstart",M),i.addEventListener("selectend",M),i.addEventListener("squeeze",M),i.addEventListener("squeezestart",M),i.addEventListener("squeezeend",M),i.addEventListener("end",_);const j=e.getContextAttributes();j.xrCompatible!==!0&&e.makeXRCompatible();const Y={antialias:j.antialias,alpha:j.alpha,depth:j.depth,stencil:j.stencil,framebufferScaleFactor:r},Q=new XRWebGLLayer(i,e,Y);i.updateRenderState({baseLayer:Q}),i.requestReferenceSpace(o).then(v),i.addEventListener("inputsourceschange",E)}};function E(B){const j=i.inputSources;for(let Y=0;Y<u.length;Y++)l.set(j[Y],u[Y]);for(let Y=0;Y<B.removed.length;Y++){const Q=B.removed[Y],X=l.get(Q);X&&(X.dispatchEvent({type:"disconnected",data:Q}),l.delete(Q))}for(let Y=0;Y<B.added.length;Y++){const Q=B.added[Y],X=l.get(Q);X&&X.dispatchEvent({type:"connected",data:Q})}}const R=new P,p=new P;function A(B,j,Y){R.setFromMatrixPosition(j.matrixWorld),p.setFromMatrixPosition(Y.matrixWorld);const Q=R.distanceTo(p),X=j.projectionMatrix.elements,Z=Y.projectionMatrix.elements,le=X[14]/(X[10]-1),de=X[14]/(X[10]+1),we=(X[9]+1)/X[5],Ne=(X[9]-1)/X[5],Re=(X[8]-1)/X[0],Je=(Z[8]+1)/Z[0],tt=le*Re,_t=le*Je,ue=Q/(-Re+Je),bt=ue*-Re;j.matrixWorld.decompose(B.position,B.quaternion,B.scale),B.translateX(bt),B.translateZ(ue),B.matrixWorld.compose(B.position,B.quaternion,B.scale),B.matrixWorldInverse.getInverse(B.matrixWorld);const We=le+ue,ft=de+ue,Ke=tt-bt,it=_t+(Q-bt),Ze=we*de/ft*We,me=Ne*de/ft*We;B.projectionMatrix.makePerspective(Ke,it,Ze,me,We,ft)}function O(B,j){j===null?B.matrixWorld.copy(B.matrix):B.matrixWorld.multiplyMatrices(j.matrixWorld,B.matrix),B.matrixWorldInverse.getInverse(B.matrixWorld)}this.getCamera=function(B){m.near=h.near=d.near=B.near,m.far=h.far=d.far=B.far,(y!==m.near||w!==m.far)&&(i.updateRenderState({depthNear:m.near,depthFar:m.far}),y=m.near,w=m.far);const j=B.parent,Y=m.cameras;O(m,j);for(let X=0;X<Y.length;X++)O(Y[X],j);B.matrixWorld.copy(m.matrixWorld);const Q=B.children;for(let X=0,Z=Q.length;X<Z;X++)Q[X].updateMatrixWorld(!0);return Y.length===2?A(m,d,h):m.projectionMatrix.copy(d.projectionMatrix),m};let H=null;function ne(B,j){if(a=j.getViewerPose(s),a!==null){const Q=a.views,X=i.renderState.baseLayer;t.setFramebuffer(X.framebuffer);let Z=!1;Q.length!==m.cameras.length&&(m.cameras.length=0,Z=!0);for(let le=0;le<Q.length;le++){const de=Q[le],we=X.getViewport(de),Ne=g[le];Ne.matrix.fromArray(de.transform.matrix),Ne.projectionMatrix.fromArray(de.projectionMatrix),Ne.viewport.set(we.x,we.y,we.width,we.height),le===0&&m.matrix.copy(Ne.matrix),Z===!0&&m.cameras.push(Ne)}}const Y=i.inputSources;for(let Q=0;Q<u.length;Q++){const X=u[Q],Z=Y[Q];X.update(Z,j,s)}H&&H(B,j)}const se=new Vh;se.setAnimationLoop(ne),this.setAnimationLoop=function(B){H=B},this.dispose=function(){}}Object.assign(Qh.prototype,ti.prototype);function ax(t){function e(_,v){_.fogColor.value.copy(v.color),v.isFog?(_.fogNear.value=v.near,_.fogFar.value=v.far):v.isFogExp2&&(_.fogDensity.value=v.density)}function n(_,v,E,R){v.isMeshBasicMaterial?i(_,v):v.isMeshLambertMaterial?(i(_,v),u(_,v)):v.isMeshToonMaterial?(i(_,v),d(_,v)):v.isMeshPhongMaterial?(i(_,v),l(_,v)):v.isMeshStandardMaterial?(i(_,v),v.isMeshPhysicalMaterial?g(_,v):h(_,v)):v.isMeshMatcapMaterial?(i(_,v),m(_,v)):v.isMeshDepthMaterial?(i(_,v),y(_,v)):v.isMeshDistanceMaterial?(i(_,v),w(_,v)):v.isMeshNormalMaterial?(i(_,v),M(_,v)):v.isLineBasicMaterial?(r(_,v),v.isLineDashedMaterial&&s(_,v)):v.isPointsMaterial?o(_,v,E,R):v.isSpriteMaterial?a(_,v):v.isShadowMaterial?(_.color.value.copy(v.color),_.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function i(_,v){_.opacity.value=v.opacity,v.color&&_.diffuse.value.copy(v.color),v.emissive&&_.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(_.map.value=v.map),v.alphaMap&&(_.alphaMap.value=v.alphaMap),v.specularMap&&(_.specularMap.value=v.specularMap);const E=t.get(v).envMap;if(E){_.envMap.value=E,_.flipEnvMap.value=E.isCubeTexture&&E._needsFlipEnvMap?-1:1,_.reflectivity.value=v.reflectivity,_.refractionRatio.value=v.refractionRatio;const A=t.get(E).__maxMipLevel;A!==void 0&&(_.maxMipLevel.value=A)}v.lightMap&&(_.lightMap.value=v.lightMap,_.lightMapIntensity.value=v.lightMapIntensity),v.aoMap&&(_.aoMap.value=v.aoMap,_.aoMapIntensity.value=v.aoMapIntensity);let R;v.map?R=v.map:v.specularMap?R=v.specularMap:v.displacementMap?R=v.displacementMap:v.normalMap?R=v.normalMap:v.bumpMap?R=v.bumpMap:v.roughnessMap?R=v.roughnessMap:v.metalnessMap?R=v.metalnessMap:v.alphaMap?R=v.alphaMap:v.emissiveMap?R=v.emissiveMap:v.clearcoatMap?R=v.clearcoatMap:v.clearcoatNormalMap?R=v.clearcoatNormalMap:v.clearcoatRoughnessMap&&(R=v.clearcoatRoughnessMap),R!==void 0&&(R.isWebGLRenderTarget&&(R=R.texture),R.matrixAutoUpdate===!0&&R.updateMatrix(),_.uvTransform.value.copy(R.matrix));let p;v.aoMap?p=v.aoMap:v.lightMap&&(p=v.lightMap),p!==void 0&&(p.isWebGLRenderTarget&&(p=p.texture),p.matrixAutoUpdate===!0&&p.updateMatrix(),_.uv2Transform.value.copy(p.matrix))}function r(_,v){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity}function s(_,v){_.dashSize.value=v.dashSize,_.totalSize.value=v.dashSize+v.gapSize,_.scale.value=v.scale}function o(_,v,E,R){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,_.size.value=v.size*E,_.scale.value=R*.5,v.map&&(_.map.value=v.map),v.alphaMap&&(_.alphaMap.value=v.alphaMap);let p;v.map?p=v.map:v.alphaMap&&(p=v.alphaMap),p!==void 0&&(p.matrixAutoUpdate===!0&&p.updateMatrix(),_.uvTransform.value.copy(p.matrix))}function a(_,v){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,_.rotation.value=v.rotation,v.map&&(_.map.value=v.map),v.alphaMap&&(_.alphaMap.value=v.alphaMap);let E;v.map?E=v.map:v.alphaMap&&(E=v.alphaMap),E!==void 0&&(E.matrixAutoUpdate===!0&&E.updateMatrix(),_.uvTransform.value.copy(E.matrix))}function u(_,v){v.emissiveMap&&(_.emissiveMap.value=v.emissiveMap)}function l(_,v){_.specular.value.copy(v.specular),_.shininess.value=Math.max(v.shininess,1e-4),v.emissiveMap&&(_.emissiveMap.value=v.emissiveMap),v.bumpMap&&(_.bumpMap.value=v.bumpMap,_.bumpScale.value=v.bumpScale,v.side===nn&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,_.normalScale.value.copy(v.normalScale),v.side===nn&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias)}function d(_,v){v.gradientMap&&(_.gradientMap.value=v.gradientMap),v.emissiveMap&&(_.emissiveMap.value=v.emissiveMap),v.bumpMap&&(_.bumpMap.value=v.bumpMap,_.bumpScale.value=v.bumpScale,v.side===nn&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,_.normalScale.value.copy(v.normalScale),v.side===nn&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias)}function h(_,v){_.roughness.value=v.roughness,_.metalness.value=v.metalness,v.roughnessMap&&(_.roughnessMap.value=v.roughnessMap),v.metalnessMap&&(_.metalnessMap.value=v.metalnessMap),v.emissiveMap&&(_.emissiveMap.value=v.emissiveMap),v.bumpMap&&(_.bumpMap.value=v.bumpMap,_.bumpScale.value=v.bumpScale,v.side===nn&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,_.normalScale.value.copy(v.normalScale),v.side===nn&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias),t.get(v).envMap&&(_.envMapIntensity.value=v.envMapIntensity)}function g(_,v){h(_,v),_.reflectivity.value=v.reflectivity,_.clearcoat.value=v.clearcoat,_.clearcoatRoughness.value=v.clearcoatRoughness,v.sheen&&_.sheen.value.copy(v.sheen),v.clearcoatMap&&(_.clearcoatMap.value=v.clearcoatMap),v.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap),v.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),_.clearcoatNormalMap.value=v.clearcoatNormalMap,v.side===nn&&_.clearcoatNormalScale.value.negate()),_.transmission.value=v.transmission,v.transmissionMap&&(_.transmissionMap.value=v.transmissionMap)}function m(_,v){v.matcap&&(_.matcap.value=v.matcap),v.bumpMap&&(_.bumpMap.value=v.bumpMap,_.bumpScale.value=v.bumpScale,v.side===nn&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,_.normalScale.value.copy(v.normalScale),v.side===nn&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias)}function y(_,v){v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias)}function w(_,v){v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias),_.referencePosition.value.copy(v.referencePosition),_.nearDistance.value=v.nearDistance,_.farDistance.value=v.farDistance}function M(_,v){v.bumpMap&&(_.bumpMap.value=v.bumpMap,_.bumpScale.value=v.bumpScale,v.side===nn&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,_.normalScale.value.copy(v.normalScale),v.side===nn&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:n}}function po(t){t=t||{};const e=t.canvas!==void 0?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=t.context!==void 0?t.context:null,i=t.alpha!==void 0?t.alpha:!1,r=t.depth!==void 0?t.depth:!0,s=t.stencil!==void 0?t.stencil:!0,o=t.antialias!==void 0?t.antialias:!1,a=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,u=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",d=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1;let h=null,g=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=uo,this.physicallyCorrectLights=!1,this.toneMapping=Fs,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const m=this;let y=!1,w=null,M=0,_=0,v=null,E=null,R=-1,p=null,A=null;const O=new At,H=new At;let ne=null,se=e.width,B=e.height,j=1,Y=null,Q=null;const X=new At(0,0,se,B),Z=new At(0,0,se,B);let le=!1;const de=new Oa;let we=!1,Ne=!1;const Re=new ht,Je=new P,tt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function _t(){return v===null?j:1}let ue=n;function bt(I,re){for(let ee=0;ee<I.length;ee++){const ce=I[ee],Ce=e.getContext(ce,re);if(Ce!==null)return Ce}return null}try{const I={alpha:i,depth:r,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:d};if(e.addEventListener("webglcontextlost",gt,!1),e.addEventListener("webglcontextrestored",Gt,!1),ue===null){const re=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&re.shift(),ue=bt(re,I),ue===null)throw bt(re)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ue.getShaderPrecisionFormat===void 0&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(I){throw console.error("THREE.WebGLRenderer: "+I.message),I}let We,ft,Ke,it,Ze,me,ie,_e,ke,Le,N,D,ve,fe,G,ge,Ee,Be,Se,k,xe;function Pe(){We=new ky(ue),ft=new By(ue,We,t),ft.isWebGL2===!1&&(We.get("WEBGL_depth_texture"),We.get("OES_texture_float"),We.get("OES_texture_half_float"),We.get("OES_texture_half_float_linear"),We.get("OES_standard_derivatives"),We.get("OES_element_index_uint"),We.get("OES_vertex_array_object"),We.get("ANGLE_instanced_arrays")),We.get("OES_texture_float_linear"),k=new ox(ue,We,ft),Ke=new rx(ue,We,ft),Ke.scissor(H.copy(Z).multiplyScalar(j).floor()),Ke.viewport(O.copy(X).multiplyScalar(j).floor()),it=new Hy,Ze=new qv,me=new sx(ue,We,Ke,Ze,ft,k,it),ie=new zy(m),_e=new hm(ue,ft),xe=new Ny(ue,We,_e,ft),ke=new Uy(ue,_e,it,xe),Le=new qy(ue,ke,_e,it),Ee=new jy(ue),G=new Fy(Ze),N=new jv(m,ie,We,ft,xe,G),D=new ax(Ze),ve=new Zv(Ze),fe=new tx(We,ft),ge=new Iy(m,ie,Ke,Le,a),Be=new Oy(ue,We,it,ft),Se=new Gy(ue,We,it,ft),it.programs=N.programs,m.capabilities=ft,m.extensions=We,m.properties=Ze,m.renderLists=ve,m.state=Ke,m.info=it}Pe();const Me=new Qh(m,ue);this.xr=Me;const ze=new $h(m,Le,ft.maxTextureSize);this.shadowMap=ze,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const I=We.get("WEBGL_lose_context");I&&I.loseContext()},this.forceContextRestore=function(){const I=We.get("WEBGL_lose_context");I&&I.restoreContext()},this.getPixelRatio=function(){return j},this.setPixelRatio=function(I){I!==void 0&&(j=I,this.setSize(se,B,!1))},this.getSize=function(I){return I===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),I=new oe),I.set(se,B)},this.setSize=function(I,re,ee){if(Me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}se=I,B=re,e.width=Math.floor(I*j),e.height=Math.floor(re*j),ee!==!1&&(e.style.width=I+"px",e.style.height=re+"px"),this.setViewport(0,0,I,re)},this.getDrawingBufferSize=function(I){return I===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),I=new oe),I.set(se*j,B*j).floor()},this.setDrawingBufferSize=function(I,re,ee){se=I,B=re,j=ee,e.width=Math.floor(I*ee),e.height=Math.floor(re*ee),this.setViewport(0,0,I,re)},this.getCurrentViewport=function(I){return I===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),I=new At),I.copy(O)},this.getViewport=function(I){return I.copy(X)},this.setViewport=function(I,re,ee,ce){I.isVector4?X.set(I.x,I.y,I.z,I.w):X.set(I,re,ee,ce),Ke.viewport(O.copy(X).multiplyScalar(j).floor())},this.getScissor=function(I){return I.copy(Z)},this.setScissor=function(I,re,ee,ce){I.isVector4?Z.set(I.x,I.y,I.z,I.w):Z.set(I,re,ee,ce),Ke.scissor(H.copy(Z).multiplyScalar(j).floor())},this.getScissorTest=function(){return le},this.setScissorTest=function(I){Ke.setScissorTest(le=I)},this.setOpaqueSort=function(I){Y=I},this.setTransparentSort=function(I){Q=I},this.getClearColor=function(){return ge.getClearColor()},this.setClearColor=function(){ge.setClearColor.apply(ge,arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha.apply(ge,arguments)},this.clear=function(I,re,ee){let ce=0;(I===void 0||I)&&(ce|=16384),(re===void 0||re)&&(ce|=256),(ee===void 0||ee)&&(ce|=1024),ue.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",gt,!1),e.removeEventListener("webglcontextrestored",Gt,!1),ve.dispose(),fe.dispose(),Ze.dispose(),ie.dispose(),Le.dispose(),xe.dispose(),Me.dispose(),tr.stop()};function gt(I){I.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Gt(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1,Pe()}function $t(I){const re=I.target;re.removeEventListener("dispose",$t),Rt(re)}function Rt(I){on(I),Ze.remove(I)}function on(I){const re=Ze.get(I).program;re!==void 0&&N.releaseProgram(re)}function ka(I,re){I.render(function(ee){m.renderBufferImmediate(ee,re)})}this.renderBufferImmediate=function(I,re){xe.initAttributes();const ee=Ze.get(I);I.hasPositions&&!ee.position&&(ee.position=ue.createBuffer()),I.hasNormals&&!ee.normal&&(ee.normal=ue.createBuffer()),I.hasUvs&&!ee.uv&&(ee.uv=ue.createBuffer()),I.hasColors&&!ee.color&&(ee.color=ue.createBuffer());const ce=re.getAttributes();I.hasPositions&&(ue.bindBuffer(34962,ee.position),ue.bufferData(34962,I.positionArray,35048),xe.enableAttribute(ce.position),ue.vertexAttribPointer(ce.position,3,5126,!1,0,0)),I.hasNormals&&(ue.bindBuffer(34962,ee.normal),ue.bufferData(34962,I.normalArray,35048),xe.enableAttribute(ce.normal),ue.vertexAttribPointer(ce.normal,3,5126,!1,0,0)),I.hasUvs&&(ue.bindBuffer(34962,ee.uv),ue.bufferData(34962,I.uvArray,35048),xe.enableAttribute(ce.uv),ue.vertexAttribPointer(ce.uv,2,5126,!1,0,0)),I.hasColors&&(ue.bindBuffer(34962,ee.color),ue.bufferData(34962,I.colorArray,35048),xe.enableAttribute(ce.color),ue.vertexAttribPointer(ce.color,3,5126,!1,0,0)),xe.disableUnusedAttributes(),ue.drawArrays(4,0,I.count),I.count=0},this.renderBufferDirect=function(I,re,ee,ce,Ce,ut){re===null&&(re=tt);const $e=Ce.isMesh&&Ce.matrixWorld.determinant()<0,dt=Er(I,re,ce,Ce);Ke.setMaterial(ce,$e);let rt=ee.index;const It=ee.attributes.position;if(rt===null){if(It===void 0||It.count===0)return}else if(rt.count===0)return;let Ot=1;ce.wireframe===!0&&(rt=ke.getWireframeAttribute(ee),Ot=2),(ce.morphTargets||ce.morphNormals)&&Ee.update(Ce,ee,ce,dt),xe.setup(Ce,ce,dt,ee,rt);let st,vt=Be;rt!==null&&(st=_e.get(rt),vt=Se,vt.setIndex(st));const In=rt!==null?rt.count:It.count,wt=ee.drawRange.start*Ot,ni=ee.drawRange.count*Ot,Ht=ut!==null?ut.start*Ot:0,nr=ut!==null?ut.count*Ot:1/0,an=Math.max(wt,Ht),Ii=Math.min(In,wt+ni,Ht+nr)-1,Ni=Math.max(0,Ii-an+1);if(Ni!==0){if(Ce.isMesh)ce.wireframe===!0?(Ke.setLineWidth(ce.wireframeLinewidth*_t()),vt.setMode(1)):vt.setMode(4);else if(Ce.isLine){let Oi=ce.linewidth;Oi===void 0&&(Oi=1),Ke.setLineWidth(Oi*_t()),Ce.isLineSegments?vt.setMode(1):Ce.isLineLoop?vt.setMode(2):vt.setMode(3)}else Ce.isPoints?vt.setMode(0):Ce.isSprite&&vt.setMode(4);if(Ce.isInstancedMesh)vt.renderInstances(an,Ni,Ce.count);else if(ee.isInstancedBufferGeometry){const Oi=Math.min(ee.instanceCount,ee._maxInstanceCount);vt.renderInstances(an,Ni,Oi)}else vt.render(an,Ni)}},this.compile=function(I,re){g=fe.get(I,re),g.init(),I.traverseVisible(function(ce){ce.isLight&&ce.layers.test(re.layers)&&(g.pushLight(ce),ce.castShadow&&g.pushShadow(ce))}),g.setupLights(re);const ee=new WeakMap;I.traverse(function(ce){const Ce=ce.material;if(Ce)if(Array.isArray(Ce))for(let ut=0;ut<Ce.length;ut++){const $e=Ce[ut];ee.has($e)===!1&&(Un($e,I,ce),ee.set($e))}else ee.has(Ce)===!1&&(Un(Ce,I,ce),ee.set(Ce))})};let Tr=null;function Ua(I){Me.isPresenting||Tr&&Tr(I)}const tr=new Vh;tr.setAnimationLoop(Ua),typeof window<"u"&&tr.setContext(window),this.setAnimationLoop=function(I){Tr=I,Me.setAnimationLoop(I),I===null?tr.stop():tr.start()},this.render=function(I,re){let ee,ce;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),ee=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),ce=arguments[3]),re!==void 0&&re.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;xe.resetDefaultState(),R=-1,p=null,I.autoUpdate===!0&&I.updateMatrixWorld(),re.parent===null&&re.updateMatrixWorld(),Me.enabled===!0&&Me.isPresenting===!0&&(re=Me.getCamera(re)),I.isScene===!0&&I.onBeforeRender(m,I,re,ee||v),g=fe.get(I,re),g.init(),Re.multiplyMatrices(re.projectionMatrix,re.matrixWorldInverse),de.setFromProjectionMatrix(Re),Ne=this.localClippingEnabled,we=G.init(this.clippingPlanes,Ne,re),h=ve.get(I,re),h.init(),ys(I,re,0,m.sortObjects),h.finish(),m.sortObjects===!0&&h.sort(Y,Q),we===!0&&G.beginShadows();const Ce=g.state.shadowsArray;ze.render(Ce,I,re),g.setupLights(re),we===!0&&G.endShadows(),this.info.autoReset===!0&&this.info.reset(),ee!==void 0&&this.setRenderTarget(ee),ge.render(h,I,re,ce);const ut=h.opaque,$e=h.transparent;ut.length>0&&yi(ut,I,re),$e.length>0&&yi($e,I,re),I.isScene===!0&&I.onAfterRender(m,I,re),v!==null&&(me.updateRenderTargetMipmap(v),me.updateMultisampleRenderTarget(v)),Ke.buffers.depth.setTest(!0),Ke.buffers.depth.setMask(!0),Ke.buffers.color.setMask(!0),Ke.setPolygonOffset(!1),h=null,g=null};function ys(I,re,ee,ce){if(I.visible===!1)return;if(I.layers.test(re.layers)){if(I.isGroup)ee=I.renderOrder;else if(I.isLOD)I.autoUpdate===!0&&I.update(re);else if(I.isLight)g.pushLight(I),I.castShadow&&g.pushShadow(I);else if(I.isSprite){if(!I.frustumCulled||de.intersectsSprite(I)){ce&&Je.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Re);const $e=Le.update(I),dt=I.material;dt.visible&&h.push(I,$e,dt,ee,Je.z,null)}}else if(I.isImmediateRenderObject)ce&&Je.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Re),h.push(I,null,I.material,ee,Je.z,null);else if((I.isMesh||I.isLine||I.isPoints)&&(I.isSkinnedMesh&&I.skeleton.frame!==it.render.frame&&(I.skeleton.update(),I.skeleton.frame=it.render.frame),!I.frustumCulled||de.intersectsObject(I))){ce&&Je.setFromMatrixPosition(I.matrixWorld).applyMatrix4(Re);const $e=Le.update(I),dt=I.material;if(Array.isArray(dt)){const rt=$e.groups;for(let It=0,Ot=rt.length;It<Ot;It++){const st=rt[It],vt=dt[st.materialIndex];vt&&vt.visible&&h.push(I,$e,vt,ee,Je.z,st)}}else dt.visible&&h.push(I,$e,dt,ee,Je.z,null)}}const ut=I.children;for(let $e=0,dt=ut.length;$e<dt;$e++)ys(ut[$e],re,ee,ce)}function yi(I,re,ee){const ce=re.isScene===!0?re.overrideMaterial:null;for(let Ce=0,ut=I.length;Ce<ut;Ce++){const $e=I[Ce],dt=$e.object,rt=$e.geometry,It=ce===null?$e.material:ce,Ot=$e.group;if(ee.isArrayCamera){A=ee;const st=ee.cameras;for(let vt=0,In=st.length;vt<In;vt++){const wt=st[vt];dt.layers.test(wt.layers)&&(Ke.viewport(O.copy(wt.viewport)),g.setupLights(wt),vi(dt,re,wt,rt,It,Ot))}}else A=null,vi(dt,re,ee,rt,It,Ot)}}function vi(I,re,ee,ce,Ce,ut){if(I.onBeforeRender(m,re,ee,ce,Ce,ut),g=fe.get(re,A||ee),I.modelViewMatrix.multiplyMatrices(ee.matrixWorldInverse,I.matrixWorld),I.normalMatrix.getNormalMatrix(I.modelViewMatrix),I.isImmediateRenderObject){const $e=Er(ee,re,Ce,I);Ke.setMaterial(Ce),xe.reset(),ka(I,$e)}else m.renderBufferDirect(ee,re,ce,Ce,I,ut);I.onAfterRender(m,re,ee,ce,Ce,ut),g=fe.get(re,A||ee)}function Un(I,re,ee){re.isScene!==!0&&(re=tt);const ce=Ze.get(I),Ce=g.state.lights,ut=g.state.shadowsArray,$e=Ce.state.version,dt=N.getParameters(I,Ce.state,ut,re,ee),rt=N.getProgramCacheKey(dt);let It=ce.program,Ot=!0;if(It===void 0)I.addEventListener("dispose",$t);else if(It.cacheKey!==rt)on(I);else if(ce.lightsStateVersion!==$e)Ot=!1;else if(dt.shaderID!==void 0){const wt=I.isMeshStandardMaterial?re.environment:null;ce.envMap=ie.get(I.envMap||wt);return}else Ot=!1;Ot&&(dt.uniforms=N.getUniforms(I),I.onBeforeCompile(dt,m),It=N.acquireProgram(dt,rt),ce.program=It,ce.uniforms=dt.uniforms,ce.outputEncoding=dt.outputEncoding);const st=ce.uniforms;(!I.isShaderMaterial&&!I.isRawShaderMaterial||I.clipping===!0)&&(ce.numClippingPlanes=G.numPlanes,ce.numIntersection=G.numIntersection,st.clippingPlanes=G.uniform),ce.environment=I.isMeshStandardMaterial?re.environment:null,ce.fog=re.fog,ce.envMap=ie.get(I.envMap||ce.environment),ce.needsLights=Ga(I),ce.lightsStateVersion=$e,ce.needsLights&&(st.ambientLightColor.value=Ce.state.ambient,st.lightProbe.value=Ce.state.probe,st.directionalLights.value=Ce.state.directional,st.directionalLightShadows.value=Ce.state.directionalShadow,st.spotLights.value=Ce.state.spot,st.spotLightShadows.value=Ce.state.spotShadow,st.rectAreaLights.value=Ce.state.rectArea,st.ltc_1.value=Ce.state.rectAreaLTC1,st.ltc_2.value=Ce.state.rectAreaLTC2,st.pointLights.value=Ce.state.point,st.pointLightShadows.value=Ce.state.pointShadow,st.hemisphereLights.value=Ce.state.hemi,st.directionalShadowMap.value=Ce.state.directionalShadowMap,st.directionalShadowMatrix.value=Ce.state.directionalShadowMatrix,st.spotShadowMap.value=Ce.state.spotShadowMap,st.spotShadowMatrix.value=Ce.state.spotShadowMatrix,st.pointShadowMap.value=Ce.state.pointShadowMap,st.pointShadowMatrix.value=Ce.state.pointShadowMatrix);const vt=ce.program.getUniforms(),In=Yi.seqWithValue(vt.seq,st);ce.uniformsList=In}function Er(I,re,ee,ce){re.isScene!==!0&&(re=tt),me.resetTextureUnits();const Ce=re.fog,ut=ee.isMeshStandardMaterial?re.environment:null,$e=v===null?m.outputEncoding:v.texture.encoding,dt=ie.get(ee.envMap||ut),rt=Ze.get(ee),It=g.state.lights;if(we===!0&&(Ne===!0||I!==p)){const Ht=I===p&&ee.id===R;G.setState(ee,I,Ht)}ee.version===rt.__version?(ee.fog&&rt.fog!==Ce||rt.environment!==ut||rt.needsLights&&rt.lightsStateVersion!==It.state.version||rt.numClippingPlanes!==void 0&&(rt.numClippingPlanes!==G.numPlanes||rt.numIntersection!==G.numIntersection)||rt.outputEncoding!==$e||rt.envMap!==dt)&&Un(ee,re,ce):(Un(ee,re,ce),rt.__version=ee.version);let Ot=!1,st=!1,vt=!1;const In=rt.program,wt=In.getUniforms(),ni=rt.uniforms;if(Ke.useProgram(In.program)&&(Ot=!0,st=!0,vt=!0),ee.id!==R&&(R=ee.id,st=!0),Ot||p!==I){if(wt.setValue(ue,"projectionMatrix",I.projectionMatrix),ft.logarithmicDepthBuffer&&wt.setValue(ue,"logDepthBufFC",2/(Math.log(I.far+1)/Math.LN2)),p!==I&&(p=I,st=!0,vt=!0),ee.isShaderMaterial||ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshStandardMaterial||ee.envMap){const Ht=wt.map.cameraPosition;Ht!==void 0&&Ht.setValue(ue,Je.setFromMatrixPosition(I.matrixWorld))}(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial)&&wt.setValue(ue,"isOrthographic",I.isOrthographicCamera===!0),(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial||ee.isShadowMaterial||ee.skinning)&&wt.setValue(ue,"viewMatrix",I.matrixWorldInverse)}if(ee.skinning){wt.setOptional(ue,ce,"bindMatrix"),wt.setOptional(ue,ce,"bindMatrixInverse");const Ht=ce.skeleton;if(Ht){const nr=Ht.bones;if(ft.floatVertexTextures){if(Ht.boneTexture===void 0){let an=Math.sqrt(nr.length*4);an=at.ceilPowerOfTwo(an),an=Math.max(an,4);const Ii=new Float32Array(an*an*4);Ii.set(Ht.boneMatrices);const Ni=new os(Ii,an,an,Qn,qi);Ht.boneMatrices=Ii,Ht.boneTexture=Ni,Ht.boneTextureSize=an}wt.setValue(ue,"boneTexture",Ht.boneTexture,me),wt.setValue(ue,"boneTextureSize",Ht.boneTextureSize)}else wt.setOptional(ue,Ht,"boneMatrices")}}return(st||rt.receiveShadow!==ce.receiveShadow)&&(rt.receiveShadow=ce.receiveShadow,wt.setValue(ue,"receiveShadow",ce.receiveShadow)),st&&(wt.setValue(ue,"toneMappingExposure",m.toneMappingExposure),rt.needsLights&&Ar(ni,vt),Ce&&ee.fog&&D.refreshFogUniforms(ni,Ce),D.refreshMaterialUniforms(ni,ee,j,B),Yi.upload(ue,rt.uniformsList,ni,me)),ee.isShaderMaterial&&ee.uniformsNeedUpdate===!0&&(Yi.upload(ue,rt.uniformsList,ni,me),ee.uniformsNeedUpdate=!1),ee.isSpriteMaterial&&wt.setValue(ue,"center",ce.center),wt.setValue(ue,"modelViewMatrix",ce.modelViewMatrix),wt.setValue(ue,"normalMatrix",ce.normalMatrix),wt.setValue(ue,"modelMatrix",ce.matrixWorld),In}function Ar(I,re){I.ambientLightColor.needsUpdate=re,I.lightProbe.needsUpdate=re,I.directionalLights.needsUpdate=re,I.directionalLightShadows.needsUpdate=re,I.pointLights.needsUpdate=re,I.pointLightShadows.needsUpdate=re,I.spotLights.needsUpdate=re,I.spotLightShadows.needsUpdate=re,I.rectAreaLights.needsUpdate=re,I.hemisphereLights.needsUpdate=re}function Ga(I){return I.isMeshLambertMaterial||I.isMeshToonMaterial||I.isMeshPhongMaterial||I.isMeshStandardMaterial||I.isShadowMaterial||I.isShaderMaterial&&I.lights===!0}this.setFramebuffer=function(I){w!==I&&v===null&&ue.bindFramebuffer(36160,I),w=I},this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return _},this.getRenderList=function(){return h},this.setRenderList=function(I){h=I},this.getRenderState=function(){return g},this.setRenderState=function(I){g=I},this.getRenderTarget=function(){return v},this.setRenderTarget=function(I,re=0,ee=0){v=I,M=re,_=ee,I&&Ze.get(I).__webglFramebuffer===void 0&&me.setupRenderTarget(I);let ce=w,Ce=!1;if(I){const ut=Ze.get(I).__webglFramebuffer;I.isWebGLCubeRenderTarget?(ce=ut[re],Ce=!0):I.isWebGLMultisampleRenderTarget?ce=Ze.get(I).__webglMultisampledFramebuffer:ce=ut,O.copy(I.viewport),H.copy(I.scissor),ne=I.scissorTest}else O.copy(X).multiplyScalar(j).floor(),H.copy(Z).multiplyScalar(j).floor(),ne=le;if(E!==ce&&(ue.bindFramebuffer(36160,ce),E=ce),Ke.viewport(O),Ke.scissor(H),Ke.setScissorTest(ne),Ce){const ut=Ze.get(I.texture);ue.framebufferTexture2D(36160,36064,34069+re,ut.__webglTexture,ee)}},this.readRenderTargetPixels=function(I,re,ee,ce,Ce,ut,$e){if(!(I&&I.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let dt=Ze.get(I).__webglFramebuffer;if(I.isWebGLCubeRenderTarget&&$e!==void 0&&(dt=dt[$e]),dt){let rt=!1;dt!==E&&(ue.bindFramebuffer(36160,dt),rt=!0);try{const It=I.texture,Ot=It.format,st=It.type;if(Ot!==Qn&&k.convert(Ot)!==ue.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(st!==El&&k.convert(st)!==ue.getParameter(35738)&&!(st===qi&&(ft.isWebGL2||We.get("OES_texture_float")||We.get("WEBGL_color_buffer_float")))&&!(st===pa&&(ft.isWebGL2?We.get("EXT_color_buffer_float"):We.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ue.checkFramebufferStatus(36160)===36053?re>=0&&re<=I.width-ce&&ee>=0&&ee<=I.height-Ce&&ue.readPixels(re,ee,ce,Ce,k.convert(Ot),k.convert(st),ut):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{rt&&ue.bindFramebuffer(36160,E)}}},this.copyFramebufferToTexture=function(I,re,ee){ee===void 0&&(ee=0);const ce=Math.pow(2,-ee),Ce=Math.floor(re.image.width*ce),ut=Math.floor(re.image.height*ce),$e=k.convert(re.format);me.setTexture2D(re,0),ue.copyTexImage2D(3553,ee,$e,I.x,I.y,Ce,ut,0),Ke.unbindTexture()},this.copyTextureToTexture=function(I,re,ee,ce){ce===void 0&&(ce=0);const Ce=re.image.width,ut=re.image.height,$e=k.convert(ee.format),dt=k.convert(ee.type);me.setTexture2D(ee,0),ue.pixelStorei(37440,ee.flipY),ue.pixelStorei(37441,ee.premultiplyAlpha),ue.pixelStorei(3317,ee.unpackAlignment),re.isDataTexture?ue.texSubImage2D(3553,ce,I.x,I.y,Ce,ut,$e,dt,re.image.data):re.isCompressedTexture?ue.compressedTexSubImage2D(3553,ce,I.x,I.y,re.mipmaps[0].width,re.mipmaps[0].height,$e,re.mipmaps[0].data):ue.texSubImage2D(3553,ce,I.x,I.y,$e,dt,re.image),ce===0&&ee.generateMipmaps&&ue.generateMipmap(3553),Ke.unbindTexture()},this.initTexture=function(I){me.setTexture2D(I,0),Ke.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ju(t){po.call(this,t)}Ju.prototype=Object.assign(Object.create(po.prototype),{constructor:Ju,isWebGL1Renderer:!0});class Cl{constructor(e,n){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new He(e),this.density=n!==void 0?n:25e-5}clone(){return new Cl(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Rl{constructor(e,n,i){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new He(e),this.near=n!==void 0?n:1,this.far=i!==void 0?i:1e3}clone(){return new Rl(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Pl extends je{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.background!==null&&(n.object.background=this.background.toJSON(e)),this.environment!==null&&(n.object.environment=this.environment.toJSON(e)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n}}function On(t,e){this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=Ia,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=at.generateUUID()}Object.defineProperty(On.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});Object.assign(On.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return e===void 0&&(e=0),this.array.set(t,e),this},clone:function(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=at.generateUUID()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new On(e,this.stride);return n.setUsage(this.usage),n},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=at.generateUUID()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const ur=new P;function xr(t,e,n,i){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=i===!0}Object.defineProperties(xr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}});Object.assign(xr.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let e=0,n=this.data.count;e<n;e++)ur.x=this.getX(e),ur.y=this.getY(e),ur.z=this.getZ(e),ur.applyMatrix4(t),this.setXYZ(e,ur.x,ur.y,ur.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this},clone:function(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return new ct(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new xr(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function _r(t){Ye.call(this),this.type="SpriteMaterial",this.color=new He(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}_r.prototype=Object.create(Ye.prototype);_r.prototype.constructor=_r;_r.prototype.isSpriteMaterial=!0;_r.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};let jr;const Ls=new P,qr=new P,Xr=new P,Yr=new oe,Cs=new oe,Kh=new ht,Go=new P,Rs=new P,Ho=new P,$u=new oe,Ec=new oe,Qu=new oe;function Yc(t){if(je.call(this),this.type="Sprite",jr===void 0){jr=new lt;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new On(e,5);jr.setIndex([0,1,2,0,2,3]),jr.setAttribute("position",new xr(n,3,0,!1)),jr.setAttribute("uv",new xr(n,2,3,!1))}this.geometry=jr,this.material=t!==void 0?t:new _r,this.center=new oe(.5,.5)}Yc.prototype=Object.assign(Object.create(je.prototype),{constructor:Yc,isSprite:!0,raycast:function(t,e){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),qr.setFromMatrixScale(this.matrixWorld),Kh.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Xr.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&qr.multiplyScalar(-Xr.z);const n=this.material.rotation;let i,r;n!==0&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;Vo(Go.set(-.5,-.5,0),Xr,s,qr,i,r),Vo(Rs.set(.5,-.5,0),Xr,s,qr,i,r),Vo(Ho.set(.5,.5,0),Xr,s,qr,i,r),$u.set(0,0),Ec.set(1,0),Qu.set(1,1);let o=t.ray.intersectTriangle(Go,Rs,Ho,!1,Ls);if(o===null&&(Vo(Rs.set(-.5,.5,0),Xr,s,qr,i,r),Ec.set(0,1),o=t.ray.intersectTriangle(Go,Ho,Rs,!1,Ls),o===null))return;const a=t.ray.origin.distanceTo(Ls);a<t.near||a>t.far||e.push({distance:a,point:Ls.clone(),uv:hn.getUV(Ls,Go,Rs,Ho,$u,Ec,Qu,new oe),face:null,object:this})},copy:function(t){return je.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}});function Vo(t,e,n,i,r,s){Yr.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(Cs.x=s*Yr.x-r*Yr.y,Cs.y=r*Yr.x+s*Yr.y):Cs.copy(Yr),t.copy(e),t.x+=Cs.x,t.y+=Cs.y,t.applyMatrix4(Kh)}const Wo=new P,Ku=new P;function ya(){je.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}ya.prototype=Object.assign(Object.create(je.prototype),{constructor:ya,isLOD:!0,copy:function(t){je.prototype.copy.call(this,t,!1);const e=t.levels;for(let n=0,i=e.length;n<i;n++){const r=e[n];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e){e===void 0&&(e=0),e=Math.abs(e);const n=this.levels;let i;for(i=0;i<n.length&&!(e<n[i].distance);i++);return n.splice(i,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const e=this.levels;if(e.length>0){let n,i;for(n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object}return null},raycast:function(t,e){if(this.levels.length>0){Wo.setFromMatrixPosition(this.matrixWorld);const i=t.ray.origin.distanceTo(Wo);this.getObjectForDistance(i).raycast(t,e)}},update:function(t){const e=this.levels;if(e.length>1){Wo.setFromMatrixPosition(t.matrixWorld),Ku.setFromMatrixPosition(this.matrixWorld);const n=Wo.distanceTo(Ku)/t.zoom;e[0].object.visible=!0;let i,r;for(i=1,r=e.length;i<r&&n>=e[i].distance;i++)e[i-1].object.visible=!1,e[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)e[i].object.visible=!1}},toJSON:function(t){const e=je.prototype.toJSON.call(this,t);this.autoUpdate===!1&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];e.object.levels.push({object:s.object.uuid,distance:s.distance})}return e}});function Zc(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Jt.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ht,this.bindMatrixInverse=new ht}Zc.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Zc,isSkinnedMesh:!0,copy:function(t){return Jt.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new At,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Jt.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:(function(){const t=new P,e=new At,n=new At,i=new P,r=new ht;return function(s,o){const a=this.skeleton,u=this.geometry;e.fromBufferAttribute(u.attributes.skinIndex,s),n.fromBufferAttribute(u.attributes.skinWeight,s),t.fromBufferAttribute(u.attributes.position,s).applyMatrix4(this.bindMatrix),o.set(0,0,0);for(let l=0;l<4;l++){const d=n.getComponent(l);if(d!==0){const h=e.getComponent(l);r.multiplyMatrices(a.bones[h].matrixWorld,a.boneInverses[h]),o.addScaledVector(i.copy(t).applyMatrix4(r),d)}}return o.applyMatrix4(this.bindMatrixInverse)}})()});const eh=new ht,cx=new ht;function Jc(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,e===void 0)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new ht)}}Object.assign(Jc.prototype,{calculateInverses:function(){this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++){const n=new ht;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(let t=0,e=this.bones.length;t<e;t++){const n=this.bones[t];n&&n.matrixWorld.getInverse(this.boneInverses[t])}for(let t=0,e=this.bones.length;t<e;t++){const n=this.bones[t];n&&(n.parent&&n.parent.isBone?(n.matrix.getInverse(n.parent.matrixWorld),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}},update:function(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=t.length;r<s;r++){const o=t[r]?t[r].matrixWorld:cx;eh.multiplyMatrices(o,e[r]),eh.toArray(n,r*16)}i!==void 0&&(i.needsUpdate=!0)},clone:function(){return new Jc(this.bones,this.boneInverses)},getBoneByName:function(t){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];if(i.name===t)return i}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function th(){je.call(this),this.type="Bone"}th.prototype=Object.assign(Object.create(je.prototype),{constructor:th,isBone:!0});const nh=new ht,ih=new ht,jo=[],Ps=new Jt;function $c(t,e,n){Jt.call(this,t,e),this.instanceMatrix=new ct(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}$c.prototype=Object.assign(Object.create(Jt.prototype),{constructor:$c,isInstancedMesh:!0,copy:function(t){return Jt.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},setColorAt:function(t,e){this.instanceColor===null&&(this.instanceColor=new ct(new Float32Array(this.count*3),3)),e.toArray(this.instanceColor.array,t*3)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,t*16)},raycast:function(t,e){const n=this.matrixWorld,i=this.count;if(Ps.geometry=this.geometry,Ps.material=this.material,Ps.material!==void 0)for(let r=0;r<i;r++){this.getMatrixAt(r,nh),ih.multiplyMatrices(n,nh),Ps.matrixWorld=ih,Ps.raycast(t,jo);for(let s=0,o=jo.length;s<o;s++){const a=jo[s];a.instanceId=r,a.object=this,e.push(a)}jo.length=0}},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,t*16)},updateMorphTargets:function(){}});function zn(t){Ye.call(this),this.type="LineBasicMaterial",this.color=new He(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}zn.prototype=Object.create(Ye.prototype);zn.prototype.constructor=zn;zn.prototype.isLineBasicMaterial=!0;zn.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const rh=new P,sh=new P,oh=new ht,qo=new ho,Xo=new er;function br(t,e,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),je.call(this),this.type="Line",this.geometry=t!==void 0?t:new lt,this.material=e!==void 0?e:new zn,this.updateMorphTargets()}br.prototype=Object.assign(Object.create(je.prototype),{constructor:br,isLine:!0,copy:function(t){return je.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[0];for(let i=1,r=e.count;i<r;i++)rh.fromBufferAttribute(e,i-1),sh.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=rh.distanceTo(sh);t.setAttribute("lineDistance",new Ue(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const e=t.vertices,n=t.lineDistances;n[0]=0;for(let i=1,r=e.length;i<r;i++)n[i]=n[i-1],n[i]+=e[i-1].distanceTo(e[i])}return this},raycast:function(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),Xo.copy(n.boundingSphere),Xo.applyMatrix4(i),Xo.radius+=r,t.ray.intersectsSphere(Xo)===!1)return;oh.getInverse(i),qo.copy(t.ray).applyMatrix4(oh);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,a=new P,u=new P,l=new P,d=new P,h=this.isLineSegments?2:1;if(n.isBufferGeometry){const g=n.index,y=n.attributes.position;if(g!==null){const w=g.array;for(let M=0,_=w.length-1;M<_;M+=h){const v=w[M],E=w[M+1];if(a.fromBufferAttribute(y,v),u.fromBufferAttribute(y,E),qo.distanceSqToSegment(a,u,d,l)>o)continue;d.applyMatrix4(this.matrixWorld);const p=t.ray.origin.distanceTo(d);p<t.near||p>t.far||e.push({distance:p,point:l.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else for(let w=0,M=y.count-1;w<M;w+=h){if(a.fromBufferAttribute(y,w),u.fromBufferAttribute(y,w+1),qo.distanceSqToSegment(a,u,d,l)>o)continue;d.applyMatrix4(this.matrixWorld);const v=t.ray.origin.distanceTo(d);v<t.near||v>t.far||e.push({distance:v,point:l.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const g=n.vertices,m=g.length;for(let y=0;y<m-1;y+=h){if(qo.distanceSqToSegment(g[y],g[y+1],d,l)>o)continue;d.applyMatrix4(this.matrixWorld);const M=t.ray.origin.distanceTo(d);M<t.near||M>t.far||e.push({distance:M,point:l.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const i=e[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){const o=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Yo=new P,Zo=new P;function Zs(t,e){br.call(this,t,e),this.type="LineSegments"}Zs.prototype=Object.assign(Object.create(br.prototype),{constructor:Zs,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(t.index===null){const e=t.attributes.position,n=[];for(let i=0,r=e.count;i<r;i+=2)Yo.fromBufferAttribute(e,i),Zo.fromBufferAttribute(e,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Yo.distanceTo(Zo);t.setAttribute("lineDistance",new Ue(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const e=t.vertices,n=t.lineDistances;for(let i=0,r=e.length;i<r;i+=2)Yo.copy(e[i]),Zo.copy(e[i+1]),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Yo.distanceTo(Zo)}return this}});function Qc(t,e){br.call(this,t,e),this.type="LineLoop"}Qc.prototype=Object.assign(Object.create(br.prototype),{constructor:Qc,isLineLoop:!0});function wr(t){Ye.call(this),this.type="PointsMaterial",this.color=new He(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}wr.prototype=Object.create(Ye.prototype);wr.prototype.constructor=wr;wr.prototype.isPointsMaterial=!0;wr.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const ah=new ht,Kc=new ho,Jo=new er,$o=new P;function el(t,e){je.call(this),this.type="Points",this.geometry=t!==void 0?t:new lt,this.material=e!==void 0?e:new wr,this.updateMorphTargets()}el.prototype=Object.assign(Object.create(je.prototype),{constructor:el,isPoints:!0,copy:function(t){return je.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),Jo.copy(n.boundingSphere),Jo.applyMatrix4(i),Jo.radius+=r,t.ray.intersectsSphere(Jo)===!1)return;ah.getInverse(i),Kc.copy(t.ray).applyMatrix4(ah);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s;if(n.isBufferGeometry){const a=n.index,l=n.attributes.position;if(a!==null){const d=a.array;for(let h=0,g=d.length;h<g;h++){const m=d[h];$o.fromBufferAttribute(l,m),Ac($o,m,o,i,t,e,this)}}else for(let d=0,h=l.count;d<h;d++)$o.fromBufferAttribute(l,d),Ac($o,d,o,i,t,e,this)}else{const a=n.vertices;for(let u=0,l=a.length;u<l;u++)Ac(a[u],u,o,i,t,e,this)}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const i=e[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){const o=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}else{const e=t.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Ac(t,e,n,i,r,s,o){const a=Kc.distanceSqToPoint(t);if(a<n){const u=new P;Kc.closestPointToPoint(t,u),u.applyMatrix4(i);const l=r.ray.origin.distanceTo(u);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:u,index:e,face:null,object:o})}}function ch(t,e,n,i,r,s,o,a,u){Ct.call(this,t,e,n,i,r,s,o,a,u),this.format=o!==void 0?o:fr,this.minFilter=s!==void 0?s:sn,this.magFilter=r!==void 0?r:sn,this.generateMipmaps=!1;const l=this;function d(){l.needsUpdate=!0,t.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(d)}ch.prototype=Object.assign(Object.create(Ct.prototype),{constructor:ch,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Js(t,e,n,i,r,s,o,a,u,l,d,h){Ct.call(this,null,s,o,a,u,l,i,r,d,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}Js.prototype=Object.create(Ct.prototype);Js.prototype.constructor=Js;Js.prototype.isCompressedTexture=!0;function va(t,e,n,i,r,s,o,a,u){Ct.call(this,t,e,n,i,r,s,o,a,u),this.needsUpdate=!0}va.prototype=Object.create(Ct.prototype);va.prototype.constructor=va;va.prototype.isCanvasTexture=!0;function xa(t,e,n,i,r,s,o,a,u,l){if(l=l!==void 0?l:ns,l!==ns&&l!==Vs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&l===ns&&(n=da),n===void 0&&l===Vs&&(n=zs),Ct.call(this,null,i,r,s,o,a,l,n,u),this.image={width:t,height:e},this.magFilter=o!==void 0?o:un,this.minFilter=a!==void 0?a:un,this.flipY=!1,this.generateMipmaps=!1}xa.prototype=Object.create(Ct.prototype);xa.prototype.constructor=xa;xa.prototype.isDepthTexture=!0;let lx=0;const oi=new ht,Lc=new je,Qo=new P;function Lt(){Object.defineProperty(this,"id",{value:lx+=2}),this.uuid=at.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Lt.prototype=Object.assign(Object.create(ti.prototype),{constructor:Lt,isGeometry:!0,applyMatrix4:function(t){const e=new _n().getNormalMatrix(t);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(let n=0,i=this.faces.length;n<i;n++){const r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return oi.makeRotationX(t),this.applyMatrix4(oi),this},rotateY:function(t){return oi.makeRotationY(t),this.applyMatrix4(oi),this},rotateZ:function(t){return oi.makeRotationZ(t),this.applyMatrix4(oi),this},translate:function(t,e,n){return oi.makeTranslation(t,e,n),this.applyMatrix4(oi),this},scale:function(t,e,n){return oi.makeScale(t,e,n),this.applyMatrix4(oi),this},lookAt:function(t){return Lc.lookAt(t),Lc.updateMatrix(),this.applyMatrix4(Lc.matrix),this},fromBufferGeometry:function(t){const e=this,n=t.index!==null?t.index:void 0,i=t.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const r=i.position,s=i.normal,o=i.color,a=i.uv,u=i.uv2;u!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<r.count;h++)e.vertices.push(new P().fromBufferAttribute(r,h)),o!==void 0&&e.colors.push(new He().fromBufferAttribute(o,h));function l(h,g,m,y){const w=o===void 0?[]:[e.colors[h].clone(),e.colors[g].clone(),e.colors[m].clone()],M=s===void 0?[]:[new P().fromBufferAttribute(s,h),new P().fromBufferAttribute(s,g),new P().fromBufferAttribute(s,m)],_=new kc(h,g,m,M,w,y);e.faces.push(_),a!==void 0&&e.faceVertexUvs[0].push([new oe().fromBufferAttribute(a,h),new oe().fromBufferAttribute(a,g),new oe().fromBufferAttribute(a,m)]),u!==void 0&&e.faceVertexUvs[1].push([new oe().fromBufferAttribute(u,h),new oe().fromBufferAttribute(u,g),new oe().fromBufferAttribute(u,m)])}const d=t.groups;if(d.length>0)for(let h=0;h<d.length;h++){const g=d[h],m=g.start,y=g.count;for(let w=m,M=m+y;w<M;w+=3)n!==void 0?l(n.getX(w),n.getX(w+1),n.getX(w+2),g.materialIndex):l(w,w+1,w+2,g.materialIndex)}else if(n!==void 0)for(let h=0;h<n.count;h+=3)l(n.getX(h),n.getX(h+1),n.getX(h+2));else for(let h=0;h<r.count;h+=3)l(h,h+1,h+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qo).negate(),this.translate(Qo.x,Qo.y,Qo.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,e=this.boundingSphere.radius,n=e===0?1:1/e,i=new ht;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){const t=new P,e=new P;for(let n=0,i=this.faces.length;n<i;n++){const r=this.faces[n],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){t===void 0&&(t=!0);const e=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)e[n]=new P;if(t){const n=new P,i=new P;for(let r=0,s=this.faces.length;r<s;r++){const o=this.faces[r],a=this.vertices[o.a],u=this.vertices[o.b],l=this.vertices[o.c];n.subVectors(l,u),i.subVectors(a,u),n.cross(i),e[o.a].add(n),e[o.b].add(n),e[o.c].add(n)}}else{this.computeFaceNormals();for(let n=0,i=this.faces.length;n<i;n++){const r=this.faces[n];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)e[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){const r=this.faces[n],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){const n=this.faces[t],i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let e=0,n=this.faces.length;e<n;e++){const i=this.faces[e];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let r=0,s=i.vertexNormals.length;r<s;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}const t=new Lt;t.faces=this.faces;for(let e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];const r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){const u=new P,l={a:new P,b:new P,c:new P};r.push(u),s.push(l)}}const i=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){const o=this.faces[r],a=i.faceNormals[r],u=i.vertexNormals[r];a.copy(o.normal),u.a.copy(o.vertexNormals[0]),u.b.copy(o.vertexNormals[1]),u.c.copy(o.vertexNormals[2])}}for(let e=0,n=this.faces.length;e<n;e++){const i=this.faces[e];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ki),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new er),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let i;const r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,u=t.faces,l=this.colors,d=t.colors;n===void 0&&(n=0),e!==void 0&&(i=new _n().getNormalMatrix(e));for(let h=0,g=o.length;h<g;h++){const y=o[h].clone();e!==void 0&&y.applyMatrix4(e),s.push(y)}for(let h=0,g=d.length;h<g;h++)l.push(d[h].clone());for(let h=0,g=u.length;h<g;h++){const m=u[h];let y,w;const M=m.vertexNormals,_=m.vertexColors,v=new kc(m.a+r,m.b+r,m.c+r);v.normal.copy(m.normal),i!==void 0&&v.normal.applyMatrix3(i).normalize();for(let E=0,R=M.length;E<R;E++)y=M[E].clone(),i!==void 0&&y.applyMatrix3(i).normalize(),v.vertexNormals.push(y);v.color.copy(m.color);for(let E=0,R=_.length;E<R;E++)w=_[E],v.vertexColors.push(w.clone());v.materialIndex=m.materialIndex+n,a.push(v)}for(let h=0,g=t.faceVertexUvs.length;h<g;h++){const m=t.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let y=0,w=m.length;y<w;y++){const M=m[y],_=[];for(let v=0,E=M.length;v<E;v++)_.push(M[v].clone());this.faceVertexUvs[h].push(_)}}},mergeMesh:function(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)},mergeVertices:function(){const t={},e=[],n=[],r=Math.pow(10,4);for(let a=0,u=this.vertices.length;a<u;a++){const l=this.vertices[a],d=Math.round(l.x*r)+"_"+Math.round(l.y*r)+"_"+Math.round(l.z*r);t[d]===void 0?(t[d]=a,e.push(this.vertices[a]),n[a]=e.length-1):n[a]=n[t[d]]}const s=[];for(let a=0,u=this.faces.length;a<u;a++){const l=this.faces[a];l.a=n[l.a],l.b=n[l.b],l.c=n[l.c];const d=[l.a,l.b,l.c];for(let h=0;h<3;h++)if(d[h]===d[(h+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){const u=s[a];this.faces.splice(u,1);for(let l=0,d=this.faceVertexUvs.length;l<d;l++)this.faceVertexUvs[l].splice(u,1)}const o=this.vertices.length-e.length;return this.vertices=e,o},setFromPoints:function(t){this.vertices=[];for(let e=0,n=t.length;e<n;e++){const i=t[e];this.vertices.push(new P(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function n(a,u){return a.materialIndex-u.materialIndex}t.sort(n);const i=this.faceVertexUvs[0],r=this.faceVertexUvs[1];let s,o;i&&i.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){const u=t[a]._id;s&&s.push(i[u]),o&&o.push(r[u])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){const m=this.parameters;for(const y in m)m[y]!==void 0&&(t[y]=m[y]);return t}const e=[];for(let m=0;m<this.vertices.length;m++){const y=this.vertices[m];e.push(y.x,y.y,y.z)}const n=[],i=[],r={},s=[],o={},a=[],u={};for(let m=0;m<this.faces.length;m++){const y=this.faces[m],w=!0,M=!1,_=this.faceVertexUvs[0][m]!==void 0,v=y.normal.length()>0,E=y.vertexNormals.length>0,R=y.color.r!==1||y.color.g!==1||y.color.b!==1,p=y.vertexColors.length>0;let A=0;if(A=l(A,0,0),A=l(A,1,w),A=l(A,2,M),A=l(A,3,_),A=l(A,4,v),A=l(A,5,E),A=l(A,6,R),A=l(A,7,p),n.push(A),n.push(y.a,y.b,y.c),n.push(y.materialIndex),_){const O=this.faceVertexUvs[0][m];n.push(g(O[0]),g(O[1]),g(O[2]))}if(v&&n.push(d(y.normal)),E){const O=y.vertexNormals;n.push(d(O[0]),d(O[1]),d(O[2]))}if(R&&n.push(h(y.color)),p){const O=y.vertexColors;n.push(h(O[0]),h(O[1]),h(O[2]))}}function l(m,y,w){return w?m|1<<y:m&~(1<<y)}function d(m){const y=m.x.toString()+m.y.toString()+m.z.toString();return r[y]!==void 0||(r[y]=i.length/3,i.push(m.x,m.y,m.z)),r[y]}function h(m){const y=m.r.toString()+m.g.toString()+m.b.toString();return o[y]!==void 0||(o[y]=s.length,s.push(m.getHex())),o[y]}function g(m){const y=m.x.toString()+m.y.toString();return u[y]!==void 0||(u[y]=a.length/2,a.push(m.x,m.y)),u[y]}return t.data={},t.data.vertices=e,t.data.normals=i,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=n,t},clone:function(){return new Lt().copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const e=t.vertices;for(let h=0,g=e.length;h<g;h++)this.vertices.push(e[h].clone());const n=t.colors;for(let h=0,g=n.length;h<g;h++)this.colors.push(n[h].clone());const i=t.faces;for(let h=0,g=i.length;h<g;h++)this.faces.push(i[h].clone());for(let h=0,g=t.faceVertexUvs.length;h<g;h++){const m=t.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let y=0,w=m.length;y<w;y++){const M=m[y],_=[];for(let v=0,E=M.length;v<E;v++){const R=M[v];_.push(R.clone())}this.faceVertexUvs[h].push(_)}}const r=t.morphTargets;for(let h=0,g=r.length;h<g;h++){const m={};if(m.name=r[h].name,r[h].vertices!==void 0){m.vertices=[];for(let y=0,w=r[h].vertices.length;y<w;y++)m.vertices.push(r[h].vertices[y].clone())}if(r[h].normals!==void 0){m.normals=[];for(let y=0,w=r[h].normals.length;y<w;y++)m.normals.push(r[h].normals[y].clone())}this.morphTargets.push(m)}const s=t.morphNormals;for(let h=0,g=s.length;h<g;h++){const m={};if(s[h].vertexNormals!==void 0){m.vertexNormals=[];for(let y=0,w=s[h].vertexNormals.length;y<w;y++){const M=s[h].vertexNormals[y],_={};_.a=M.a.clone(),_.b=M.b.clone(),_.c=M.c.clone(),m.vertexNormals.push(_)}}if(s[h].faceNormals!==void 0){m.faceNormals=[];for(let y=0,w=s[h].faceNormals.length;y<w;y++)m.faceNormals.push(s[h].faceNormals[y].clone())}this.morphNormals.push(m)}const o=t.skinWeights;for(let h=0,g=o.length;h<g;h++)this.skinWeights.push(o[h].clone());const a=t.skinIndices;for(let h=0,g=a.length;h<g;h++)this.skinIndices.push(a[h].clone());const u=t.lineDistances;for(let h=0,g=u.length;h<g;h++)this.lineDistances.push(u[h]);const l=t.boundingBox;l!==null&&(this.boundingBox=l.clone());const d=t.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class ux extends Lt{constructor(e,n,i,r,s,o){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o},this.fromBufferGeometry(new Na(e,n,i,r,s,o)),this.mergeVertices()}}class ef extends lt{constructor(e,n,i,r){super(),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},e=e||1,n=n!==void 0?Math.max(3,n):8,i=i!==void 0?i:0,r=r!==void 0?r:Math.PI*2;const s=[],o=[],a=[],u=[],l=new P,d=new oe;o.push(0,0,0),a.push(0,0,1),u.push(.5,.5);for(let h=0,g=3;h<=n;h++,g+=3){const m=i+h/n*r;l.x=e*Math.cos(m),l.y=e*Math.sin(m),o.push(l.x,l.y,l.z),a.push(0,0,1),d.x=(o[g]/e+1)/2,d.y=(o[g+1]/e+1)/2,u.push(d.x,d.y)}for(let h=1;h<=n;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Ue(o,3)),this.setAttribute("normal",new Ue(a,3)),this.setAttribute("uv",new Ue(u,2))}}class hx extends Lt{constructor(e,n,i,r){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},this.fromBufferGeometry(new ef(e,n,i,r)),this.mergeVertices()}}class Dl extends lt{constructor(e,n,i,r,s,o,a,u){super(),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:u};const l=this;e=e!==void 0?e:1,n=n!==void 0?n:1,i=i||1,r=Math.floor(r)||8,s=Math.floor(s)||1,o=o!==void 0?o:!1,a=a!==void 0?a:0,u=u!==void 0?u:Math.PI*2;const d=[],h=[],g=[],m=[];let y=0;const w=[],M=i/2;let _=0;v(),o===!1&&(e>0&&E(!0),n>0&&E(!1)),this.setIndex(d),this.setAttribute("position",new Ue(h,3)),this.setAttribute("normal",new Ue(g,3)),this.setAttribute("uv",new Ue(m,2));function v(){const R=new P,p=new P;let A=0;const O=(n-e)/i;for(let H=0;H<=s;H++){const ne=[],se=H/s,B=se*(n-e)+e;for(let j=0;j<=r;j++){const Y=j/r,Q=Y*u+a,X=Math.sin(Q),Z=Math.cos(Q);p.x=B*X,p.y=-se*i+M,p.z=B*Z,h.push(p.x,p.y,p.z),R.set(X,O,Z).normalize(),g.push(R.x,R.y,R.z),m.push(Y,1-se),ne.push(y++)}w.push(ne)}for(let H=0;H<r;H++)for(let ne=0;ne<s;ne++){const se=w[ne][H],B=w[ne+1][H],j=w[ne+1][H+1],Y=w[ne][H+1];d.push(se,B,Y),d.push(B,j,Y),A+=6}l.addGroup(_,A,0),_+=A}function E(R){const p=y,A=new oe,O=new P;let H=0;const ne=R===!0?e:n,se=R===!0?1:-1;for(let j=1;j<=r;j++)h.push(0,M*se,0),g.push(0,se,0),m.push(.5,.5),y++;const B=y;for(let j=0;j<=r;j++){const Q=j/r*u+a,X=Math.cos(Q),Z=Math.sin(Q);O.x=ne*Z,O.y=M*se,O.z=ne*X,h.push(O.x,O.y,O.z),g.push(0,se,0),A.x=X*.5+.5,A.y=Z*.5*se+.5,m.push(A.x,A.y),y++}for(let j=0;j<r;j++){const Y=p+j,Q=B+j;R===!0?d.push(Q,Q+1,Y):d.push(Q+1,Q,Y),H+=3}l.addGroup(_,H,R===!0?1:2),_+=H}}}class tf extends Lt{constructor(e,n,i,r,s,o,a,u){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:u},this.fromBufferGeometry(new Dl(e,n,i,r,s,o,a,u)),this.mergeVertices()}}class fx extends tf{constructor(e,n,i,r,s,o,a){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}}class dx extends Dl{constructor(e,n,i,r,s,o,a){super(0,e,n,i,r,s,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}}class gs extends lt{constructor(e,n,i,r){super(),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r},i=i||1,r=r||0;const s=[],o=[];a(r),l(i),d(),this.setAttribute("position",new Ue(s,3)),this.setAttribute("normal",new Ue(s.slice(),3)),this.setAttribute("uv",new Ue(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(v){const E=new P,R=new P,p=new P;for(let A=0;A<n.length;A+=3)m(n[A+0],E),m(n[A+1],R),m(n[A+2],p),u(E,R,p,v)}function u(v,E,R,p){const A=p+1,O=[];for(let H=0;H<=A;H++){O[H]=[];const ne=v.clone().lerp(R,H/A),se=E.clone().lerp(R,H/A),B=A-H;for(let j=0;j<=B;j++)j===0&&H===A?O[H][j]=ne:O[H][j]=ne.clone().lerp(se,j/B)}for(let H=0;H<A;H++)for(let ne=0;ne<2*(A-H)-1;ne++){const se=Math.floor(ne/2);ne%2===0?(g(O[H][se+1]),g(O[H+1][se]),g(O[H][se])):(g(O[H][se+1]),g(O[H+1][se+1]),g(O[H+1][se]))}}function l(v){const E=new P;for(let R=0;R<s.length;R+=3)E.x=s[R+0],E.y=s[R+1],E.z=s[R+2],E.normalize().multiplyScalar(v),s[R+0]=E.x,s[R+1]=E.y,s[R+2]=E.z}function d(){const v=new P;for(let E=0;E<s.length;E+=3){v.x=s[E+0],v.y=s[E+1],v.z=s[E+2];const R=M(v)/2/Math.PI+.5,p=_(v)/Math.PI+.5;o.push(R,1-p)}y(),h()}function h(){for(let v=0;v<o.length;v+=6){const E=o[v+0],R=o[v+2],p=o[v+4],A=Math.max(E,R,p),O=Math.min(E,R,p);A>.9&&O<.1&&(E<.2&&(o[v+0]+=1),R<.2&&(o[v+2]+=1),p<.2&&(o[v+4]+=1))}}function g(v){s.push(v.x,v.y,v.z)}function m(v,E){const R=v*3;E.x=e[R+0],E.y=e[R+1],E.z=e[R+2]}function y(){const v=new P,E=new P,R=new P,p=new P,A=new oe,O=new oe,H=new oe;for(let ne=0,se=0;ne<s.length;ne+=9,se+=6){v.set(s[ne+0],s[ne+1],s[ne+2]),E.set(s[ne+3],s[ne+4],s[ne+5]),R.set(s[ne+6],s[ne+7],s[ne+8]),A.set(o[se+0],o[se+1]),O.set(o[se+2],o[se+3]),H.set(o[se+4],o[se+5]),p.copy(v).add(E).add(R).divideScalar(3);const B=M(p);w(A,se+0,v,B),w(O,se+2,E,B),w(H,se+4,R,B)}}function w(v,E,R,p){p<0&&v.x===1&&(o[E]=v.x-1),R.x===0&&R.z===0&&(o[E]=p/2/Math.PI+.5)}function M(v){return Math.atan2(v.z,-v.x)}function _(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}}class nf extends gs{constructor(e,n){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:n}}}class px extends Lt{constructor(e,n){super(),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new nf(e,n)),this.mergeVertices()}}const Ko=new P,ea=new P,Cc=new P,ta=new hn;class mx extends lt{constructor(e,n){super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:n},n=n!==void 0?n:1,e.isGeometry&&(e=new lt().fromGeometry(e));const r=Math.pow(10,4),s=Math.cos(at.DEG2RAD*n),o=e.getIndex(),a=e.getAttribute("position"),u=o?o.count:a.count,l=[0,0,0],d=["a","b","c"],h=new Array(3),g={},m=[];for(let y=0;y<u;y+=3){o?(l[0]=o.getX(y),l[1]=o.getX(y+1),l[2]=o.getX(y+2)):(l[0]=y,l[1]=y+1,l[2]=y+2);const{a:w,b:M,c:_}=ta;if(w.fromBufferAttribute(a,l[0]),M.fromBufferAttribute(a,l[1]),_.fromBufferAttribute(a,l[2]),ta.getNormal(Cc),h[0]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,h[1]=`${Math.round(M.x*r)},${Math.round(M.y*r)},${Math.round(M.z*r)}`,h[2]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let v=0;v<3;v++){const E=(v+1)%3,R=h[v],p=h[E],A=ta[d[v]],O=ta[d[E]],H=`${R}_${p}`,ne=`${p}_${R}`;ne in g&&g[ne]?(Cc.dot(g[ne].normal)<=s&&(m.push(A.x,A.y,A.z),m.push(O.x,O.y,O.z)),g[ne]=null):H in g||(g[H]={index0:l[v],index1:l[E],normal:Cc.clone()})}}for(const y in g)if(g[y]){const{index0:w,index1:M}=g[y];Ko.fromBufferAttribute(a,w),ea.fromBufferAttribute(a,M),m.push(Ko.x,Ko.y,Ko.z),m.push(ea.x,ea.y,ea.z)}this.setAttribute("position",new Ue(m,3))}}const gx={triangulate:function(t,e,n){n=n||2;const i=e&&e.length,r=i?e[0]*n:t.length;let s=rf(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,u,l,d,h,g,m;if(i&&(s=bx(t,e,s,n)),t.length>80*n){a=l=t[0],u=d=t[1];for(let y=n;y<r;y+=n)h=t[y],g=t[y+1],h<a&&(a=h),g<u&&(u=g),h>l&&(l=h),g>d&&(d=g);m=Math.max(l-a,d-u),m=m!==0?1/m:0}return $s(s,o,n,a,u,m),o}};function rf(t,e,n,i,r){let s,o;if(r===Dx(t,e,n,i)>0)for(s=e;s<n;s+=i)o=lh(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=lh(s,t[s],t[s+1],o);return o&&Ba(o,o.next)&&(Ks(o),o=o.next),o}function Qi(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(Ba(n,n.next)||Ut(n.prev,n,n.next)===0)){if(Ks(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function $s(t,e,n,i,r,s,o){if(!t)return;!o&&s&&Ex(t,i,r,s);let a=t,u,l;for(;t.prev!==t.next;){if(u=t.prev,l=t.next,s?vx(t,i,r,s):yx(t)){e.push(u.i/n),e.push(t.i/n),e.push(l.i/n),Ks(t),t=l.next,a=l.next;continue}if(t=l,t===a){o?o===1?(t=xx(Qi(t),e,n),$s(t,e,n,i,r,s,2)):o===2&&_x(t,e,n,i,r,s):$s(Qi(t),e,n,i,r,s,1);break}}}function yx(t){const e=t.prev,n=t,i=t.next;if(Ut(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(ts(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Ut(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function vx(t,e,n,i){const r=t.prev,s=t,o=t.next;if(Ut(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,u=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,l=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,d=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=tl(a,u,e,n,i),g=tl(l,d,e,n,i);let m=t.prevZ,y=t.nextZ;for(;m&&m.z>=h&&y&&y.z<=g;){if(m!==t.prev&&m!==t.next&&ts(r.x,r.y,s.x,s.y,o.x,o.y,m.x,m.y)&&Ut(m.prev,m,m.next)>=0||(m=m.prevZ,y!==t.prev&&y!==t.next&&ts(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&Ut(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;m&&m.z>=h;){if(m!==t.prev&&m!==t.next&&ts(r.x,r.y,s.x,s.y,o.x,o.y,m.x,m.y)&&Ut(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;y&&y.z<=g;){if(y!==t.prev&&y!==t.next&&ts(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&Ut(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function xx(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!Ba(r,s)&&sf(r,i,i.next,s)&&Qs(r,s)&&Qs(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),Ks(i),Ks(i.next),i=t=s),i=i.next}while(i!==t);return Qi(i)}function _x(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Cx(o,a)){let u=of(o,a);o=Qi(o,o.next),u=Qi(u,u.next),$s(o,e,n,i,r,s),$s(u,e,n,i,r,s);return}a=a.next}o=o.next}while(o!==t)}function bx(t,e,n,i){const r=[];let s,o,a,u,l;for(s=0,o=e.length;s<o;s++)a=e[s]*i,u=s<o-1?e[s+1]*i:t.length,l=rf(t,a,u,i,!1),l===l.next&&(l.steiner=!0),r.push(Lx(l));for(r.sort(wx),s=0;s<r.length;s++)Mx(r[s],n),n=Qi(n,n.next);return n}function wx(t,e){return t.x-e.x}function Mx(t,e){if(e=Sx(t,e),e){const n=of(e,t);Qi(e,e.next),Qi(n,n.next)}}function Sx(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,o;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const g=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(g<=i&&g>s){if(s=g,g===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(i===s)return o;const a=o,u=o.x,l=o.y;let d=1/0,h;n=o;do i>=n.x&&n.x>=u&&i!==n.x&&ts(r<l?i:s,r,u,l,r<l?s:i,r,n.x,n.y)&&(h=Math.abs(r-n.y)/(i-n.x),Qs(n,t)&&(h<d||h===d&&(n.x>o.x||n.x===o.x&&Tx(o,n)))&&(o=n,d=h)),n=n.next;while(n!==a);return o}function Tx(t,e){return Ut(t.prev,t,e.prev)<0&&Ut(e.next,t,t.next)<0}function Ex(t,e,n,i){let r=t;do r.z===null&&(r.z=tl(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Ax(r)}function Ax(t){let e,n,i,r,s,o,a,u,l=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ,!!i);e++);for(u=l;a>0||u>0&&i;)a!==0&&(u===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,u--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,l*=2}while(o>1);return t}function tl(t,e,n,i,r){return t=32767*(t-n)*r,e=32767*(e-i)*r,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Lx(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ts(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function Cx(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Rx(t,e)&&(Qs(t,e)&&Qs(e,t)&&Px(t,e)&&(Ut(t.prev,t,e.prev)||Ut(t,e.prev,e))||Ba(t,e)&&Ut(t.prev,t,t.next)>0&&Ut(e.prev,e,e.next)>0)}function Ut(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ba(t,e){return t.x===e.x&&t.y===e.y}function sf(t,e,n,i){const r=ia(Ut(t,e,n)),s=ia(Ut(t,e,i)),o=ia(Ut(n,i,t)),a=ia(Ut(n,i,e));return!!(r!==s&&o!==a||r===0&&na(t,n,e)||s===0&&na(t,i,e)||o===0&&na(n,t,i)||a===0&&na(n,e,i))}function na(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function ia(t){return t>0?1:t<0?-1:0}function Rx(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&sf(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Qs(t,e){return Ut(t.prev,t,t.next)<0?Ut(t,e,t.next)>=0&&Ut(t,t.prev,e)>=0:Ut(t,e,t.prev)<0||Ut(t,t.next,e)<0}function Px(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function of(t,e){const n=new nl(t.i,t.x,t.y),i=new nl(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function lh(t,e,n,i){const r=new nl(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ks(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function nl(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Dx(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}const Zi={area:function(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return n*.5},isClockWise:function(t){return Zi.area(t)<0},triangulateShape:function(t,e){const n=[],i=[],r=[];uh(t),hh(n,t);let s=t.length;e.forEach(uh);for(let a=0;a<e.length;a++)i.push(s),s+=e[a].length,hh(n,e[a]);const o=gx.triangulate(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}};function uh(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function hh(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Fa extends lt{constructor(e,n){super(),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,u=e.length;a<u;a++){const l=e[a];o(l)}this.setAttribute("position",new Ue(r,3)),this.setAttribute("uv",new Ue(s,2)),this.computeVertexNormals();function o(a){const u=[],l=n.curveSegments!==void 0?n.curveSegments:12,d=n.steps!==void 0?n.steps:1;let h=n.depth!==void 0?n.depth:100,g=n.bevelEnabled!==void 0?n.bevelEnabled:!0,m=n.bevelThickness!==void 0?n.bevelThickness:6,y=n.bevelSize!==void 0?n.bevelSize:m-2,w=n.bevelOffset!==void 0?n.bevelOffset:0,M=n.bevelSegments!==void 0?n.bevelSegments:3;const _=n.extrudePath,v=n.UVGenerator!==void 0?n.UVGenerator:Ix;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),h=n.amount);let E,R=!1,p,A,O,H;_&&(E=_.getSpacedPoints(d),R=!0,g=!1,p=_.computeFrenetFrames(d,!1),A=new P,O=new P,H=new P),g||(M=0,m=0,y=0,w=0);const ne=a.extractPoints(l);let se=ne.shape;const B=ne.holes;if(!Zi.isClockWise(se)){se=se.reverse();for(let me=0,ie=B.length;me<ie;me++){const _e=B[me];Zi.isClockWise(_e)&&(B[me]=_e.reverse())}}const Y=Zi.triangulateShape(se,B),Q=se;for(let me=0,ie=B.length;me<ie;me++){const _e=B[me];se=se.concat(_e)}function X(me,ie,_e){return ie||console.error("THREE.ExtrudeGeometry: vec does not exist"),ie.clone().multiplyScalar(_e).add(me)}const Z=se.length,le=Y.length;function de(me,ie,_e){let ke,Le,N;const D=me.x-ie.x,ve=me.y-ie.y,fe=_e.x-me.x,G=_e.y-me.y,ge=D*D+ve*ve,Ee=D*G-ve*fe;if(Math.abs(Ee)>Number.EPSILON){const Be=Math.sqrt(ge),Se=Math.sqrt(fe*fe+G*G),k=ie.x-ve/Be,xe=ie.y+D/Be,Pe=_e.x-G/Se,Me=_e.y+fe/Se,ze=((Pe-k)*G-(Me-xe)*fe)/(D*G-ve*fe);ke=k+D*ze-me.x,Le=xe+ve*ze-me.y;const gt=ke*ke+Le*Le;if(gt<=2)return new oe(ke,Le);N=Math.sqrt(gt/2)}else{let Be=!1;D>Number.EPSILON?fe>Number.EPSILON&&(Be=!0):D<-Number.EPSILON?fe<-Number.EPSILON&&(Be=!0):Math.sign(ve)===Math.sign(G)&&(Be=!0),Be?(ke=-ve,Le=D,N=Math.sqrt(ge)):(ke=D,Le=ve,N=Math.sqrt(ge/2))}return new oe(ke/N,Le/N)}const we=[];for(let me=0,ie=Q.length,_e=ie-1,ke=me+1;me<ie;me++,_e++,ke++)_e===ie&&(_e=0),ke===ie&&(ke=0),we[me]=de(Q[me],Q[_e],Q[ke]);const Ne=[];let Re,Je=we.concat();for(let me=0,ie=B.length;me<ie;me++){const _e=B[me];Re=[];for(let ke=0,Le=_e.length,N=Le-1,D=ke+1;ke<Le;ke++,N++,D++)N===Le&&(N=0),D===Le&&(D=0),Re[ke]=de(_e[ke],_e[N],_e[D]);Ne.push(Re),Je=Je.concat(Re)}for(let me=0;me<M;me++){const ie=me/M,_e=m*Math.cos(ie*Math.PI/2),ke=y*Math.sin(ie*Math.PI/2)+w;for(let Le=0,N=Q.length;Le<N;Le++){const D=X(Q[Le],we[Le],ke);We(D.x,D.y,-_e)}for(let Le=0,N=B.length;Le<N;Le++){const D=B[Le];Re=Ne[Le];for(let ve=0,fe=D.length;ve<fe;ve++){const G=X(D[ve],Re[ve],ke);We(G.x,G.y,-_e)}}}const tt=y+w;for(let me=0;me<Z;me++){const ie=g?X(se[me],Je[me],tt):se[me];R?(O.copy(p.normals[0]).multiplyScalar(ie.x),A.copy(p.binormals[0]).multiplyScalar(ie.y),H.copy(E[0]).add(O).add(A),We(H.x,H.y,H.z)):We(ie.x,ie.y,0)}for(let me=1;me<=d;me++)for(let ie=0;ie<Z;ie++){const _e=g?X(se[ie],Je[ie],tt):se[ie];R?(O.copy(p.normals[me]).multiplyScalar(_e.x),A.copy(p.binormals[me]).multiplyScalar(_e.y),H.copy(E[me]).add(O).add(A),We(H.x,H.y,H.z)):We(_e.x,_e.y,h/d*me)}for(let me=M-1;me>=0;me--){const ie=me/M,_e=m*Math.cos(ie*Math.PI/2),ke=y*Math.sin(ie*Math.PI/2)+w;for(let Le=0,N=Q.length;Le<N;Le++){const D=X(Q[Le],we[Le],ke);We(D.x,D.y,h+_e)}for(let Le=0,N=B.length;Le<N;Le++){const D=B[Le];Re=Ne[Le];for(let ve=0,fe=D.length;ve<fe;ve++){const G=X(D[ve],Re[ve],ke);R?We(G.x,G.y+E[d-1].y,E[d-1].x+_e):We(G.x,G.y,h+_e)}}}_t(),ue();function _t(){const me=r.length/3;if(g){let ie=0,_e=Z*ie;for(let ke=0;ke<le;ke++){const Le=Y[ke];ft(Le[2]+_e,Le[1]+_e,Le[0]+_e)}ie=d+M*2,_e=Z*ie;for(let ke=0;ke<le;ke++){const Le=Y[ke];ft(Le[0]+_e,Le[1]+_e,Le[2]+_e)}}else{for(let ie=0;ie<le;ie++){const _e=Y[ie];ft(_e[2],_e[1],_e[0])}for(let ie=0;ie<le;ie++){const _e=Y[ie];ft(_e[0]+Z*d,_e[1]+Z*d,_e[2]+Z*d)}}i.addGroup(me,r.length/3-me,0)}function ue(){const me=r.length/3;let ie=0;bt(Q,ie),ie+=Q.length;for(let _e=0,ke=B.length;_e<ke;_e++){const Le=B[_e];bt(Le,ie),ie+=Le.length}i.addGroup(me,r.length/3-me,1)}function bt(me,ie){let _e=me.length;for(;--_e>=0;){const ke=_e;let Le=_e-1;Le<0&&(Le=me.length-1);for(let N=0,D=d+M*2;N<D;N++){const ve=Z*N,fe=Z*(N+1),G=ie+ke+ve,ge=ie+Le+ve,Ee=ie+Le+fe,Be=ie+ke+fe;Ke(G,ge,Ee,Be)}}}function We(me,ie,_e){u.push(me),u.push(ie),u.push(_e)}function ft(me,ie,_e){it(me),it(ie),it(_e);const ke=r.length/3,Le=v.generateTopUV(i,r,ke-3,ke-2,ke-1);Ze(Le[0]),Ze(Le[1]),Ze(Le[2])}function Ke(me,ie,_e,ke){it(me),it(ie),it(ke),it(ie),it(_e),it(ke);const Le=r.length/3,N=v.generateSideWallUV(i,r,Le-6,Le-3,Le-2,Le-1);Ze(N[0]),Ze(N[1]),Ze(N[3]),Ze(N[1]),Ze(N[2]),Ze(N[3])}function it(me){r.push(u[me*3+0]),r.push(u[me*3+1]),r.push(u[me*3+2])}function Ze(me){s.push(me.x),s.push(me.y)}}}toJSON(){const e=lt.prototype.toJSON.call(this),n=this.parameters.shapes,i=this.parameters.options;return Nx(n,i,e)}}const Ix={generateTopUV:function(t,e,n,i,r){const s=e[n*3],o=e[n*3+1],a=e[i*3],u=e[i*3+1],l=e[r*3],d=e[r*3+1];return[new oe(s,o),new oe(a,u),new oe(l,d)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[n*3],a=e[n*3+1],u=e[n*3+2],l=e[i*3],d=e[i*3+1],h=e[i*3+2],g=e[r*3],m=e[r*3+1],y=e[r*3+2],w=e[s*3],M=e[s*3+1],_=e[s*3+2];return Math.abs(a-d)<.01?[new oe(o,1-u),new oe(l,1-h),new oe(g,1-y),new oe(w,1-_)]:[new oe(a,1-u),new oe(d,1-h),new oe(m,1-y),new oe(M,1-_)]}};function Nx(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class af extends Lt{constructor(e,n){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},this.fromBufferGeometry(new Fa(e,n)),this.mergeVertices()}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return Ox(n,i,e)}}function Ox(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class cf extends gs{constructor(e,n){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:n}}}class Bx extends Lt{constructor(e,n){super(),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new cf(e,n)),this.mergeVertices()}}class lf extends lt{constructor(e,n,i,r){super(),this.type="LatheBufferGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n)||12,i=i||0,r=r||Math.PI*2,r=at.clamp(r,0,Math.PI*2);const s=[],o=[],a=[],u=1/n,l=new P,d=new oe;for(let h=0;h<=n;h++){const g=i+h*u*r,m=Math.sin(g),y=Math.cos(g);for(let w=0;w<=e.length-1;w++)l.x=e[w].x*m,l.y=e[w].y,l.z=e[w].x*y,o.push(l.x,l.y,l.z),d.x=h/n,d.y=w/(e.length-1),a.push(d.x,d.y)}for(let h=0;h<n;h++)for(let g=0;g<e.length-1;g++){const m=g+h*e.length,y=m,w=m+e.length,M=m+e.length+1,_=m+1;s.push(y,w,_),s.push(w,M,_)}if(this.setIndex(s),this.setAttribute("position",new Ue(o,3)),this.setAttribute("uv",new Ue(a,2)),this.computeVertexNormals(),r===Math.PI*2){const h=this.attributes.normal.array,g=new P,m=new P,y=new P,w=n*e.length*3;for(let M=0,_=0;M<e.length;M++,_+=3)g.x=h[_+0],g.y=h[_+1],g.z=h[_+2],m.x=h[w+_+0],m.y=h[w+_+1],m.z=h[w+_+2],y.addVectors(g,m).normalize(),h[_+0]=h[w+_+0]=y.x,h[_+1]=h[w+_+1]=y.y,h[_+2]=h[w+_+2]=y.z}}}class Fx extends Lt{constructor(e,n,i,r){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},this.fromBufferGeometry(new lf(e,n,i,r)),this.mergeVertices()}}class uf extends gs{constructor(e,n){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:n}}}class zx extends Lt{constructor(e,n){super(),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new uf(e,n)),this.mergeVertices()}}function eo(t,e,n){lt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};const i=[],r=[],s=[],o=[],a=1e-5,u=new P,l=new P,d=new P,h=new P,g=new P;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const m=e+1;for(let y=0;y<=n;y++){const w=y/n;for(let M=0;M<=e;M++){const _=M/e;t(_,w,l),r.push(l.x,l.y,l.z),_-a>=0?(t(_-a,w,d),h.subVectors(l,d)):(t(_+a,w,d),h.subVectors(d,l)),w-a>=0?(t(_,w-a,d),g.subVectors(l,d)):(t(_,w+a,d),g.subVectors(d,l)),u.crossVectors(h,g).normalize(),s.push(u.x,u.y,u.z),o.push(_,w)}}for(let y=0;y<n;y++)for(let w=0;w<e;w++){const M=y*m+w,_=y*m+w+1,v=(y+1)*m+w+1,E=(y+1)*m+w;i.push(M,_,E),i.push(_,v,E)}this.setIndex(i),this.setAttribute("position",new Ue(r,3)),this.setAttribute("normal",new Ue(s,3)),this.setAttribute("uv",new Ue(o,2))}eo.prototype=Object.create(lt.prototype);eo.prototype.constructor=eo;function _a(t,e,n){Lt.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new eo(t,e,n)),this.mergeVertices()}_a.prototype=Object.create(Lt.prototype);_a.prototype.constructor=_a;class kx extends Lt{constructor(e,n,i,r){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r},this.fromBufferGeometry(new Ll(e,n,i,r)),this.mergeVertices()}}class Ux extends Lt{constructor(e,n,i,r){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r},this.fromBufferGeometry(new gs(e,n,i,r)),this.mergeVertices()}}class hf extends lt{constructor(e,n,i,r,s,o){super(),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},e=e||.5,n=n||1,s=s!==void 0?s:0,o=o!==void 0?o:Math.PI*2,i=i!==void 0?Math.max(3,i):8,r=r!==void 0?Math.max(1,r):1;const a=[],u=[],l=[],d=[];let h=e;const g=(n-e)/r,m=new P,y=new oe;for(let w=0;w<=r;w++){for(let M=0;M<=i;M++){const _=s+M/i*o;m.x=h*Math.cos(_),m.y=h*Math.sin(_),u.push(m.x,m.y,m.z),l.push(0,0,1),y.x=(m.x/n+1)/2,y.y=(m.y/n+1)/2,d.push(y.x,y.y)}h+=g}for(let w=0;w<r;w++){const M=w*(i+1);for(let _=0;_<i;_++){const v=_+M,E=v,R=v+i+1,p=v+i+2,A=v+1;a.push(E,R,A),a.push(R,p,A)}}this.setIndex(a),this.setAttribute("position",new Ue(u,3)),this.setAttribute("normal",new Ue(l,3)),this.setAttribute("uv",new Ue(d,2))}}class Gx extends Lt{constructor(e,n,i,r,s,o){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},this.fromBufferGeometry(new hf(e,n,i,r,s,o)),this.mergeVertices()}}class ff extends lt{constructor(e,n){super(),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:n},n=n||12;const i=[],r=[],s=[],o=[];let a=0,u=0;if(Array.isArray(e)===!1)l(e);else for(let d=0;d<e.length;d++)l(e[d]),this.addGroup(a,u,d),a+=u,u=0;this.setIndex(i),this.setAttribute("position",new Ue(r,3)),this.setAttribute("normal",new Ue(s,3)),this.setAttribute("uv",new Ue(o,2));function l(d){const h=r.length/3,g=d.extractPoints(n);let m=g.shape;const y=g.holes;Zi.isClockWise(m)===!1&&(m=m.reverse());for(let M=0,_=y.length;M<_;M++){const v=y[M];Zi.isClockWise(v)===!0&&(y[M]=v.reverse())}const w=Zi.triangulateShape(m,y);for(let M=0,_=y.length;M<_;M++){const v=y[M];m=m.concat(v)}for(let M=0,_=m.length;M<_;M++){const v=m[M];r.push(v.x,v.y,0),s.push(0,0,1),o.push(v.x,v.y)}for(let M=0,_=w.length;M<_;M++){const v=w[M],E=v[0]+h,R=v[1]+h,p=v[2]+h;i.push(E,R,p),u+=3}}}toJSON(){const e=lt.prototype.toJSON.call(this),n=this.parameters.shapes;return Hx(n,e)}}function Hx(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class df extends Lt{constructor(e,n){super(),this.type="ShapeGeometry",typeof n=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),this.parameters={shapes:e,curveSegments:n},this.fromBufferGeometry(new ff(e,n)),this.mergeVertices()}toJSON(){const e=Lt.prototype.toJSON.call(this),n=this.parameters.shapes;return Vx(n,e)}}function Vx(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class pf extends lt{constructor(e,n,i,r,s,o,a){super(),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},e=e||1,n=Math.max(3,Math.floor(n)||8),i=Math.max(2,Math.floor(i)||6),r=r!==void 0?r:0,s=s!==void 0?s:Math.PI*2,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI;const u=Math.min(o+a,Math.PI);let l=0;const d=[],h=new P,g=new P,m=[],y=[],w=[],M=[];for(let _=0;_<=i;_++){const v=[],E=_/i;let R=0;_==0&&o==0?R=.5/n:_==i&&u==Math.PI&&(R=-.5/n);for(let p=0;p<=n;p++){const A=p/n;h.x=-e*Math.cos(r+A*s)*Math.sin(o+E*a),h.y=e*Math.cos(o+E*a),h.z=e*Math.sin(r+A*s)*Math.sin(o+E*a),y.push(h.x,h.y,h.z),g.copy(h).normalize(),w.push(g.x,g.y,g.z),M.push(A+R,1-E),v.push(l++)}d.push(v)}for(let _=0;_<i;_++)for(let v=0;v<n;v++){const E=d[_][v+1],R=d[_][v],p=d[_+1][v],A=d[_+1][v+1];(_!==0||o>0)&&m.push(E,R,A),(_!==i-1||u<Math.PI)&&m.push(R,p,A)}this.setIndex(m),this.setAttribute("position",new Ue(y,3)),this.setAttribute("normal",new Ue(w,3)),this.setAttribute("uv",new Ue(M,2))}}class Wx extends Lt{constructor(e,n,i,r,s,o,a){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new pf(e,n,i,r,s,o,a)),this.mergeVertices()}}class mf extends gs{constructor(e,n){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:n}}}class jx extends Lt{constructor(e,n){super(),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new mf(e,n)),this.mergeVertices()}}class gf extends Fa{constructor(e,n){n=n||{};const i=n.font;if(!(i&&i.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new lt;const r=i.generateShapes(e,n.size);n.depth=n.height!==void 0?n.height:50,n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),super(r,n),this.type="TextBufferGeometry"}}class qx extends Lt{constructor(e,n){super(),this.type="TextGeometry",this.parameters={text:e,parameters:n},this.fromBufferGeometry(new gf(e,n)),this.mergeVertices()}}class yf extends lt{constructor(e,n,i,r,s){super(),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},e=e||1,n=n||.4,i=Math.floor(i)||8,r=Math.floor(r)||6,s=s||Math.PI*2;const o=[],a=[],u=[],l=[],d=new P,h=new P,g=new P;for(let m=0;m<=i;m++)for(let y=0;y<=r;y++){const w=y/r*s,M=m/i*Math.PI*2;h.x=(e+n*Math.cos(M))*Math.cos(w),h.y=(e+n*Math.cos(M))*Math.sin(w),h.z=n*Math.sin(M),a.push(h.x,h.y,h.z),d.x=e*Math.cos(w),d.y=e*Math.sin(w),g.subVectors(h,d).normalize(),u.push(g.x,g.y,g.z),l.push(y/r),l.push(m/i)}for(let m=1;m<=i;m++)for(let y=1;y<=r;y++){const w=(r+1)*m+y-1,M=(r+1)*(m-1)+y-1,_=(r+1)*(m-1)+y,v=(r+1)*m+y;o.push(w,M,v),o.push(M,_,v)}this.setIndex(o),this.setAttribute("position",new Ue(a,3)),this.setAttribute("normal",new Ue(u,3)),this.setAttribute("uv",new Ue(l,2))}}class Xx extends Lt{constructor(e,n,i,r,s){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},this.fromBufferGeometry(new yf(e,n,i,r,s)),this.mergeVertices()}}class vf extends lt{constructor(e,n,i,r,s,o){super(),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},e=e||1,n=n||.4,i=Math.floor(i)||64,r=Math.floor(r)||8,s=s||2,o=o||3;const a=[],u=[],l=[],d=[],h=new P,g=new P,m=new P,y=new P,w=new P,M=new P,_=new P;for(let E=0;E<=i;++E){const R=E/i*s*Math.PI*2;v(R,s,o,e,m),v(R+.01,s,o,e,y),M.subVectors(y,m),_.addVectors(y,m),w.crossVectors(M,_),_.crossVectors(w,M),w.normalize(),_.normalize();for(let p=0;p<=r;++p){const A=p/r*Math.PI*2,O=-n*Math.cos(A),H=n*Math.sin(A);h.x=m.x+(O*_.x+H*w.x),h.y=m.y+(O*_.y+H*w.y),h.z=m.z+(O*_.z+H*w.z),u.push(h.x,h.y,h.z),g.subVectors(h,m).normalize(),l.push(g.x,g.y,g.z),d.push(E/i),d.push(p/r)}}for(let E=1;E<=i;E++)for(let R=1;R<=r;R++){const p=(r+1)*(E-1)+(R-1),A=(r+1)*E+(R-1),O=(r+1)*E+R,H=(r+1)*(E-1)+R;a.push(p,A,H),a.push(A,O,H)}this.setIndex(a),this.setAttribute("position",new Ue(u,3)),this.setAttribute("normal",new Ue(l,3)),this.setAttribute("uv",new Ue(d,2));function v(E,R,p,A,O){const H=Math.cos(E),ne=Math.sin(E),se=p/R*E,B=Math.cos(se);O.x=A*(2+B)*.5*H,O.y=A*(2+B)*ne*.5,O.z=A*Math.sin(se)*.5}}}class Yx extends Lt{constructor(e,n,i,r,s,o,a){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},a!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new vf(e,n,i,r,s,o)),this.mergeVertices()}}class xf extends lt{constructor(e,n,i,r,s){super(),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s},n=n||64,i=i||1,r=r||8,s=s||!1;const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new P,u=new P,l=new oe;let d=new P;const h=[],g=[],m=[],y=[];w(),this.setIndex(y),this.setAttribute("position",new Ue(h,3)),this.setAttribute("normal",new Ue(g,3)),this.setAttribute("uv",new Ue(m,2));function w(){for(let E=0;E<n;E++)M(E);M(s===!1?n:0),v(),_()}function M(E){d=e.getPointAt(E/n,d);const R=o.normals[E],p=o.binormals[E];for(let A=0;A<=r;A++){const O=A/r*Math.PI*2,H=Math.sin(O),ne=-Math.cos(O);u.x=ne*R.x+H*p.x,u.y=ne*R.y+H*p.y,u.z=ne*R.z+H*p.z,u.normalize(),g.push(u.x,u.y,u.z),a.x=d.x+i*u.x,a.y=d.y+i*u.y,a.z=d.z+i*u.z,h.push(a.x,a.y,a.z)}}function _(){for(let E=1;E<=n;E++)for(let R=1;R<=r;R++){const p=(r+1)*(E-1)+(R-1),A=(r+1)*E+(R-1),O=(r+1)*E+R,H=(r+1)*(E-1)+R;y.push(p,A,H),y.push(A,O,H)}}function v(){for(let E=0;E<=n;E++)for(let R=0;R<=r;R++)l.x=E/n,l.y=R/r,m.push(l.x,l.y)}}toJSON(){const e=lt.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e}}class Zx extends Lt{constructor(e,n,i,r,s,o){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s},o!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");const a=new xf(e,n,i,r,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}}class Jx extends lt{constructor(e){super(),this.type="WireframeGeometry";const n=[],i=[0,0],r={},s=["a","b","c"];if(e&&e.isGeometry){const o=e.faces;for(let a=0,u=o.length;a<u;a++){const l=o[a];for(let d=0;d<3;d++){const h=l[s[d]],g=l[s[(d+1)%3]];i[0]=Math.min(h,g),i[1]=Math.max(h,g);const m=i[0]+","+i[1];r[m]===void 0&&(r[m]={index1:i[0],index2:i[1]})}}for(const a in r){const u=r[a];let l=e.vertices[u.index1];n.push(l.x,l.y,l.z),l=e.vertices[u.index2],n.push(l.x,l.y,l.z)}}else if(e&&e.isBufferGeometry){const o=new P;if(e.index!==null){const a=e.attributes.position,u=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:u.count,materialIndex:0}]);for(let d=0,h=l.length;d<h;++d){const g=l[d],m=g.start,y=g.count;for(let w=m,M=m+y;w<M;w+=3)for(let _=0;_<3;_++){const v=u.getX(w+_),E=u.getX(w+(_+1)%3);i[0]=Math.min(v,E),i[1]=Math.max(v,E);const R=i[0]+","+i[1];r[R]===void 0&&(r[R]={index1:i[0],index2:i[1]})}}for(const d in r){const h=r[d];o.fromBufferAttribute(a,h.index1),n.push(o.x,o.y,o.z),o.fromBufferAttribute(a,h.index2),n.push(o.x,o.y,o.z)}}else{const a=e.attributes.position;for(let u=0,l=a.count/3;u<l;u++)for(let d=0;d<3;d++){const h=3*u+d;o.fromBufferAttribute(a,h),n.push(o.x,o.y,o.z);const g=3*u+(d+1)%3;o.fromBufferAttribute(a,g),n.push(o.x,o.y,o.z)}}}this.setAttribute("position",new Ue(n,3))}}var pn=Object.freeze({__proto__:null,BoxGeometry:ux,BoxBufferGeometry:Na,CircleGeometry:hx,CircleBufferGeometry:ef,ConeGeometry:fx,ConeBufferGeometry:dx,CylinderGeometry:tf,CylinderBufferGeometry:Dl,DodecahedronGeometry:px,DodecahedronBufferGeometry:nf,EdgesGeometry:mx,ExtrudeGeometry:af,ExtrudeBufferGeometry:Fa,IcosahedronGeometry:Bx,IcosahedronBufferGeometry:cf,LatheGeometry:Fx,LatheBufferGeometry:lf,OctahedronGeometry:zx,OctahedronBufferGeometry:uf,ParametricGeometry:_a,ParametricBufferGeometry:eo,PlaneGeometry:kx,PlaneBufferGeometry:Ll,PolyhedronGeometry:Ux,PolyhedronBufferGeometry:gs,RingGeometry:Gx,RingBufferGeometry:hf,ShapeGeometry:df,ShapeBufferGeometry:ff,SphereGeometry:Wx,SphereBufferGeometry:pf,TetrahedronGeometry:jx,TetrahedronBufferGeometry:mf,TextGeometry:qx,TextBufferGeometry:gf,TorusGeometry:Xx,TorusBufferGeometry:yf,TorusKnotGeometry:Yx,TorusKnotBufferGeometry:vf,TubeGeometry:Zx,TubeBufferGeometry:xf,WireframeGeometry:Jx});function as(t){Ye.call(this),this.type="ShadowMaterial",this.color=new He(0),this.transparent=!0,this.setValues(t)}as.prototype=Object.create(Ye.prototype);as.prototype.constructor=as;as.prototype.isShadowMaterial=!0;as.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this};function to(t){bn.call(this,t),this.type="RawShaderMaterial"}to.prototype=Object.create(bn.prototype);to.prototype.constructor=to;to.prototype.isRawShaderMaterial=!0;function Ci(t){Ye.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new He(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ps,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}Ci.prototype=Object.create(Ye.prototype);Ci.prototype.constructor=Ci;Ci.prototype.isMeshStandardMaterial=!0;Ci.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this};function Mr(t){Ci.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new oe(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=at.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}Mr.prototype=Object.create(Ci.prototype);Mr.prototype.constructor=Mr;Mr.prototype.isMeshPhysicalMaterial=!0;Mr.prototype.copy=function(t){return Ci.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new He).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this};function Sr(t){Ye.call(this),this.type="MeshPhongMaterial",this.color=new He(16777215),this.specular=new He(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ps,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=La,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}Sr.prototype=Object.create(Ye.prototype);Sr.prototype.constructor=Sr;Sr.prototype.isMeshPhongMaterial=!0;Sr.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function cs(t){Ye.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new He(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ps,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}cs.prototype=Object.create(Ye.prototype);cs.prototype.constructor=cs;cs.prototype.isMeshToonMaterial=!0;cs.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function ls(t){Ye.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ps,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}ls.prototype=Object.create(Ye.prototype);ls.prototype.constructor=ls;ls.prototype.isMeshNormalMaterial=!0;ls.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function us(t){Ye.call(this),this.type="MeshLambertMaterial",this.color=new He(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new He(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=La,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}us.prototype=Object.create(Ye.prototype);us.prototype.constructor=us;us.prototype.isMeshLambertMaterial=!0;us.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function hs(t){Ye.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new He(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ps,this.normalScale=new oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}hs.prototype=Object.create(Ye.prototype);hs.prototype.constructor=hs;hs.prototype.isMeshMatcapMaterial=!0;hs.prototype.copy=function(t){return Ye.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this};function fs(t){zn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}fs.prototype=Object.create(zn.prototype);fs.prototype.constructor=fs;fs.prototype.isLineDashedMaterial=!0;fs.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var $x=Object.freeze({__proto__:null,ShadowMaterial:as,SpriteMaterial:_r,RawShaderMaterial:to,ShaderMaterial:bn,PointsMaterial:wr,MeshPhysicalMaterial:Mr,MeshStandardMaterial:Ci,MeshPhongMaterial:Sr,MeshToonMaterial:cs,MeshNormalMaterial:ls,MeshLambertMaterial:us,MeshDepthMaterial:yr,MeshDistanceMaterial:vr,MeshBasicMaterial:mr,MeshMatcapMaterial:hs,LineDashedMaterial:fs,LineBasicMaterial:zn,Material:Ye});const Bt={arraySlice:function(t,e,n){return Bt.isTypedArray(t)?new t.constructor(t.subarray(e,n!==void 0?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const a=n[s]*e;for(let u=0;u!==e;++u)r[o++]=t[a+u]}return r},flattenJSON:function(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push.apply(n,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)},subclip:function(t,e,n,i,r){r=r||30;const s=t.clone();s.name=e;const o=[];for(let u=0;u<s.tracks.length;++u){const l=s.tracks[u],d=l.getValueSize(),h=[],g=[];for(let m=0;m<l.times.length;++m){const y=l.times[m]*r;if(!(y<n||y>=i)){h.push(l.times[m]);for(let w=0;w<d;++w)g.push(l.values[m*d+w])}}h.length!==0&&(l.times=Bt.convertArray(h,l.times.constructor),l.values=Bt.convertArray(g,l.values.constructor),o.push(l))}s.tracks=o;let a=1/0;for(let u=0;u<s.tracks.length;++u)a>s.tracks[u].times[0]&&(a=s.tracks[u].times[0]);for(let u=0;u<s.tracks.length;++u)s.tracks[u].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(t,e,n,i){e===void 0&&(e=0),n===void 0&&(n=t),(i===void 0||i<=0)&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=n.tracks[o],u=a.ValueTypeName;if(u==="bool"||u==="string")continue;const l=t.tracks.find(function(_){return _.name===a.name&&_.ValueTypeName===u});if(l===void 0)continue;let d=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=h/3);let g=0;const m=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=m/3);const y=a.times.length-1;let w;if(s<=a.times[0]){const _=d,v=h-d;w=Bt.arraySlice(a.values,_,v)}else if(s>=a.times[y]){const _=y*h+d,v=_+h-d;w=Bt.arraySlice(a.values,_,v)}else{const _=a.createInterpolant(),v=d,E=h-d;_.evaluate(s),w=Bt.arraySlice(_.resultBuffer,v,E)}u==="quaternion"&&new mn().fromArray(w).normalize().conjugate().toArray(w);const M=l.times.length;for(let _=0;_<M;++_){const v=_*m+g;if(u==="quaternion")mn.multiplyQuaternionsFlat(l.values,v,w,0,l.values,v);else{const E=m-g*2;for(let R=0;R<E;++R)l.values[v+R]-=w[R]}}}return t.blendMode=Fh,t}};function Bn(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}Object.assign(Bn.prototype,{evaluate:function(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];e:{t:{let s;n:{i:if(!(t<i)){for(let o=n+2;;){if(i===void 0){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===o)break;if(r=i,i=e[++n],t<i)break t}s=e.length;break n}if(!(t>=r)){const o=e[1];t<o&&(n=2,r=o);for(let a=n-2;;){if(r===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===a)break;if(i=r,r=e[--n-1],t>=r)break t}s=n,n=0;break n}break e}for(;n<s;){const o=n+s>>>1;t<e[o]?s=o:n=o+1}if(i=e[n],r=e[n-1],r===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(i===void 0)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let s=0;s!==i;++s)e[s]=n[r+s];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});Object.assign(Bn.prototype,{beforeStart_:Bn.prototype.copySampleValue_,afterEnd_:Bn.prototype.copySampleValue_});function il(t,e,n,i){Bn.call(this,t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}il.prototype=Object.assign(Object.create(Bn.prototype),{constructor:il,DefaultSettings_:{endingStart:Jr,endingEnd:Jr},intervalChanged_:function(t,e,n){const i=this.parameterPositions;let r=t-2,s=t+1,o=i[r],a=i[s];if(o===void 0)switch(this.getSettings_().endingStart){case $r:r=t,o=2*e-n;break;case ga:r=i.length-2,o=e+i[r]-i[r+1];break;default:r=t,o=n}if(a===void 0)switch(this.getSettings_().endingEnd){case $r:s=t,a=2*n-e;break;case ga:s=1,a=n+i[1]-i[0];break;default:s=t-1,a=e}const u=(n-e)*.5,l=this.valueSize;this._weightPrev=u/(e-o),this._weightNext=u/(a-n),this._offsetPrev=r*l,this._offsetNext=s*l},interpolate_:function(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,u=a-o,l=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,g=this._weightNext,m=(n-e)/(i-e),y=m*m,w=y*m,M=-h*w+2*h*y-h*m,_=(1+h)*w+(-1.5-2*h)*y+(-.5+h)*m+1,v=(-1-g)*w+(1.5+g)*y+.5*m,E=g*w-g*y;for(let R=0;R!==o;++R)r[R]=M*s[l+R]+_*s[u+R]+v*s[a+R]+E*s[d+R];return r}});function ba(t,e,n,i){Bn.call(this,t,e,n,i)}ba.prototype=Object.assign(Object.create(Bn.prototype),{constructor:ba,interpolate_:function(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,u=a-o,l=(n-e)/(i-e),d=1-l;for(let h=0;h!==o;++h)r[h]=s[u+h]*d+s[a+h]*l;return r}});function rl(t,e,n,i){Bn.call(this,t,e,n,i)}rl.prototype=Object.assign(Object.create(Bn.prototype),{constructor:rl,interpolate_:function(t){return this.copySampleValue_(t-1)}});function fn(t,e,n,i){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Bt.convertArray(e,this.TimeBufferType),this.values=Bt.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}Object.assign(fn,{toJSON:function(t){const e=t.constructor;let n;if(e.toJSON!==void 0)n=e.toJSON(t);else{n={name:t.name,times:Bt.convertArray(t.times,Array),values:Bt.convertArray(t.values,Array)};const i=t.getInterpolation();i!==t.DefaultInterpolation&&(n.interpolation=i)}return n.type=t.ValueTypeName,n}});Object.assign(fn.prototype,{constructor:fn,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:la,InterpolantFactoryMethodDiscrete:function(t){return new rl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new ba(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new il(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let e;switch(t){case ma:e=this.InterpolantFactoryMethodDiscrete;break;case la:e=this.InterpolantFactoryMethodLinear;break;case rc:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ma;case this.InterpolantFactoryMethodLinear:return la;case this.InterpolantFactoryMethodSmooth:return rc}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this},scale:function(t){if(t!==1){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this},trim:function(t,e){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;s!==-1&&n[s]>e;)--s;if(++s,r!==0||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const o=this.getValueSize();this.times=Bt.arraySlice(n,r,s),this.values=Bt.arraySlice(this.values,r*o,s*o)}return this},validate:function(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==r;o++){const a=n[o];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(s!==null&&s>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,s),t=!1;break}s=a}if(i!==void 0&&Bt.isTypedArray(i))for(let o=0,a=i.length;o!==a;++o){const u=i[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),t=!1;break}}return t},optimize:function(){const t=Bt.arraySlice(this.times),e=Bt.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===rc,r=t.length-1;let s=1;for(let o=1;o<r;++o){let a=!1;const u=t[o],l=t[o+1];if(u!==l&&(o!==1||u!==u[0]))if(i)a=!0;else{const d=o*n,h=d-n,g=d+n;for(let m=0;m!==n;++m){const y=e[d+m];if(y!==e[h+m]||y!==e[g+m]){a=!0;break}}}if(a){if(o!==s){t[s]=t[o];const d=o*n,h=s*n;for(let g=0;g!==n;++g)e[h+g]=e[d+g]}++s}}if(r>0){t[s]=t[r];for(let o=r*n,a=s*n,u=0;u!==n;++u)e[a+u]=e[o+u];++s}return s!==t.length?(this.times=Bt.arraySlice(t,0,s),this.values=Bt.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this},clone:function(){const t=Bt.arraySlice(this.times,0),e=Bt.arraySlice(this.values,0),n=this.constructor,i=new n(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}});function sl(t,e,n){fn.call(this,t,e,n)}sl.prototype=Object.assign(Object.create(fn.prototype),{constructor:sl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ma,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function ol(t,e,n,i){fn.call(this,t,e,n,i)}ol.prototype=Object.assign(Object.create(fn.prototype),{constructor:ol,ValueTypeName:"color"});function no(t,e,n,i){fn.call(this,t,e,n,i)}no.prototype=Object.assign(Object.create(fn.prototype),{constructor:no,ValueTypeName:"number"});function al(t,e,n,i){Bn.call(this,t,e,n,i)}al.prototype=Object.assign(Object.create(Bn.prototype),{constructor:al,interpolate_:function(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-e)/(i-e);let u=t*o;for(let l=u+o;u!==l;u+=4)mn.slerpFlat(r,0,s,u-o,s,u,a);return r}});function wa(t,e,n,i){fn.call(this,t,e,n,i)}wa.prototype=Object.assign(Object.create(fn.prototype),{constructor:wa,ValueTypeName:"quaternion",DefaultInterpolation:la,InterpolantFactoryMethodLinear:function(t){return new al(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0});function cl(t,e,n,i){fn.call(this,t,e,n,i)}cl.prototype=Object.assign(Object.create(fn.prototype),{constructor:cl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ma,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function io(t,e,n,i){fn.call(this,t,e,n,i)}io.prototype=Object.assign(Object.create(fn.prototype),{constructor:io,ValueTypeName:"vector"});function Jn(t,e,n,i){this.name=t,this.tracks=n,this.duration=e!==void 0?e:-1,this.blendMode=i!==void 0?i:Al,this.uuid=at.generateUUID(),this.duration<0&&this.resetDuration()}function Qx(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return no;case"vector":case"vector2":case"vector3":case"vector4":return io;case"color":return ol;case"quaternion":return wa;case"bool":case"boolean":return sl;case"string":return cl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Kx(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Qx(t.type);if(t.times===void 0){const n=[],i=[];Bt.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Jn,{parse:function(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let r=0,s=n.length;r!==s;++r)e.push(Kx(n[r]).scale(i));return new Jn(t.name,t.duration,e,t.blendMode)},toJSON:function(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,s=n.length;r!==s;++r)e.push(fn.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(t,e,n,i){const r=e.length,s=[];for(let o=0;o<r;o++){let a=[],u=[];a.push((o+r-1)%r,o,(o+1)%r),u.push(0,1,0);const l=Bt.getKeyframeOrder(a);a=Bt.sortedArray(a,1,l),u=Bt.sortedArray(u,1,l),!i&&a[0]===0&&(a.push(r),u.push(u[0])),s.push(new no(".morphTargetInfluences["+e[o].name+"]",a,u).scale(1/n))}return new Jn(t,-1,s)},findByName:function(t,e){let n=t;if(!Array.isArray(t)){const i=t;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){const u=t[o],l=u.name.match(r);if(l&&l.length>1){const d=l[1];let h=i[d];h||(i[d]=h=[]),h.push(u)}}const s=[];for(const o in i)s.push(Jn.CreateFromMorphTargetSequence(o,i[o],e,n));return s},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(d,h,g,m,y){if(g.length!==0){const w=[],M=[];Bt.flattenJSON(g,w,M,m),w.length!==0&&y.push(new d(h,w,M))}},i=[],r=t.name||"default",s=t.fps||30,o=t.blendMode;let a=t.length||-1;const u=t.hierarchy||[];for(let d=0;d<u.length;d++){const h=u[d].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const g={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let y=0;y<h[m].morphTargets.length;y++)g[h[m].morphTargets[y]]=-1;for(const y in g){const w=[],M=[];for(let _=0;_!==h[m].morphTargets.length;++_){const v=h[m];w.push(v.time),M.push(v.morphTarget===y?1:0)}i.push(new no(".morphTargetInfluence["+y+"]",w,M))}a=g.length*s}else{const g=".bones["+e[d].name+"]";n(io,g+".position",h,"pos",i),n(wa,g+".quaternion",h,"rot",i),n(io,g+".scale",h,"scl",i)}}return i.length===0?null:new Jn(r,a,i,o)}});Object.assign(Jn.prototype,{resetDuration:function(){const t=this.tracks;let e=0;for(let n=0,i=t.length;n!==i;++n){const r=this.tracks[n];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new Jn(this.name,this.duration,t,this.blendMode)}});const ds={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function _f(t,e,n){const i=this;let r=!1,s=0,o=0,a;const u=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(l){o++,r===!1&&i.onStart!==void 0&&i.onStart(l,s,o),r=!0},this.itemEnd=function(l){s++,i.onProgress!==void 0&&i.onProgress(l,s,o),s===o&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(l){i.onError!==void 0&&i.onError(l)},this.resolveURL=function(l){return a?a(l):l},this.setURLModifier=function(l){return a=l,this},this.addHandler=function(l,d){return u.push(l,d),this},this.removeHandler=function(l){const d=u.indexOf(l);return d!==-1&&u.splice(d,2),this},this.getHandler=function(l){for(let d=0,h=u.length;d<h;d+=2){const g=u[d],m=u[d+1];if(g.global&&(g.lastIndex=0),g.test(l))return m}return null}}const e0=new _f;function St(t){this.manager=t!==void 0?t:e0,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(St.prototype,{load:function(){},loadAsync:function(t,e){const n=this;return new Promise(function(i,r){n.load(t,i,e,r)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const Zn={};function fi(t){St.call(this,t)}fi.prototype=Object.assign(Object.create(St.prototype),{constructor:fi,load:function(t,e,n,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ds.get(t);if(s!==void 0)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;if(Zn[t]!==void 0){Zn[t].push({onLoad:e,onProgress:n,onError:i});return}const o=/^data:(.*?)(;base64)?,(.*)$/,a=t.match(o);let u;if(a){const l=a[1],d=!!a[2];let h=a[3];h=decodeURIComponent(h),d&&(h=atob(h));try{let g;const m=(this.responseType||"").toLowerCase();switch(m){case"arraybuffer":case"blob":const y=new Uint8Array(h.length);for(let M=0;M<h.length;M++)y[M]=h.charCodeAt(M);m==="blob"?g=new Blob([y.buffer],{type:l}):g=y.buffer;break;case"document":g=new DOMParser().parseFromString(h,l);break;case"json":g=JSON.parse(h);break;default:g=h;break}setTimeout(function(){e&&e(g),r.manager.itemEnd(t)},0)}catch(g){setTimeout(function(){i&&i(g),r.manager.itemError(t),r.manager.itemEnd(t)},0)}}else{Zn[t]=[],Zn[t].push({onLoad:e,onProgress:n,onError:i}),u=new XMLHttpRequest,u.open("GET",t,!0),u.addEventListener("load",function(l){const d=this.response,h=Zn[t];if(delete Zn[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ds.add(t,d);for(let g=0,m=h.length;g<m;g++){const y=h[g];y.onLoad&&y.onLoad(d)}r.manager.itemEnd(t)}else{for(let g=0,m=h.length;g<m;g++){const y=h[g];y.onError&&y.onError(l)}r.manager.itemError(t),r.manager.itemEnd(t)}},!1),u.addEventListener("progress",function(l){const d=Zn[t];for(let h=0,g=d.length;h<g;h++){const m=d[h];m.onProgress&&m.onProgress(l)}},!1),u.addEventListener("error",function(l){const d=Zn[t];delete Zn[t];for(let h=0,g=d.length;h<g;h++){const m=d[h];m.onError&&m.onError(l)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),u.addEventListener("abort",function(l){const d=Zn[t];delete Zn[t];for(let h=0,g=d.length;h<g;h++){const m=d[h];m.onError&&m.onError(l)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),this.responseType!==void 0&&(u.responseType=this.responseType),this.withCredentials!==void 0&&(u.withCredentials=this.withCredentials),u.overrideMimeType&&u.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const l in this.requestHeader)u.setRequestHeader(l,this.requestHeader[l]);u.send(null)}return r.manager.itemStart(t),u},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}});function fh(t){St.call(this,t)}fh.prototype=Object.assign(Object.create(St.prototype),{constructor:fh,load:function(t,e,n,i){const r=this,s=new fi(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){i?i(a):console.error(a),r.manager.itemError(t)}},n,i)},parse:function(t){const e=[];for(let n=0;n<t.length;n++){const i=Jn.parse(t[n]);e.push(i)}return e}});function dh(t){St.call(this,t)}dh.prototype=Object.assign(Object.create(St.prototype),{constructor:dh,load:function(t,e,n,i){const r=this,s=[],o=new Js;o.image=s;const a=new fi(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(r.withCredentials);let u=0;function l(d){a.load(t[d],function(h){const g=r.parse(h,!0);s[d]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},u+=1,u===6&&(g.mipmapCount===1&&(o.minFilter=sn),o.format=g.format,o.needsUpdate=!0,e&&e(o))},n,i)}if(Array.isArray(t))for(let d=0,h=t.length;d<h;++d)l(d);else a.load(t,function(d){const h=r.parse(d,!0);if(h.isCubemap){const g=h.mipmaps.length/h.mipmapCount;for(let m=0;m<g;m++){s[m]={mipmaps:[]};for(let y=0;y<h.mipmapCount;y++)s[m].mipmaps.push(h.mipmaps[m*h.mipmapCount+y]),s[m].format=h.format,s[m].width=h.width,s[m].height=h.height}}else o.image.width=h.width,o.image.height=h.height,o.mipmaps=h.mipmaps;h.mipmapCount===1&&(o.minFilter=sn),o.format=h.format,o.needsUpdate=!0,e&&e(o)},n,i);return o}});function ro(t){St.call(this,t)}ro.prototype=Object.assign(Object.create(St.prototype),{constructor:ro,load:function(t,e,n,i){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ds.get(t);if(s!==void 0)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function a(){o.removeEventListener("load",a,!1),o.removeEventListener("error",u,!1),ds.add(t,this),e&&e(this),r.manager.itemEnd(t)}function u(l){o.removeEventListener("load",a,!1),o.removeEventListener("error",u,!1),i&&i(l),r.manager.itemError(t),r.manager.itemEnd(t)}return o.addEventListener("load",a,!1),o.addEventListener("error",u,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}});function ll(t){St.call(this,t)}ll.prototype=Object.assign(Object.create(St.prototype),{constructor:ll,load:function(t,e,n,i){const r=new Li,s=new ro(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(u){s.load(t[u],function(l){r.images[u]=l,o++,o===6&&(r.needsUpdate=!0,e&&e(r))},void 0,i)}for(let u=0;u<t.length;++u)a(u);return r}});function ph(t){St.call(this,t)}ph.prototype=Object.assign(Object.create(St.prototype),{constructor:ph,load:function(t,e,n,i){const r=this,s=new os,o=new fi(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(t,function(a){const u=r.parse(a);u&&(u.image!==void 0?s.image=u.image:u.data!==void 0&&(s.image.width=u.width,s.image.height=u.height,s.image.data=u.data),s.wrapS=u.wrapS!==void 0?u.wrapS:xn,s.wrapT=u.wrapT!==void 0?u.wrapT:xn,s.magFilter=u.magFilter!==void 0?u.magFilter:sn,s.minFilter=u.minFilter!==void 0?u.minFilter:sn,s.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.format!==void 0&&(s.format=u.format),u.type!==void 0&&(s.type=u.type),u.mipmaps!==void 0&&(s.mipmaps=u.mipmaps,s.minFilter=lo),u.mipmapCount===1&&(s.minFilter=sn),s.needsUpdate=!0,e&&e(s,u))},n,i),s}});function ul(t){St.call(this,t)}ul.prototype=Object.assign(Object.create(St.prototype),{constructor:ul,load:function(t,e,n,i){const r=new Ct,s=new ro(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(o){r.image=o;const a=t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0;r.format=a?fr:Qn,r.needsUpdate=!0,e!==void 0&&e(r)},n,i),r}});function Ve(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Ve.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){t===void 0&&(t=5);const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){t===void 0&&(t=5);const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){const n=this.getLengths();let i=0;const r=n.length;let s;e?s=e:s=t*n[r-1];let o=0,a=r-1,u;for(;o<=a;)if(i=Math.floor(o+(a-o)/2),u=n[i]-s,u<0)o=i+1;else if(u>0)a=i-1;else{a=i;break}if(i=a,n[i]===s)return i/(r-1);const l=n[i],h=n[i+1]-l,g=(s-l)/h;return(i+g)/(r-1)},getTangent:function(t,e){let i=t-1e-4,r=t+1e-4;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),o=this.getPoint(r),a=e||(s.isVector2?new oe:new P);return a.copy(o).sub(s).normalize(),a},getTangentAt:function(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)},computeFrenetFrames:function(t,e){const n=new P,i=[],r=[],s=[],o=new P,a=new ht;for(let g=0;g<=t;g++){const m=g/t;i[g]=this.getTangentAt(m,new P),i[g].normalize()}r[0]=new P,s[0]=new P;let u=Number.MAX_VALUE;const l=Math.abs(i[0].x),d=Math.abs(i[0].y),h=Math.abs(i[0].z);l<=u&&(u=l,n.set(1,0,0)),d<=u&&(u=d,n.set(0,1,0)),h<=u&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let g=1;g<=t;g++){if(r[g]=r[g-1].clone(),s[g]=s[g-1].clone(),o.crossVectors(i[g-1],i[g]),o.length()>Number.EPSILON){o.normalize();const m=Math.acos(at.clamp(i[g-1].dot(i[g]),-1,1));r[g].applyMatrix4(a.makeRotationAxis(o,m))}s[g].crossVectors(i[g],r[g])}if(e===!0){let g=Math.acos(at.clamp(r[0].dot(r[t]),-1,1));g/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(g=-g);for(let m=1;m<=t;m++)r[m].applyMatrix4(a.makeRotationAxis(i[m],g*m)),s[m].crossVectors(i[m],r[m])}return{tangents:i,normals:r,binormals:s}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}});function kn(t,e,n,i,r,s,o,a){Ve.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=s||2*Math.PI,this.aClockwise=o||!1,this.aRotation=a||0}kn.prototype=Object.create(Ve.prototype);kn.prototype.constructor=kn;kn.prototype.isEllipseCurve=!0;kn.prototype.getPoint=function(t,e){const n=e||new oe,i=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(s?r=0:r=i),this.aClockwise===!0&&!s&&(r===i?r=-i:r=r-i);const o=this.aStartAngle+t*r;let a=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const l=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=a-this.aX,g=u-this.aY;a=h*l-g*d+this.aX,u=h*d+g*l+this.aY}return n.set(a,u)};kn.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this};kn.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t};kn.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this};function so(t,e,n,i,r,s){kn.call(this,t,e,n,n,i,r,s),this.type="ArcCurve"}so.prototype=Object.create(kn.prototype);so.prototype.constructor=so;so.prototype.isArcCurve=!0;function Il(){let t=0,e=0,n=0,i=0;function r(s,o,a,u){t=s,e=a,n=-3*s+3*o-2*a-u,i=2*s-2*o+a+u}return{initCatmullRom:function(s,o,a,u,l){r(o,a,l*(a-s),l*(u-o))},initNonuniformCatmullRom:function(s,o,a,u,l,d,h){let g=(o-s)/l-(a-s)/(l+d)+(a-o)/d,m=(a-o)/d-(u-o)/(d+h)+(u-a)/h;g*=d,m*=d,r(o,a,g,m)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+i*a}}}const ra=new P,Rc=new Il,Pc=new Il,Dc=new Il;function Pn(t,e,n,i){Ve.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=i!==void 0?i:.5}Pn.prototype=Object.create(Ve.prototype);Pn.prototype.constructor=Pn;Pn.prototype.isCatmullRomCurve3=!0;Pn.prototype.getPoint=function(t,e){const n=e||new P,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t;let o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let u,l;this.closed||o>0?u=i[(o-1)%r]:(ra.subVectors(i[0],i[1]).add(i[0]),u=ra);const d=i[o%r],h=i[(o+1)%r];if(this.closed||o+2<r?l=i[(o+2)%r]:(ra.subVectors(i[r-1],i[r-2]).add(i[r-1]),l=ra),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let m=Math.pow(u.distanceToSquared(d),g),y=Math.pow(d.distanceToSquared(h),g),w=Math.pow(h.distanceToSquared(l),g);y<1e-4&&(y=1),m<1e-4&&(m=y),w<1e-4&&(w=y),Rc.initNonuniformCatmullRom(u.x,d.x,h.x,l.x,m,y,w),Pc.initNonuniformCatmullRom(u.y,d.y,h.y,l.y,m,y,w),Dc.initNonuniformCatmullRom(u.z,d.z,h.z,l.z,m,y,w)}else this.curveType==="catmullrom"&&(Rc.initCatmullRom(u.x,d.x,h.x,l.x,this.tension),Pc.initCatmullRom(u.y,d.y,h.y,l.y,this.tension),Dc.initCatmullRom(u.z,d.z,h.z,l.z,this.tension));return n.set(Rc.calc(a),Pc.calc(a),Dc.calc(a)),n};Pn.prototype.copy=function(t){Ve.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this};Pn.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t};Pn.prototype.fromJSON=function(t){Ve.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(new P().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this};function mh(t,e,n,i,r){const s=(i-e)*.5,o=(r-n)*.5,a=t*t,u=t*a;return(2*n-2*i+s+o)*u+(-3*n+3*i-2*s-o)*a+s*t+n}function t0(t,e){const n=1-t;return n*n*e}function n0(t,e){return 2*(1-t)*t*e}function i0(t,e){return t*t*e}function Gs(t,e,n,i){return t0(t,e)+n0(t,n)+i0(t,i)}function r0(t,e){const n=1-t;return n*n*n*e}function s0(t,e){const n=1-t;return 3*n*n*t*e}function o0(t,e){return 3*(1-t)*t*t*e}function a0(t,e){return t*t*t*e}function Hs(t,e,n,i,r){return r0(t,e)+s0(t,n)+o0(t,i)+a0(t,r)}function di(t,e,n,i){Ve.call(this),this.type="CubicBezierCurve",this.v0=t||new oe,this.v1=e||new oe,this.v2=n||new oe,this.v3=i||new oe}di.prototype=Object.create(Ve.prototype);di.prototype.constructor=di;di.prototype.isCubicBezierCurve=!0;di.prototype.getPoint=function(t,e){const n=e||new oe,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(Hs(t,i.x,r.x,s.x,o.x),Hs(t,i.y,r.y,s.y,o.y)),n};di.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this};di.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t};di.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this};function Ri(t,e,n,i){Ve.call(this),this.type="CubicBezierCurve3",this.v0=t||new P,this.v1=e||new P,this.v2=n||new P,this.v3=i||new P}Ri.prototype=Object.create(Ve.prototype);Ri.prototype.constructor=Ri;Ri.prototype.isCubicBezierCurve3=!0;Ri.prototype.getPoint=function(t,e){const n=e||new P,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(Hs(t,i.x,r.x,s.x,o.x),Hs(t,i.y,r.y,s.y,o.y),Hs(t,i.z,r.z,s.z,o.z)),n};Ri.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this};Ri.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t};Ri.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this};function Dn(t,e){Ve.call(this),this.type="LineCurve",this.v1=t||new oe,this.v2=e||new oe}Dn.prototype=Object.create(Ve.prototype);Dn.prototype.constructor=Dn;Dn.prototype.isLineCurve=!0;Dn.prototype.getPoint=function(t,e){const n=e||new oe;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n};Dn.prototype.getPointAt=function(t,e){return this.getPoint(t,e)};Dn.prototype.getTangent=function(t,e){const n=e||new oe;return n.copy(this.v2).sub(this.v1).normalize(),n};Dn.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this};Dn.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t};Dn.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function pi(t,e){Ve.call(this),this.type="LineCurve3",this.v1=t||new P,this.v2=e||new P}pi.prototype=Object.create(Ve.prototype);pi.prototype.constructor=pi;pi.prototype.isLineCurve3=!0;pi.prototype.getPoint=function(t,e){const n=e||new P;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n};pi.prototype.getPointAt=function(t,e){return this.getPoint(t,e)};pi.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this};pi.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t};pi.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function mi(t,e,n){Ve.call(this),this.type="QuadraticBezierCurve",this.v0=t||new oe,this.v1=e||new oe,this.v2=n||new oe}mi.prototype=Object.create(Ve.prototype);mi.prototype.constructor=mi;mi.prototype.isQuadraticBezierCurve=!0;mi.prototype.getPoint=function(t,e){const n=e||new oe,i=this.v0,r=this.v1,s=this.v2;return n.set(Gs(t,i.x,r.x,s.x),Gs(t,i.y,r.y,s.y)),n};mi.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this};mi.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t};mi.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function Pi(t,e,n){Ve.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new P,this.v1=e||new P,this.v2=n||new P}Pi.prototype=Object.create(Ve.prototype);Pi.prototype.constructor=Pi;Pi.prototype.isQuadraticBezierCurve3=!0;Pi.prototype.getPoint=function(t,e){const n=e||new P,i=this.v0,r=this.v1,s=this.v2;return n.set(Gs(t,i.x,r.x,s.x),Gs(t,i.y,r.y,s.y),Gs(t,i.z,r.z,s.z)),n};Pi.prototype.copy=function(t){return Ve.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this};Pi.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t};Pi.prototype.fromJSON=function(t){return Ve.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this};function gi(t){Ve.call(this),this.type="SplineCurve",this.points=t||[]}gi.prototype=Object.create(Ve.prototype);gi.prototype.constructor=gi;gi.prototype.isSplineCurve=!0;gi.prototype.getPoint=function(t,e){const n=e||new oe,i=this.points,r=(i.length-1)*t,s=Math.floor(r),o=r-s,a=i[s===0?s:s-1],u=i[s],l=i[s>i.length-2?i.length-1:s+1],d=i[s>i.length-3?i.length-1:s+2];return n.set(mh(o,a.x,u.x,l.x,d.x),mh(o,a.y,u.y,l.y,d.y)),n};gi.prototype.copy=function(t){Ve.prototype.copy.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(i.clone())}return this};gi.prototype.toJSON=function(){const t=Ve.prototype.toJSON.call(this);t.points=[];for(let e=0,n=this.points.length;e<n;e++){const i=this.points[e];t.points.push(i.toArray())}return t};gi.prototype.fromJSON=function(t){Ve.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const i=t.points[e];this.points.push(new oe().fromArray(i))}return this};var hl=Object.freeze({__proto__:null,ArcCurve:so,CatmullRomCurve3:Pn,CubicBezierCurve:di,CubicBezierCurve3:Ri,EllipseCurve:kn,LineCurve:Dn,LineCurve3:pi,QuadraticBezierCurve:mi,QuadraticBezierCurve3:Pi,SplineCurve:gi});function Xi(){Ve.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Xi.prototype=Object.assign(Object.create(Ve.prototype),{constructor:Xi,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Dn(e,t))},getPoint:function(t){const e=t*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=e){const r=n[i]-e,s=this.curves[i],o=s.getLength(),a=o===0?0:1-r/o;return s.getPointAt(a)}i++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){t===void 0&&(t=40);const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s&&s.isEllipseCurve?t*2:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let u=0;u<a.length;u++){const l=a[u];n&&n.equals(l)||(e.push(l),n=l)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},copy:function(t){Ve.prototype.copy.call(this,t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){const t=Ve.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t},fromJSON:function(t){Ve.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const i=t.curves[e];this.curves.push(new hl[i.type]().fromJSON(i))}return this}});function ui(t){Xi.call(this),this.type="Path",this.currentPoint=new oe,t&&this.setFromPoints(t)}ui.prototype=Object.assign(Object.create(Xi.prototype),{constructor:ui,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){const n=new Dn(this.currentPoint.clone(),new oe(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,i){const r=new mi(this.currentPoint.clone(),new oe(t,e),new oe(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this},bezierCurveTo:function(t,e,n,i,r,s){const o=new di(this.currentPoint.clone(),new oe(t,e),new oe(n,i),new oe(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this},splineThru:function(t){const e=[this.currentPoint.clone()].concat(t),n=new gi(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,i,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,n,i,r,s),this},absarc:function(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this},ellipse:function(t,e,n,i,r,s,o,a){const u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(t+u,e+l,n,i,r,s,o,a),this},absellipse:function(t,e,n,i,r,s,o,a){const u=new kn(t,e,n,i,r,s,o,a);if(this.curves.length>0){const d=u.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(u);const l=u.getPoint(1);return this.currentPoint.copy(l),this},copy:function(t){return Xi.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Xi.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Xi.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}});function dr(t){ui.call(this,t),this.uuid=at.generateUUID(),this.type="Shape",this.holes=[]}dr.prototype=Object.assign(Object.create(ui.prototype),{constructor:dr,getPointsHoles:function(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){ui.prototype.copy.call(this,t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const i=t.holes[e];this.holes.push(i.clone())}return this},toJSON:function(){const t=ui.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t},fromJSON:function(t){ui.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const i=t.holes[e];this.holes.push(new ui().fromJSON(i))}return this}});function Nt(t,e){je.call(this),this.type="Light",this.color=new He(t),this.intensity=e!==void 0?e:1}Nt.prototype=Object.assign(Object.create(je.prototype),{constructor:Nt,isLight:!0,copy:function(t){return je.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const e=je.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}});function fl(t,e,n){Nt.call(this,t,n),this.type="HemisphereLight",this.position.copy(je.DefaultUp),this.updateMatrix(),this.groundColor=new He(e)}fl.prototype=Object.assign(Object.create(Nt.prototype),{constructor:fl,isHemisphereLight:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}});function Di(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new oe(512,512),this.map=null,this.mapPass=null,this.matrix=new ht,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Oa,this._frameExtents=new oe(1,1),this._viewportCount=1,this._viewports=[new At(0,0,1,1)]}Object.assign(Di.prototype,{_projScreenMatrix:new ht,_lightPositionWorld:new P,_lookTarget:new P,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const e=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,s=this._lightPositionWorld;s.setFromMatrixPosition(t.matrixWorld),e.position.copy(s),r.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r),e.updateMatrixWorld(),i.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}});function dl(){Di.call(this,new en(50,1,.5,500)),this.focus=1}dl.prototype=Object.assign(Object.create(Di.prototype),{constructor:dl,isSpotLightShadow:!0,updateMatrices:function(t){const e=this.camera,n=at.RAD2DEG*2*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;(n!==e.fov||i!==e.aspect||r!==e.far)&&(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),Di.prototype.updateMatrices.call(this,t)}});function pl(t,e,n,i,r,s){Nt.call(this,t,e),this.type="SpotLight",this.position.copy(je.DefaultUp),this.updateMatrix(),this.target=new je,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(o){this.intensity=o/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=i!==void 0?i:Math.PI/3,this.penumbra=r!==void 0?r:0,this.decay=s!==void 0?s:1,this.shadow=new dl}pl.prototype=Object.assign(Object.create(Nt.prototype),{constructor:pl,isSpotLight:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function ml(){Di.call(this,new en(90,1,.5,500)),this._frameExtents=new oe(4,2),this._viewportCount=6,this._viewports=[new At(2,1,1,1),new At(0,1,1,1),new At(3,1,1,1),new At(1,1,1,1),new At(3,0,1,1),new At(1,0,1,1)],this._cubeDirections=[new P(1,0,0),new P(-1,0,0),new P(0,0,1),new P(0,0,-1),new P(0,1,0),new P(0,-1,0)],this._cubeUps=[new P(0,1,0),new P(0,1,0),new P(0,1,0),new P(0,1,0),new P(0,0,1),new P(0,0,-1)]}ml.prototype=Object.assign(Object.create(Di.prototype),{constructor:ml,isPointLightShadow:!0,updateMatrices:function(t,e){e===void 0&&(e=0);const n=this.camera,i=this.matrix,r=this._lightPositionWorld,s=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(t.matrixWorld),n.position.copy(r),s.copy(n.position),s.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(s),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}});function oo(t,e,n,i){Nt.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(r){this.intensity=r/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=i!==void 0?i:1,this.shadow=new ml}oo.prototype=Object.assign(Object.create(Nt.prototype),{constructor:oo,isPointLight:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}});function ao(t,e,n,i,r,s){$i.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t!==void 0?t:-1,this.right=e!==void 0?e:1,this.top=n!==void 0?n:1,this.bottom=i!==void 0?i:-1,this.near=r!==void 0?r:.1,this.far=s!==void 0?s:2e3,this.updateProjectionMatrix()}ao.prototype=Object.assign(Object.create($i.prototype),{constructor:ao,isOrthographicCamera:!0,copy:function(t,e){return $i.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,s=n+t,o=i+e,a=i-e;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=u*this.view.offsetX,s=r+u*this.view.width,o-=l*this.view.offsetY,a=o-l*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const e=je.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}});function gl(){Di.call(this,new ao(-5,5,5,-5,.5,500))}gl.prototype=Object.assign(Object.create(Di.prototype),{constructor:gl,isDirectionalLightShadow:!0,updateMatrices:function(t){Di.prototype.updateMatrices.call(this,t)}});function yl(t,e){Nt.call(this,t,e),this.type="DirectionalLight",this.position.copy(je.DefaultUp),this.updateMatrix(),this.target=new je,this.shadow=new gl}yl.prototype=Object.assign(Object.create(Nt.prototype),{constructor:yl,isDirectionalLight:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});function Ma(t,e){Nt.call(this,t,e),this.type="AmbientLight"}Ma.prototype=Object.assign(Object.create(Nt.prototype),{constructor:Ma,isAmbientLight:!0});function vl(t,e,n,i){Nt.call(this,t,e),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=i!==void 0?i:10}vl.prototype=Object.assign(Object.create(Nt.prototype),{constructor:vl,isRectAreaLight:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const e=Nt.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}});class c0{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new P)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}function ei(t,e){Nt.call(this,void 0,e),this.type="LightProbe",this.sh=t!==void 0?t:new c0}ei.prototype=Object.assign(Object.create(Nt.prototype),{constructor:ei,isLightProbe:!0,copy:function(t){return Nt.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const e=Nt.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}});function xl(t){St.call(this,t),this.textures={}}xl.prototype=Object.assign(Object.create(St.prototype),{constructor:xl,load:function(t,e,n,i){const r=this,s=new fi(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){i?i(a):console.error(a),r.manager.itemError(t)}},n,i)},parse:function(t){const e=this.textures;function n(r){return e[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),e[r]}const i=new $x[t.type];if(t.uuid!==void 0&&(i.uuid=t.uuid),t.name!==void 0&&(i.name=t.name),t.color!==void 0&&i.color!==void 0&&i.color.setHex(t.color),t.roughness!==void 0&&(i.roughness=t.roughness),t.metalness!==void 0&&(i.metalness=t.metalness),t.sheen!==void 0&&(i.sheen=new He().setHex(t.sheen)),t.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(t.emissive),t.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(t.specular),t.shininess!==void 0&&(i.shininess=t.shininess),t.clearcoat!==void 0&&(i.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=t.clearcoatRoughness),t.fog!==void 0&&(i.fog=t.fog),t.flatShading!==void 0&&(i.flatShading=t.flatShading),t.blending!==void 0&&(i.blending=t.blending),t.combine!==void 0&&(i.combine=t.combine),t.side!==void 0&&(i.side=t.side),t.opacity!==void 0&&(i.opacity=t.opacity),t.transparent!==void 0&&(i.transparent=t.transparent),t.alphaTest!==void 0&&(i.alphaTest=t.alphaTest),t.depthTest!==void 0&&(i.depthTest=t.depthTest),t.depthWrite!==void 0&&(i.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(i.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(i.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(i.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(i.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(i.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(i.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(i.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(i.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(i.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(i.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(i.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(i.rotation=t.rotation),t.linewidth!==1&&(i.linewidth=t.linewidth),t.dashSize!==void 0&&(i.dashSize=t.dashSize),t.gapSize!==void 0&&(i.gapSize=t.gapSize),t.scale!==void 0&&(i.scale=t.scale),t.polygonOffset!==void 0&&(i.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(i.skinning=t.skinning),t.morphTargets!==void 0&&(i.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(i.morphNormals=t.morphNormals),t.dithering!==void 0&&(i.dithering=t.dithering),t.vertexTangents!==void 0&&(i.vertexTangents=t.vertexTangents),t.visible!==void 0&&(i.visible=t.visible),t.toneMapped!==void 0&&(i.toneMapped=t.toneMapped),t.userData!==void 0&&(i.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?i.vertexColors=t.vertexColors>0:i.vertexColors=t.vertexColors),t.uniforms!==void 0)for(const r in t.uniforms){const s=t.uniforms[r];switch(i.uniforms[r]={},s.type){case"t":i.uniforms[r].value=n(s.value);break;case"c":i.uniforms[r].value=new He().setHex(s.value);break;case"v2":i.uniforms[r].value=new oe().fromArray(s.value);break;case"v3":i.uniforms[r].value=new P().fromArray(s.value);break;case"v4":i.uniforms[r].value=new At().fromArray(s.value);break;case"m3":i.uniforms[r].value=new _n().fromArray(s.value);break;case"m4":i.uniforms[r].value=new ht().fromArray(s.value);break;default:i.uniforms[r].value=s.value}}if(t.defines!==void 0&&(i.defines=t.defines),t.vertexShader!==void 0&&(i.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(i.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(const r in t.extensions)i.extensions[r]=t.extensions[r];if(t.shading!==void 0&&(i.flatShading=t.shading===1),t.size!==void 0&&(i.size=t.size),t.sizeAttenuation!==void 0&&(i.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(i.map=n(t.map)),t.matcap!==void 0&&(i.matcap=n(t.matcap)),t.alphaMap!==void 0&&(i.alphaMap=n(t.alphaMap)),t.bumpMap!==void 0&&(i.bumpMap=n(t.bumpMap)),t.bumpScale!==void 0&&(i.bumpScale=t.bumpScale),t.normalMap!==void 0&&(i.normalMap=n(t.normalMap)),t.normalMapType!==void 0&&(i.normalMapType=t.normalMapType),t.normalScale!==void 0){let r=t.normalScale;Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new oe().fromArray(r)}return t.displacementMap!==void 0&&(i.displacementMap=n(t.displacementMap)),t.displacementScale!==void 0&&(i.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(i.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(i.roughnessMap=n(t.roughnessMap)),t.metalnessMap!==void 0&&(i.metalnessMap=n(t.metalnessMap)),t.emissiveMap!==void 0&&(i.emissiveMap=n(t.emissiveMap)),t.emissiveIntensity!==void 0&&(i.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(i.specularMap=n(t.specularMap)),t.envMap!==void 0&&(i.envMap=n(t.envMap)),t.envMapIntensity!==void 0&&(i.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(i.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(i.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(i.lightMap=n(t.lightMap)),t.lightMapIntensity!==void 0&&(i.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(i.aoMap=n(t.aoMap)),t.aoMapIntensity!==void 0&&(i.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(i.gradientMap=n(t.gradientMap)),t.clearcoatMap!==void 0&&(i.clearcoatMap=n(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new oe().fromArray(t.clearcoatNormalScale)),t.transmission!==void 0&&(i.transmission=t.transmission),t.transmissionMap!==void 0&&(i.transmissionMap=n(t.transmissionMap)),i},setTextures:function(t){return this.textures=t,this}});const bf={decodeText:function(t){if(typeof TextDecoder<"u")return new TextDecoder().decode(t);let e="";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch{return e}},extractUrlBase:function(t){const e=t.lastIndexOf("/");return e===-1?"./":t.substr(0,e+1)}};function Sa(){lt.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Sa.prototype=Object.assign(Object.create(lt.prototype),{constructor:Sa,isInstancedBufferGeometry:!0,copy:function(t){return lt.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const t=lt.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}});function _l(t,e,n,i){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),ct.call(this,t,e,n),this.meshPerAttribute=i||1}_l.prototype=Object.assign(Object.create(ct.prototype),{constructor:_l,isInstancedBufferAttribute:!0,copy:function(t){return ct.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=ct.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}});function bl(t){St.call(this,t)}bl.prototype=Object.assign(Object.create(St.prototype),{constructor:bl,load:function(t,e,n,i){const r=this,s=new fi(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){i?i(a):console.error(a),r.manager.itemError(t)}},n,i)},parse:function(t){const e={},n={};function i(g,m){if(e[m]!==void 0)return e[m];const w=g.interleavedBuffers[m],M=r(g,w.buffer),_=new sa[w.type](M),v=new On(_,w.stride);return v.uuid=w.uuid,e[m]=v,v}function r(g,m){if(n[m]!==void 0)return n[m];const w=g.arrayBuffers[m],M=new Uint32Array(w).buffer;return n[m]=M,M}const s=t.isInstancedBufferGeometry?new Sa:new lt,o=t.data.index;if(o!==void 0){const g=new sa[o.type](o.array);s.setIndex(new ct(g,1))}const a=t.data.attributes;for(const g in a){const m=a[g];let y;if(m.isInterleavedBufferAttribute){const w=i(t.data,m.data);y=new xr(w,m.itemSize,m.offset,m.normalized)}else{const w=new sa[m.type](m.array),M=m.isInstancedBufferAttribute?_l:ct;y=new M(w,m.itemSize,m.normalized)}m.name!==void 0&&(y.name=m.name),s.setAttribute(g,y)}const u=t.data.morphAttributes;if(u)for(const g in u){const m=u[g],y=[];for(let w=0,M=m.length;w<M;w++){const _=m[w];let v;if(_.isInterleavedBufferAttribute){const E=i(t.data,_.data);v=new xr(E,_.itemSize,_.offset,_.normalized)}else{const E=new sa[_.type](_.array);v=new ct(E,_.itemSize,_.normalized)}_.name!==void 0&&(v.name=_.name),y.push(v)}s.morphAttributes[g]=y}t.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);const d=t.data.groups||t.data.drawcalls||t.data.offsets;if(d!==void 0)for(let g=0,m=d.length;g!==m;++g){const y=d[g];s.addGroup(y.start,y.count,y.materialIndex)}const h=t.data.boundingSphere;if(h!==void 0){const g=new P;h.center!==void 0&&g.fromArray(h.center),s.boundingSphere=new er(g,h.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}});const sa={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};class l0 extends St{constructor(e){super(e)}load(e,n,i,r){const s=this,o=this.path===""?bf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new fi(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(u){let l=null;try{l=JSON.parse(u)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const d=l.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(l,n)},i,r)}parse(e,n){const i=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,function(){n!==void 0&&n(u)}),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,r,a);return e.animations&&(u.animations=this.parseAnimations(e.animations)),(e.images===void 0||e.images.length===0)&&n!==void 0&&n(u),u}parseShape(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new dr().fromJSON(e[i]);n[s.uuid]=s}return n}parseGeometries(e,n){const i={};let r;if(e!==void 0){const s=new bl;for(let o=0,a=e.length;o<a;o++){let u;const l=e[o];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":u=new pn[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":u=new pn[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":u=new pn[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":u=new pn[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":u=new pn[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":u=new pn[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":u=new pn[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":u=new pn[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":u=new pn[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":u=new pn[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"TubeGeometry":case"TubeBufferGeometry":u=new pn[l.type](new hl[l.path.type]().fromJSON(l.path),l.tubularSegments,l.radius,l.radialSegments,l.closed);break;case"LatheGeometry":case"LatheBufferGeometry":u=new pn[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":u=new pn[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":r=[];for(let h=0,g=l.shapes.length;h<g;h++){const m=n[l.shapes[h]];r.push(m)}u=new pn[l.type](r,l.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":r=[];for(let h=0,g=l.shapes.length;h<g;h++){const m=n[l.shapes[h]];r.push(m)}const d=l.options.extrudePath;d!==void 0&&(l.options.extrudePath=new hl[d.type]().fromJSON(d)),u=new pn[l.type](r,l.options);break;case"BufferGeometry":case"InstancedBufferGeometry":u=s.parse(l);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}u.uuid=l.uuid,l.name!==void 0&&(u.name=l.name),u.isBufferGeometry===!0&&l.userData!==void 0&&(u.userData=l.userData),i[l.uuid]=u}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new xl;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const u=e[o];if(u.type==="MultiMaterial"){const l=[];for(let d=0;d<u.materials.length;d++){const h=u.materials[d];i[h.uuid]===void 0&&(i[h.uuid]=s.parse(h)),l.push(i[h.uuid])}r[u.uuid]=l}else i[u.uuid]===void 0&&(i[u.uuid]=s.parse(u)),r[u.uuid]=i[u.uuid]}}return r}parseAnimations(e){const n=[];for(let i=0;i<e.length;i++){const r=e[i],s=Jn.parse(r);r.uuid!==void 0&&(s.uuid=r.uuid),n.push(s)}return n}parseImages(e,n){const i=this,r={};let s;function o(a){return i.manager.itemStart(a),s.load(a,function(){i.manager.itemEnd(a)},void 0,function(){i.manager.itemError(a),i.manager.itemEnd(a)})}if(e!==void 0&&e.length>0){const a=new _f(n);s=new ro(a),s.setCrossOrigin(this.crossOrigin);for(let u=0,l=e.length;u<l;u++){const d=e[u],h=d.url;if(Array.isArray(h)){r[d.uuid]=[];for(let g=0,m=h.length;g<m;g++){const y=h[g],w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(y)?y:i.resourcePath+y;r[d.uuid].push(o(w))}}else{const g=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d.url)?d.url:i.resourcePath+d.url;r[d.uuid]=o(g)}}}return r}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);let u;Array.isArray(n[a.image])?u=new Li(n[a.image]):u=new Ct(n[a.image]),u.needsUpdate=!0,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=i(a.mapping,u0)),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=i(a.wrap[0],gh),u.wrapT=i(a.wrap[1],gh)),a.format!==void 0&&(u.format=a.format),a.type!==void 0&&(u.type=a.type),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=i(a.minFilter,yh)),a.magFilter!==void 0&&(u.magFilter=i(a.magFilter,yh)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),r[a.uuid]=u}return r}parseObject(e,n,i){let r;function s(l){return n[l]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",l),n[l]}function o(l){if(l!==void 0){if(Array.isArray(l)){const d=[];for(let h=0,g=l.length;h<g;h++){const m=l[h];i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),d.push(i[m])}return d}return i[l]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",l),i[l]}}let a,u;switch(e.type){case"Scene":r=new Pl,e.background!==void 0&&Number.isInteger(e.background)&&(r.background=new He(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?r.fog=new Rl(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(r.fog=new Cl(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new en(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(r.focus=e.focus),e.zoom!==void 0&&(r.zoom=e.zoom),e.filmGauge!==void 0&&(r.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(r.filmOffset=e.filmOffset),e.view!==void 0&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new ao(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(r.zoom=e.zoom),e.view!==void 0&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Ma(e.color,e.intensity);break;case"DirectionalLight":r=new yl(e.color,e.intensity);break;case"PointLight":r=new oo(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new vl(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new pl(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new fl(e.color,e.groundColor,e.intensity);break;case"LightProbe":r=new ei().fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":a=s(e.geometry),u=o(e.material),r=new Jt(a,u);break;case"InstancedMesh":a=s(e.geometry),u=o(e.material);const l=e.count,d=e.instanceMatrix;r=new $c(a,u,l),r.instanceMatrix=new ct(new Float32Array(d.array),16);break;case"LOD":r=new ya;break;case"Line":r=new br(s(e.geometry),o(e.material),e.mode);break;case"LineLoop":r=new Qc(s(e.geometry),o(e.material));break;case"LineSegments":r=new Zs(s(e.geometry),o(e.material));break;case"PointCloud":case"Points":r=new el(s(e.geometry),o(e.material));break;case"Sprite":r=new Yc(o(e.material));break;case"Group":r=new hr;break;default:r=new je}if(r.uuid=e.uuid,e.name!==void 0&&(r.name=e.name),e.matrix!==void 0?(r.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(e.position!==void 0&&r.position.fromArray(e.position),e.rotation!==void 0&&r.rotation.fromArray(e.rotation),e.quaternion!==void 0&&r.quaternion.fromArray(e.quaternion),e.scale!==void 0&&r.scale.fromArray(e.scale)),e.castShadow!==void 0&&(r.castShadow=e.castShadow),e.receiveShadow!==void 0&&(r.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(r.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(r.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(r.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&r.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(r.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(r.visible=e.visible),e.frustumCulled!==void 0&&(r.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(r.renderOrder=e.renderOrder),e.userData!==void 0&&(r.userData=e.userData),e.layers!==void 0&&(r.layers.mask=e.layers),e.children!==void 0){const l=e.children;for(let d=0;d<l.length;d++)r.add(this.parseObject(l[d],n,i))}if(e.type==="LOD"){e.autoUpdate!==void 0&&(r.autoUpdate=e.autoUpdate);const l=e.levels;for(let d=0;d<l.length;d++){const h=l[d],g=r.getObjectByProperty("uuid",h.object);g!==void 0&&r.addLevel(g,h.distance)}}return r}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const u0={UVMapping:Tl,CubeReflectionMapping:Ca,CubeRefractionMapping:Ra,EquirectangularReflectionMapping:Oc,EquirectangularRefractionMapping:Bc,CubeUVReflectionMapping:Pa,CubeUVRefractionMapping:Da},gh={RepeatWrapping:ha,ClampToEdgeWrapping:xn,MirroredRepeatWrapping:fa},yh={NearestFilter:un,NearestMipmapNearestFilter:Fc,NearestMipmapLinearFilter:zc,LinearFilter:sn,LinearMipmapNearestFilter:Bh,LinearMipmapLinearFilter:lo};function vh(t){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),St.call(this,t),this.options={premultiplyAlpha:"none"}}vh.prototype=Object.assign(Object.create(St.prototype),{constructor:vh,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(t,e,n,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ds.get(t);if(s!==void 0)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(t,o).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,r.options)}).then(function(a){ds.add(t,a),e&&e(a),r.manager.itemEnd(t)}).catch(function(a){i&&i(a),r.manager.itemError(t),r.manager.itemEnd(t)}),r.manager.itemStart(t)}});function wf(){this.type="ShapePath",this.color=new He,this.subPaths=[],this.currentPath=null}Object.assign(wf.prototype,{moveTo:function(t,e){return this.currentPath=new ui,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this},bezierCurveTo:function(t,e,n,i,r,s){return this.currentPath.bezierCurveTo(t,e,n,i,r,s),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function n(_){const v=[];for(let E=0,R=_.length;E<R;E++){const p=_[E],A=new dr;A.curves=p.curves,v.push(A)}return v}function i(_,v){const E=v.length;let R=!1;for(let p=E-1,A=0;A<E;p=A++){let O=v[p],H=v[A],ne=H.x-O.x,se=H.y-O.y;if(Math.abs(se)>Number.EPSILON){if(se<0&&(O=v[A],ne=-ne,H=v[p],se=-se),_.y<O.y||_.y>H.y)continue;if(_.y===O.y){if(_.x===O.x)return!0}else{const B=se*(_.x-O.x)-ne*(_.y-O.y);if(B===0)return!0;if(B<0)continue;R=!R}}else{if(_.y!==O.y)continue;if(H.x<=_.x&&_.x<=O.x||O.x<=_.x&&_.x<=H.x)return!0}}return R}const r=Zi.isClockWise,s=this.subPaths;if(s.length===0)return[];if(e===!0)return n(s);let o,a,u;const l=[];if(s.length===1)return a=s[0],u=new dr,u.curves=a.curves,l.push(u),l;let d=!r(s[0].getPoints());d=t?!d:d;const h=[],g=[];let m=[],y=0,w;g[y]=void 0,m[y]=[];for(let _=0,v=s.length;_<v;_++)a=s[_],w=a.getPoints(),o=r(w),o=t?!o:o,o?(!d&&g[y]&&y++,g[y]={s:new dr,p:w},g[y].s.curves=a.curves,d&&y++,m[y]=[]):m[y].push({h:a,p:w[0]});if(!g[0])return n(s);if(g.length>1){let _=!1;const v=[];for(let E=0,R=g.length;E<R;E++)h[E]=[];for(let E=0,R=g.length;E<R;E++){const p=m[E];for(let A=0;A<p.length;A++){const O=p[A];let H=!0;for(let ne=0;ne<g.length;ne++)i(O.p,g[ne].p)&&(E!==ne&&v.push({froms:E,tos:ne,hole:A}),H?(H=!1,h[ne].push(O)):_=!0);H&&h[E].push(O)}}v.length>0&&(_||(m=h))}let M;for(let _=0,v=g.length;_<v;_++){u=g[_].s,l.push(u),M=m[_];for(let E=0,R=M.length;E<R;E++)u.holes.push(M[E].h)}return l}});function Mf(t){this.type="Font",this.data=t}Object.assign(Mf.prototype,{isFont:!0,generateShapes:function(t,e){e===void 0&&(e=100);const n=[],i=h0(t,e,this.data);for(let r=0,s=i.length;r<s;r++)Array.prototype.push.apply(n,i[r].toShapes());return n}});function h0(t,e,n){const i=Array.from?Array.from(t):String(t).split(""),r=e/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[];let a=0,u=0;for(let l=0;l<i.length;l++){const d=i[l];if(d===`
`)a=0,u-=s;else{const h=f0(d,r,a,u,n);a+=h.offsetX,o.push(h.path)}}return o}function f0(t,e,n,i,r){const s=r.glyphs[t]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+r.familyName+".");return}const o=new wf;let a,u,l,d,h,g,m,y;if(s.o){const w=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let M=0,_=w.length;M<_;)switch(w[M++]){case"m":a=w[M++]*e+n,u=w[M++]*e+i,o.moveTo(a,u);break;case"l":a=w[M++]*e+n,u=w[M++]*e+i,o.lineTo(a,u);break;case"q":l=w[M++]*e+n,d=w[M++]*e+i,h=w[M++]*e+n,g=w[M++]*e+i,o.quadraticCurveTo(h,g,l,d);break;case"b":l=w[M++]*e+n,d=w[M++]*e+i,h=w[M++]*e+n,g=w[M++]*e+i,m=w[M++]*e+n,y=w[M++]*e+i,o.bezierCurveTo(h,g,m,y,l,d);break}}return{offsetX:s.ha*e,path:o}}function xh(t){St.call(this,t)}xh.prototype=Object.assign(Object.create(St.prototype),{constructor:xh,load:function(t,e,n,i){const r=this,s=new fi(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){let a;try{a=JSON.parse(o)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),a=JSON.parse(o.substring(65,o.length-2))}const u=r.parse(a);e&&e(u)},n,i)},parse:function(t){return new Mf(t)}});let oa;const d0={getContext:function(){return oa===void 0&&(oa=new(window.AudioContext||window.webkitAudioContext)),oa},setContext:function(t){oa=t}};function _h(t){St.call(this,t)}_h.prototype=Object.assign(Object.create(St.prototype),{constructor:_h,load:function(t,e,n,i){const r=this,s=new fi(r.manager);s.setResponseType("arraybuffer"),s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{const a=o.slice(0);d0.getContext().decodeAudioData(a,function(l){e(l)})}catch(a){i?i(a):console.error(a),r.manager.itemError(t)}},n,i)}});function bh(t,e,n){ei.call(this,void 0,n);const i=new He().set(t),r=new He().set(e),s=new P(i.r,i.g,i.b),o=new P(r.r,r.g,r.b),a=Math.sqrt(Math.PI),u=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(u)}bh.prototype=Object.assign(Object.create(ei.prototype),{constructor:bh,isHemisphereLightProbe:!0,copy:function(t){return ei.prototype.copy.call(this,t),this},toJSON:function(t){return ei.prototype.toJSON.call(this,t)}});function wh(t,e){ei.call(this,void 0,e);const n=new He().set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}wh.prototype=Object.assign(Object.create(ei.prototype),{constructor:wh,isAmbientLightProbe:!0,copy:function(t){return ei.prototype.copy.call(this,t),this},toJSON:function(t){return ei.prototype.toJSON.call(this,t)}});const Mh=new ht,Sh=new ht;function p0(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new en,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new en,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(p0.prototype,{update:function(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;const i=t.projectionMatrix.clone(),r=e.eyeSep/2,s=r*e.near/e.focus,o=e.near*Math.tan(at.DEG2RAD*e.fov*.5)/e.zoom;let a,u;Sh.elements[12]=-r,Mh.elements[12]=r,a=-o*e.aspect+s,u=o*e.aspect+s,i.elements[0]=2*e.near/(u-a),i.elements[8]=(u+a)/(u-a),this.cameraL.projectionMatrix.copy(i),a=-o*e.aspect-s,u=o*e.aspect-s,i.elements[0]=2*e.near/(u-a),i.elements[8]=(u+a)/(u-a),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Sh),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Mh)}});function Sf(t,e,n){this.binding=t,this.valueSize=n;let i,r,s;switch(e){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Sf.prototype,{accumulate:function(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let s=this.cumulativeWeight;if(s===0){for(let o=0;o!==i;++o)n[r+o]=n[o];s=e}else{s+=e;const o=e/s;this._mixBufferRegion(n,r,0,o,i)}this.cumulativeWeight=s},accumulateAdditive:function(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t},apply:function(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const a=e*this._origIndex;this._mixBufferRegion(n,i,a,1-r,e)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let a=e,u=e+e;a!==u;++a)if(n[a]!==n[a+e]){o.setValue(n,i);break}},saveOriginalState:function(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let r=n,s=i;r!==s;++r)e[r]=e[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]},_select:function(t,e,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)t[e+s]=t[n+s]},_slerp:function(t,e,n,i){mn.slerpFlat(t,e,t,e,t,n,i)},_slerpAdditive:function(t,e,n,i,r){const s=this._workIndex*r;mn.multiplyQuaternionsFlat(t,s,t,e,t,n),mn.slerpFlat(t,e,t,e,t,s,i)},_lerp:function(t,e,n,i,r){const s=1-i;for(let o=0;o!==r;++o){const a=e+o;t[a]=t[a]*s+t[n+o]*i}},_lerpAdditive:function(t,e,n,i,r){for(let s=0;s!==r;++s){const o=e+s;t[o]=t[o]+t[n+s]*i}}});const Nl="\\[\\]\\.:\\/",m0=new RegExp("["+Nl+"]","g"),Ol="[^"+Nl+"]",g0="[^"+Nl.replace("\\.","")+"]",y0=/((?:WC+[\/:])*)/.source.replace("WC",Ol),v0=/(WCOD+)?/.source.replace("WCOD",g0),x0=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ol),_0=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ol),b0=new RegExp("^"+y0+v0+x0+_0+"$"),w0=["material","materials","bones"];function Tf(t,e,n){const i=n||gn.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}Object.assign(Tf.prototype,{getValue:function(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(t,e)},setValue:function(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}});function gn(t,e,n){this.path=e,this.parsedPath=n||gn.parseTrackName(e),this.node=gn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(gn,{Composite:Tf,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new gn.Composite(t,e,n):new gn(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(m0,"")},parseTrackName:function(t){const e=b0.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const r=n.nodeName.substring(i+1);w0.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(n!==void 0)return n}if(t.children){const n=function(r){for(let s=0;s<r.length;s++){const o=r[s];if(o.name===e||o.uuid===e)return o;const a=n(o.children);if(a)return a}return null},i=n(t.children);if(i)return i}return null}});Object.assign(gn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,n){e[n]=this.node[this.propertyName]},function(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]},function(e,n){e[n]=this.resolvedProperty[this.propertyIndex]},function(e,n){this.resolvedProperty.toArray(e,n)}],SetterByBindingTypeAndVersioning:[[function(e,n){this.targetObject[this.propertyName]=e[n]},function(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0},function(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]},function(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0},function(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,n){this.resolvedProperty[this.propertyIndex]=e[n]},function(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0},function(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,n){this.resolvedProperty.fromArray(e,n)},function(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0},function(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,n){this.bind(),this.getValue(e,n)},setValue:function(e,n){this.bind(),this.setValue(e,n)},bind:function(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=gn.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let u=e.objectIndex;switch(n){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let l=0;l<t.length;l++)if(t[l].name===u){u=l;break}break;default:if(t[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[n]}if(u!==void 0){if(t[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[u]}}const s=t[i];if(s===void 0){const u=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",t);return}let o=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[r]!==void 0&&(r=t.morphTargetDictionary[r])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});Object.assign(gn.prototype,{_getValue_unbound:gn.prototype.getValue,_setValue_unbound:gn.prototype.setValue});function M0(){this.uuid=at.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,i=arguments.length;n!==i;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}Object.assign(M0.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,e=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let o,a=t.length,u=this.nCachedObjects_;for(let l=0,d=arguments.length;l!==d;++l){const h=arguments[l],g=h.uuid;let m=e[g];if(m===void 0){m=a++,e[g]=m,t.push(h);for(let y=0,w=s;y!==w;++y)r[y].push(new gn(h,n[y],i[y]))}else if(m<u){o=t[m];const y=--u,w=t[y];e[w.uuid]=m,t[m]=w,e[g]=y,t[y]=h;for(let M=0,_=s;M!==_;++M){const v=r[M],E=v[y];let R=v[m];v[m]=E,R===void 0&&(R=new gn(h,n[M],i[M])),v[y]=R}}else t[m]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u},remove:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const a=arguments[s],u=a.uuid,l=e[u];if(l!==void 0&&l>=r){const d=r++,h=t[d];e[h.uuid]=l,t[l]=h,e[u]=d,t[d]=a;for(let g=0,m=i;g!==m;++g){const y=n[g],w=y[d],M=y[l];y[l]=w,y[d]=M}}}this.nCachedObjects_=r},uncache:function(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=t.length;for(let o=0,a=arguments.length;o!==a;++o){const u=arguments[o],l=u.uuid,d=e[l];if(d!==void 0)if(delete e[l],d<r){const h=--r,g=t[h],m=--s,y=t[m];e[g.uuid]=d,t[d]=g,e[y.uuid]=h,t[h]=y,t.pop();for(let w=0,M=i;w!==M;++w){const _=n[w],v=_[h],E=_[m];_[d]=v,_[h]=E,_.pop()}}else{const h=--s,g=t[h];h>0&&(e[g.uuid]=d),t[d]=g,t.pop();for(let m=0,y=i;m!==y;++m){const w=n[m];w[d]=w[h],w.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){const n=this._bindingsIndicesByPath;let i=n[t];const r=this._bindings;if(i!==void 0)return r[i];const s=this._paths,o=this._parsedPaths,a=this._objects,u=a.length,l=this.nCachedObjects_,d=new Array(u);i=r.length,n[t]=i,s.push(t),o.push(e),r.push(d);for(let h=l,g=a.length;h!==g;++h){const m=a[h];d[h]=new gn(m,t,e)}return d},unsubscribe_:function(t){const e=this._bindingsIndicesByPath,n=e[t];if(n!==void 0){const i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o],u=t[o];e[u]=n,s[n]=a,s.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}});class S0{constructor(e,n,i,r){this._mixer=e,this._clip=n,this._localRoot=i||null,this.blendMode=r||n.blendMode;const s=n.tracks,o=s.length,a=new Array(o),u={endingStart:Jr,endingEnd:Jr};for(let l=0;l!==o;++l){const d=s[l].createInterpolant(null);a[l]=d,d.settings=u}this._interpolantSettings=u,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Bp,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const u=a.parameterPositions,l=a.sampleValues;return u[0]=s,u[1]=s+i,l[0]=e/o,l[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const u=(e-s)*i;if(u<0||i===0)return;this._startTime=null,n=i*u}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const u=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case Fh:for(let d=0,h=u.length;d!==h;++d)u[d].evaluate(o),l[d].accumulateAdditive(a);break;case Al:default:for(let d=0,h=u.length;d!==h;++d)u[d].evaluate(o),l[d].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===Fp;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===Op){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){const a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);const u=this.repetitions-s;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const l=e<0;this._setEndings(l,!l,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=$r,r.endingEnd=$r):(e?r.endingStart=this.zeroSlopeAtStart?$r:Jr:r.endingStart=ga,n?r.endingEnd=this.zeroSlopeAtEnd?$r:Jr:r.endingEnd=ga)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,u=o.sampleValues;return a[0]=s,u[0]=n,a[1]=s+e,u[1]=i,this}}function Th(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Th.prototype=Object.assign(Object.create(ti.prototype),{constructor:Th,_bindAction:function(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,s=t._propertyBindings,o=t._interpolants,a=n.uuid,u=this._bindingsByRootAndName;let l=u[a];l===void 0&&(l={},u[a]=l);for(let d=0;d!==r;++d){const h=i[d],g=h.name;let m=l[g];if(m!==void 0)s[d]=m;else{if(m=s[d],m!==void 0){m._cacheIndex===null&&(++m.referenceCount,this._addInactiveBinding(m,a,g));continue}const y=e&&e._propertyBindings[d].binding.parsedPath;m=new Sf(gn.create(n,g,y),h.ValueTypeName,h.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,a,g),s[d]=m}o[d].resultBuffer=m.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const n=(t._localRoot||this._root).uuid,i=t._clip.uuid,r=this._actionsByClip[i];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,i,n)}const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const r=e[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const r=e[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const e=t._cacheIndex;return e!==null&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){const i=this._actions,r=this._actionsByClip;let s=r[e];if(s===void 0)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{const o=s.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=i.length,i.push(t),s.actionByRoot[n]=t},_removeInactiveAction:function(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,u=a[a.length-1],l=t._byClipCacheIndex;u._byClipCacheIndex=l,a[l]=u,a.pop(),t._byClipCacheIndex=null;const d=o.actionByRoot,h=(t._localRoot||this._root).uuid;delete d[h],a.length===0&&delete s[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const r=e[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}},_lendAction:function(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[e];s===void 0&&(s={},i[e]=s),s[n]=t,t._cacheIndex=r.length,r.push(t)},_removeInactiveBinding:function(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,o=s[i],a=e[e.length-1],u=t._cacheIndex;a._cacheIndex=u,e[u]=a,e.pop(),delete o[r],Object.keys(o).length===0&&delete s[i]},_lendBinding:function(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return n===void 0&&(n=new ba(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,n){const i=e||this._root,r=i.uuid;let s=typeof t=="string"?Jn.findByName(i,t):t;const o=s!==null?s.uuid:t,a=this._actionsByClip[o];let u=null;if(n===void 0&&(s!==null?n=s.blendMode:n=Al),a!==void 0){const d=a.actionByRoot[r];if(d!==void 0&&d.blendMode===n)return d;u=a.knownActions[0],s===null&&(s=u._clip)}if(s===null)return null;const l=new S0(this,s,e,n);return this._bindAction(l,u),this._addInactiveAction(l,o,r),l},existingAction:function(t,e){const n=e||this._root,i=n.uuid,r=typeof t=="string"?Jn.findByName(n,t):t,s=r?r.uuid:t,o=this._actionsByClip[s];return o!==void 0&&o.actionByRoot[i]||null},stopAllAction:function(){const t=this._actions,e=this._nActiveActions;for(let n=e-1;n>=0;--n)t[n].stop();return this},update:function(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1;for(let u=0;u!==n;++u)e[u]._update(i,t,r,s);const o=this._bindings,a=this._nActiveBindings;for(let u=0;u!==a;++u)o[u].apply(s);return this},setTime:function(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(r!==void 0){const s=r.knownActions;for(let o=0,a=s.length;o!==a;++o){const u=s[o];this._deactivateAction(u);const l=u._cacheIndex,d=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,d._cacheIndex=l,e[l]=d,e.pop(),this._removeInactiveBindingsForAction(u)}delete i[n]}},uncacheRoot:function(t){const e=t.uuid,n=this._actionsByClip;for(const s in n){const o=n[s].actionByRoot,a=o[e];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}const i=this._bindingsByRootAndName,r=i[e];if(r!==void 0)for(const s in r){const o=r[s];o.restoreOriginalState(),this._removeInactiveBinding(o)}},uncacheAction:function(t,e){const n=this.existingAction(t,e);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}});function Eh(t,e,n){On.call(this,t,e),this.meshPerAttribute=n||1}Eh.prototype=Object.assign(Object.create(On.prototype),{constructor:Eh,isInstancedInterleavedBuffer:!0,copy:function(t){return On.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const e=On.prototype.clone.call(this,t);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(t){const e=On.prototype.toJSON.call(this,t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}});function Ef(t,e,n,i,r){this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}Object.defineProperty(Ef.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}});Object.assign(Ef.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}});function Af(t,e,n,i){this.ray=new ho(t,e),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new kh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ah(t,e){return t.distance-e.distance}function wl(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)wl(r[s],e,n,!0)}}Object.assign(Af.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){const i=n||[];return wl(t,this,i,e),i.sort(Ah),i},intersectObjects:function(t,e,n){const i=n||[];if(Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(let r=0,s=t.length;r<s;r++)wl(t[r],this,i,e);return i.sort(Ah),i}});class Lh{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}clone(){return new this.constructor().copy(this)}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(at.clamp(n/this.radius,-1,1))),this}}const Ch=new oe;class T0{constructor(e,n){Object.defineProperty(this,"isBox2",{value:!0}),this.min=e!==void 0?e:new oe(1/0,1/0),this.max=n!==void 0?n:new oe(-1/0,-1/0)}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=Ch.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new oe),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new oe),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new oe),n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new oe),n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ch.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}function Ta(t){je.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Ta.prototype=Object.create(je.prototype);Ta.prototype.constructor=Ta;Ta.prototype.isImmediateRenderObject=!0;const Vi=new P,aa=new ht,Ic=new ht;class E0 extends Zs{constructor(e){const n=Lf(e),i=new lt,r=[],s=[],o=new He(0,0,1),a=new He(0,1,0);for(let l=0;l<n.length;l++){const d=n[l];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new Ue(r,3)),i.setAttribute("color",new Ue(s,3));const u=new zn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,u),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");Ic.getInverse(this.root.matrixWorld);for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(aa.multiplyMatrices(Ic,a.matrixWorld),Vi.setFromMatrixPosition(aa),r.setXYZ(o,Vi.x,Vi.y,Vi.z),aa.multiplyMatrices(Ic,a.parent.matrixWorld),Vi.setFromMatrixPosition(aa),r.setXYZ(o+1,Vi.x,Vi.y,Vi.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Lf(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,Lf(t.children[n]));return e}class A0 extends Zs{constructor(e,n,i,r){e=e||10,n=n||10,i=new He(i!==void 0?i:4473924),r=new He(r!==void 0?r:8947848);const s=n/2,o=e/n,a=e/2,u=[],l=[];for(let g=0,m=0,y=-a;g<=n;g++,y+=o){u.push(-a,0,y,a,0,y),u.push(y,0,-a,y,0,a);const w=g===s?i:r;w.toArray(l,m),m+=3,w.toArray(l,m),m+=3,w.toArray(l,m),m+=3,w.toArray(l,m),m+=3}const d=new lt;d.setAttribute("position",new Ue(u,3)),d.setAttribute("color",new Ue(l,3));const h=new zn({vertexColors:!0,toneMapped:!1});super(d,h),this.type="GridHelper"}}Ve.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Ve.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t};Object.assign(Xi.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const e=new Lt;for(let n=0,i=t.length;n<i;n++){const r=t[n];e.vertices.push(new P(r.x,r.y,r.z||0))}return e}});Object.assign(ui.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}});Object.create(Pn.prototype);Object.create(Pn.prototype);function Cf(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Pn.call(this,t),this.type="catmullrom"}Cf.prototype=Object.create(Pn.prototype);Object.assign(Cf.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});A0.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};E0.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(St.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),bf.extractUrlBase(t)}});St.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Object.assign(T0.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}});Object.assign(Ki.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}});Object.assign(er.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}});Oa.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)};Object.assign(at,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),at.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),at.ceilPowerOfTwo(t)}});Object.assign(_n.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(ht.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new P().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,s)}});Ai.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)};mn.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)};Object.assign(ho.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}});Object.assign(hn.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}});Object.assign(hn,{barycoordFromPoint:function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),hn.getBarycoord(t,e,n,i,r)},normal:function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),hn.getNormal(t,e,n,i)}});Object.assign(dr.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new af(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new df(this,t)}});Object.assign(oe.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(P.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(At.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Lt.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}});Object.assign(je.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}});Object.defineProperties(je.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.assign(Jt.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}});Object.defineProperties(Jt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),zp},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});Object.defineProperties(ya.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}});Object.defineProperty(Jc.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Zc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(Ve.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}});en.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(t)};Object.defineProperties(Nt.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}});Object.defineProperties(ct.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ws},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ws)}}});Object.assign(ct.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?Ws:Ia),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(lt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new ct(arguments[1],arguments[2]))):t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e)},addDrawCall:function(t,e,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}});Object.defineProperties(lt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Object.defineProperties(Sa.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}});Object.defineProperties(Af.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}});Object.defineProperties(On.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Ws},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}});Object.assign(On.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?Ws:Ia),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(Fa.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.assign(Pl.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}});Object.defineProperties(Ye.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new He}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===Ih}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}});Object.defineProperties(Sr.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(Mr.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}});Object.defineProperties(bn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}});Object.assign(po.prototype,{clearTarget:function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}});Object.defineProperties(po.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?zh:uo}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties($h.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Kn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}});ss.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};ss.prototype.clear=function(t,e,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,i)};pr.crossOrigin=void 0;pr.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new ul;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s};pr.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new ll;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s};pr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};pr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:pd}}));var Ml=function(){};Ml.prototype={constructor:Ml,parse:function(t,e){e===void 0&&(e={});var n=e.binary!==void 0?e.binary:!1,i=[],r=0;t.traverse(function(j){if(j.isMesh){var Y=j.geometry;Y.isGeometry&&(Y=new lt().fromGeometry(Y));var Q=Y.index,X=Y.getAttribute("position");r+=Q!==null?Q.count/3:X.count/3,i.push({object3d:j,geometry:Y})}});var s,o=80;if(n===!0){var a=r*2+r*3*4*4+80+4,u=new ArrayBuffer(a);s=new DataView(u),s.setUint32(o,r,!0),o+=4}else s="",s+=`solid exported
`;for(var l=new P,d=new P,h=new P,g=new P,m=new P,y=new P,w=0,M=i.length;w<M;w++){var _=i[w].object3d,v=i[w].geometry,E=v.index,R=v.getAttribute("position");if(E!==null)for(var p=0;p<E.count;p+=3){var A=E.getX(p+0),O=E.getX(p+1),H=E.getX(p+2);ne(A,O,H,R,_)}else for(var p=0;p<R.count;p+=3){var A=p+0,O=p+1,H=p+2;ne(A,O,H,R,_)}}return n===!1&&(s+=`endsolid exported
`),s;function ne(j,Y,Q,X,Z){l.fromBufferAttribute(X,j),d.fromBufferAttribute(X,Y),h.fromBufferAttribute(X,Q),Z.isSkinnedMesh===!0&&(Z.boneTransform(j,l),Z.boneTransform(Y,d),Z.boneTransform(Q,h)),l.applyMatrix4(Z.matrixWorld),d.applyMatrix4(Z.matrixWorld),h.applyMatrix4(Z.matrixWorld),se(l,d,h),B(l),B(d),B(h),n===!0?(s.setUint16(o,0,!0),o+=2):(s+=`		endloop
`,s+=`	endfacet
`)}function se(j,Y,Q){g.subVectors(Q,Y),m.subVectors(j,Y),g.cross(m).normalize(),y.copy(g).normalize(),n===!0?(s.setFloat32(o,y.x,!0),o+=4,s.setFloat32(o,y.y,!0),o+=4,s.setFloat32(o,y.z,!0),o+=4):(s+="	facet normal "+y.x+" "+y.y+" "+y.z+`
`,s+=`		outer loop
`)}function B(j){n===!0?(s.setFloat32(o,j.x,!0),o+=4,s.setFloat32(o,j.y,!0),o+=4,s.setFloat32(o,j.z,!0),o+=4):s+="			vertex "+j.x+" "+j.y+" "+j.z+`
`}}};var co=function(t,e){e===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new P,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:Wi.ROTATE,MIDDLE:Wi.DOLLY,RIGHT:Wi.PAN},this.touches={ONE:ji.ROTATE,TWO:ji.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),a=o.NONE},this.update=(function(){var k=new P,xe=new mn().setFromUnitVectors(t.up,new P(0,1,0)),Pe=xe.clone().inverse(),Me=new P,ze=new mn,gt=2*Math.PI;return function(){var $t=n.object.position;k.copy($t).sub(n.target),k.applyQuaternion(xe),l.setFromVector3(k),n.autoRotate&&a===o.NONE&&ne(O()),n.enableDamping?(l.theta+=d.theta*n.dampingFactor,l.phi+=d.phi*n.dampingFactor):(l.theta+=d.theta,l.phi+=d.phi);var Rt=n.minAzimuthAngle,on=n.maxAzimuthAngle;return isFinite(Rt)&&isFinite(on)&&(Rt<-Math.PI?Rt+=gt:Rt>Math.PI&&(Rt-=gt),on<-Math.PI?on+=gt:on>Math.PI&&(on-=gt),Rt<on?l.theta=Math.max(Rt,Math.min(on,l.theta)):l.theta=l.theta>(Rt+on)/2?Math.max(Rt,l.theta):Math.min(on,l.theta)),l.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=h,l.radius=Math.max(n.minDistance,Math.min(n.maxDistance,l.radius)),n.enableDamping===!0?n.target.addScaledVector(g,n.dampingFactor):n.target.add(g),k.setFromSpherical(l),k.applyQuaternion(Pe),$t.copy(n.target).add(k),n.object.lookAt(n.target),n.enableDamping===!0?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,g.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),g.set(0,0,0)),h=1,m||Me.distanceToSquared(n.object.position)>u||8*(1-ze.dot(n.object.quaternion))>u?(n.dispatchEvent(i),Me.copy(n.object.position),ze.copy(n.object.quaternion),m=!1,!0):!1}})(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Se,!1),n.domElement.removeEventListener("pointerdown",_e,!1),n.domElement.removeEventListener("wheel",fe,!1),n.domElement.removeEventListener("touchstart",ge,!1),n.domElement.removeEventListener("touchend",Be,!1),n.domElement.removeEventListener("touchmove",Ee,!1),n.domElement.ownerDocument.removeEventListener("pointermove",ke,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Le,!1),n.domElement.removeEventListener("keydown",G,!1)};var n=this,i={type:"change"},r={type:"start"},s={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},a=o.NONE,u=1e-6,l=new Lh,d=new Lh,h=1,g=new P,m=!1,y=new oe,w=new oe,M=new oe,_=new oe,v=new oe,E=new oe,R=new oe,p=new oe,A=new oe;function O(){return 2*Math.PI/60/60*n.autoRotateSpeed}function H(){return Math.pow(.95,n.zoomSpeed)}function ne(k){d.theta-=k}function se(k){d.phi-=k}var B=(function(){var k=new P;return function(Pe,Me){k.setFromMatrixColumn(Me,0),k.multiplyScalar(-Pe),g.add(k)}})(),j=(function(){var k=new P;return function(Pe,Me){n.screenSpacePanning===!0?k.setFromMatrixColumn(Me,1):(k.setFromMatrixColumn(Me,0),k.crossVectors(n.object.up,k)),k.multiplyScalar(Pe),g.add(k)}})(),Y=(function(){var k=new P;return function(Pe,Me){var ze=n.domElement;if(n.object.isPerspectiveCamera){var gt=n.object.position;k.copy(gt).sub(n.target);var Gt=k.length();Gt*=Math.tan(n.object.fov/2*Math.PI/180),B(2*Pe*Gt/ze.clientHeight,n.object.matrix),j(2*Me*Gt/ze.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(B(Pe*(n.object.right-n.object.left)/n.object.zoom/ze.clientWidth,n.object.matrix),j(Me*(n.object.top-n.object.bottom)/n.object.zoom/ze.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function Q(k){n.object.isPerspectiveCamera?h/=k:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*k)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function X(k){n.object.isPerspectiveCamera?h*=k:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/k)),n.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Z(k){y.set(k.clientX,k.clientY)}function le(k){R.set(k.clientX,k.clientY)}function de(k){_.set(k.clientX,k.clientY)}function we(k){w.set(k.clientX,k.clientY),M.subVectors(w,y).multiplyScalar(n.rotateSpeed);var xe=n.domElement;ne(2*Math.PI*M.x/xe.clientHeight),se(2*Math.PI*M.y/xe.clientHeight),y.copy(w),n.update()}function Ne(k){p.set(k.clientX,k.clientY),A.subVectors(p,R),A.y>0?Q(H()):A.y<0&&X(H()),R.copy(p),n.update()}function Re(k){v.set(k.clientX,k.clientY),E.subVectors(v,_).multiplyScalar(n.panSpeed),Y(E.x,E.y),_.copy(v),n.update()}function Je(k){k.deltaY<0?X(H()):k.deltaY>0&&Q(H()),n.update()}function tt(k){var xe=!1;switch(k.keyCode){case n.keys.UP:Y(0,n.keyPanSpeed),xe=!0;break;case n.keys.BOTTOM:Y(0,-n.keyPanSpeed),xe=!0;break;case n.keys.LEFT:Y(n.keyPanSpeed,0),xe=!0;break;case n.keys.RIGHT:Y(-n.keyPanSpeed,0),xe=!0;break}xe&&(k.preventDefault(),n.update())}function _t(k){if(k.touches.length==1)y.set(k.touches[0].pageX,k.touches[0].pageY);else{var xe=.5*(k.touches[0].pageX+k.touches[1].pageX),Pe=.5*(k.touches[0].pageY+k.touches[1].pageY);y.set(xe,Pe)}}function ue(k){if(k.touches.length==1)_.set(k.touches[0].pageX,k.touches[0].pageY);else{var xe=.5*(k.touches[0].pageX+k.touches[1].pageX),Pe=.5*(k.touches[0].pageY+k.touches[1].pageY);_.set(xe,Pe)}}function bt(k){var xe=k.touches[0].pageX-k.touches[1].pageX,Pe=k.touches[0].pageY-k.touches[1].pageY,Me=Math.sqrt(xe*xe+Pe*Pe);R.set(0,Me)}function We(k){n.enableZoom&&bt(k),n.enablePan&&ue(k)}function ft(k){n.enableZoom&&bt(k),n.enableRotate&&_t(k)}function Ke(k){if(k.touches.length==1)w.set(k.touches[0].pageX,k.touches[0].pageY);else{var xe=.5*(k.touches[0].pageX+k.touches[1].pageX),Pe=.5*(k.touches[0].pageY+k.touches[1].pageY);w.set(xe,Pe)}M.subVectors(w,y).multiplyScalar(n.rotateSpeed);var Me=n.domElement;ne(2*Math.PI*M.x/Me.clientHeight),se(2*Math.PI*M.y/Me.clientHeight),y.copy(w)}function it(k){if(k.touches.length==1)v.set(k.touches[0].pageX,k.touches[0].pageY);else{var xe=.5*(k.touches[0].pageX+k.touches[1].pageX),Pe=.5*(k.touches[0].pageY+k.touches[1].pageY);v.set(xe,Pe)}E.subVectors(v,_).multiplyScalar(n.panSpeed),Y(E.x,E.y),_.copy(v)}function Ze(k){var xe=k.touches[0].pageX-k.touches[1].pageX,Pe=k.touches[0].pageY-k.touches[1].pageY,Me=Math.sqrt(xe*xe+Pe*Pe);p.set(0,Me),A.set(0,Math.pow(p.y/R.y,n.zoomSpeed)),Q(A.y),R.copy(p)}function me(k){n.enableZoom&&Ze(k),n.enablePan&&it(k)}function ie(k){n.enableZoom&&Ze(k),n.enableRotate&&Ke(k)}function _e(k){if(n.enabled!==!1)switch(k.pointerType){case"mouse":case"pen":N(k);break}}function ke(k){if(n.enabled!==!1)switch(k.pointerType){case"mouse":case"pen":D(k);break}}function Le(k){if(n.enabled!==!1)switch(k.pointerType){case"mouse":case"pen":ve();break}}function N(k){k.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus();var xe;switch(k.button){case 0:xe=n.mouseButtons.LEFT;break;case 1:xe=n.mouseButtons.MIDDLE;break;case 2:xe=n.mouseButtons.RIGHT;break;default:xe=-1}switch(xe){case Wi.DOLLY:if(n.enableZoom===!1)return;le(k),a=o.DOLLY;break;case Wi.ROTATE:if(k.ctrlKey||k.metaKey||k.shiftKey){if(n.enablePan===!1)return;de(k),a=o.PAN}else{if(n.enableRotate===!1)return;Z(k),a=o.ROTATE}break;case Wi.PAN:if(k.ctrlKey||k.metaKey||k.shiftKey){if(n.enableRotate===!1)return;Z(k),a=o.ROTATE}else{if(n.enablePan===!1)return;de(k),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&(n.domElement.ownerDocument.addEventListener("pointermove",ke,!1),n.domElement.ownerDocument.addEventListener("pointerup",Le,!1),n.dispatchEvent(r))}function D(k){if(n.enabled!==!1)switch(k.preventDefault(),a){case o.ROTATE:if(n.enableRotate===!1)return;we(k);break;case o.DOLLY:if(n.enableZoom===!1)return;Ne(k);break;case o.PAN:if(n.enablePan===!1)return;Re(k);break}}function ve(k){n.enabled!==!1&&(n.domElement.ownerDocument.removeEventListener("pointermove",ke,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Le,!1),n.dispatchEvent(s),a=o.NONE)}function fe(k){n.enabled===!1||n.enableZoom===!1||a!==o.NONE&&a!==o.ROTATE||(k.preventDefault(),k.stopPropagation(),n.dispatchEvent(r),Je(k),n.dispatchEvent(s))}function G(k){n.enabled===!1||n.enableKeys===!1||n.enablePan===!1||tt(k)}function ge(k){if(n.enabled!==!1){switch(k.preventDefault(),k.touches.length){case 1:switch(n.touches.ONE){case ji.ROTATE:if(n.enableRotate===!1)return;_t(k),a=o.TOUCH_ROTATE;break;case ji.PAN:if(n.enablePan===!1)return;ue(k),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(n.touches.TWO){case ji.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;We(k),a=o.TOUCH_DOLLY_PAN;break;case ji.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ft(k),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(r)}}function Ee(k){if(n.enabled!==!1)switch(k.preventDefault(),k.stopPropagation(),a){case o.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ke(k),n.update();break;case o.TOUCH_PAN:if(n.enablePan===!1)return;it(k),n.update();break;case o.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;me(k),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ie(k),n.update();break;default:a=o.NONE}}function Be(k){n.enabled!==!1&&(n.dispatchEvent(s),a=o.NONE)}function Se(k){n.enabled!==!1&&k.preventDefault()}n.domElement.addEventListener("contextmenu",Se,!1),n.domElement.addEventListener("pointerdown",_e,!1),n.domElement.addEventListener("wheel",fe,!1),n.domElement.addEventListener("touchstart",ge,!1),n.domElement.addEventListener("touchend",Be,!1),n.domElement.addEventListener("touchmove",Ee,!1),n.domElement.addEventListener("keydown",G,!1),n.domElement.tabIndex===-1&&(n.domElement.tabIndex=0),this.update()};co.prototype=Object.create(ti.prototype);co.prototype.constructor=co;var Sl=function(t,e){co.call(this,t,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Wi.PAN,this.mouseButtons.RIGHT=Wi.ROTATE,this.touches.ONE=ji.PAN,this.touches.TWO=ji.DOLLY_ROTATE};Sl.prototype=Object.create(ti.prototype);Sl.prototype.constructor=Sl;const Ns={A:{max:2,width:23.109700679779053},B:{max:3,width:19.017000198364258},C:{max:1,width:19.058271646499634},D:{max:2,width:20.401854515075684},E:{max:3,width:16.26773953437805},F:{max:2,width:16.267741918563843},G:{max:1,width:20.401855939999223},H:{max:2,width:19.347654465255744},I:{max:2,width:17.073892239151007},J:{max:1,width:15.15152987325564},K:{max:2,width:19.864419582901007},L:{max:1,width:16.577800512313843},M:{max:2,width:21.414666175842285},N:{max:3,width:19.55435037612915},O:{max:2,width:21.67150041554123},P:{max:2,width:18.747650384902954},Q:{max:2,width:22.547575936769135},R:{max:3,width:19.59594954795648},S:{max:1,width:19.058250188827657},T:{max:2,width:19.967575344853685},U:{max:2,width:19.67769980430603},V:{max:2,width:23.27507495880127},W:{max:3,width:21.931424140930176},X:{max:2,width:22.944350242614746},Y:{max:2,width:22.820274829864502},Z:{max:1,width:18.9755750041968},0:{max:2,width:21.084},1:{max:2,width:18.748},2:{max:1,width:18.459},3:{max:1,width:18.211},4:{max:2,width:21.58},5:{max:1,width:17.57},6:{max:1,width:19.658},7:{max:1,width:18.769},8:{max:2,width:19.058},9:{max:1,width:19.637}};var Dt,hi,rn,$n,ai,be,Oe={};const L0=new l0;var ci;async function C0(){const t=document.querySelector("#c"),e=getComputedStyle(document.querySelector("body"));t.width=parseInt(e.getPropertyValue("width")),t.height=parseInt(e.getPropertyValue("height")),$n=new po({canvas:t,logarithmicDepthBuffer:!0}),$n.setClearColor(1184274);var n=new oe;$n.getSize(n);const i=n.y/n.x,r=300;Dt=new ao(r/-2+40,r/2+40,r/2*i,r/-2*i,.01,1e4),Dt.position.x=40,Dt.position.y=40,Dt.position.z=40,hi=new co(Dt,$n.domElement),hi.addEventListener("change",Of),rn=new Pl;const s=new Ma(1052688);rn.add(s);for(var o=0;o<10;o++){var a=new oo(16777215,.08,0,2);a.position.set(-300+100*o,300,500),rn.add(a);const u=new oo(16764108,.12,0,2);u.position.set(2e3,400,-300-100*o),rn.add(u)}Rf()}function Rh(t,e){Oe[t+"Word"]=e,Oe[t]=[],e=e.toUpperCase();var n=0;for(var i in e){if(e[i]==" "){n+=20;continue}Ns[e[i]]&&(Oe[t].push({letter:e[i],profiles:Ns[e[i]].max,width:Ns[e[i]].width,pos:n}),n+=Ns[e[i]].width+3)}Oe[t+"Width"]=n-3}function Ph(t,e=!1){for(var n=3;n>1;){for(var i in Oe[t])if(Oe[t][i].profiles==n&&(Oe[t][i].profiles==Ns[Oe[t][i].letter].max||e))return Oe[t][i].profiles--,!0;n--}return!1}function Wt(t){var e=0;for(var n in Oe[t])e+=Oe[t][n].profiles;return e}async function Rf(){$("#generate").text("Stop generating");for(var t=rn.children.length-1;t>=0;t--)rn.children[t]instanceof Jt&&rn.remove(rn.children[t]);var e=$("#first").val();e||(e="Default"),Rh("first",e);var n=$("#last").val();n||(n="Example"),Rh("last",n),za();for(var i=!1;Wt("first")>Wt("last");)if(!Ph("first",i)){if(i||$("#minimize:checked").length>0)break;if(confirm(`The first word is too complex!
The generation can continue, but the result may look kinda lame.`))i=!0;else return}for(;Wt("first")<Wt("last");)if(!Ph("last",i)){if(i||$("#minimize:checked").length>0)break;if(confirm(`The second word is too complex!
The generation can continue, but the result may look kinda lame.`))i=!0;else return}if(console.log(`Sum of first profiles: ${Wt("first")}`),console.log(`Sum of last profiles: ${Wt("last")}`),Wt("first")<Wt("last")&&$("#minimize:checked").length==0){for(var t=0;Wt("first")<Wt("last");){var r={};r=Object.assign(r,Oe.first[t]),Oe.first.push(r),t++}for(t=Oe.first.length;Wt("first")>Wt("last");)t--,Oe.first[t].profiles--}if(Wt("first")>Wt("last")&&$("#minimize:checked").length==0){for(var t=0;Wt("first")>Wt("last");){var r={};r=Object.assign(r,Oe.last[t]),Oe.last.push(r),t++}for(t=Oe.last.length;Wt("first")<Wt("last");)t--,Oe.last[t].profiles--}if(ci&&ci.terminate(),ci=new Worker("./worker.js"),ci.onmessage=s=>{if(s.data.type=="Add"){var o=L0.parse(s.data.geometry);rn.add(o),s.data.after&&(s.data.after.r&&o.rotateOnWorldAxis(new P(0,1,0),s.data.after.r),s.data.after.x&&o.translateX(s.data.after.x),s.data.after.y&&o.translateY(s.data.after.y),s.data.after.z&&o.translateZ(s.data.after.z))}else if(s.data.type=="Del"){var a=rn.getObjectByName(s.data.name);rn.remove(a)}else if(s.data.type=="Done")ci.terminate(),ci=void 0,$("#generate").text("Generate!");else if(s.data.type=="Clear")for(var u=rn.children.length-1;u>=0;u--)rn.children[u]instanceof Jt&&rn.remove(rn.children[u])},$("#minimize:checked").length>0){for(let l in Oe.first)Oe.first[l].profiles=1;for(let l in Oe.last)Oe.last[l].profiles=1;let s=Wt("first")/Wt("last"),o=0,a=0,u=Wt("last");for(let l=0;l<u;l++){a+=s;let d=Math.round(a-1e-8);if(d-o==0&&(Oe.first.splice(o,0,Oe.first[o]),l--),d-o>=1&&o++,d-o>=1){for(let h=0;h<d-o;h++)Oe.last.splice(o-1,0,Oe.last[o-1]);o=d}}}console.log(Oe),ci.postMessage([Oe,$("#base:checked").length>0,$("#quality:checked").length>0,$("#union:checked").length>0,$("#minimize:checked").length>0])}function R0(){var t=new Ml,e=t.parse(rn),n=new Blob([e],{type:"text/plain"});saveAs(n,`${Oe.firstWord}${Oe.lastWord}.stl`)}function P0(){ai=new GIF({workers:10,quality:10,background:1118481,debug:!1,workerScript:"./libs/gif.worker.js"}),be={pauseDelay:1e3,frameDelay:30,frameAmount:50,a:{x:Math.max(Oe.firstWidth,Oe.lastWidth)*1.5,y:Math.max(Oe.firstWidth,Oe.lastWidth)*1.5,z:Math.max(Oe.firstWidth,Oe.lastWidth)*1.5,width:Math.hypot(Oe.firstWidth,Oe.lastWidth)*1.4},b:{x:0,y:0,z:Math.max(Oe.firstWidth,Oe.lastWidth)*1.5+Oe.lastWidth/2,width:Oe.firstWidth*1.2},c:{x:Math.max(Oe.firstWidth,Oe.lastWidth)*1.5+Oe.firstWidth/2,y:0,z:0,width:Oe.lastWidth*1.2},state:0},za()}function D0(){switch(be.state){case 0:case 2:case 4:ai.addFrame($n.domElement,{delay:be.pauseDelay,copy:!0}),be.step=0,be.state++;break;case 1:ai.addFrame($n.domElement,{delay:be.frameDelay,copy:!0}),is((be.a.x-be.b.x)*(1-be.step/be.frameAmount)+be.b.x,(be.a.y-be.b.y)*(1-be.step/be.frameAmount)+be.b.y,(be.a.z-be.b.z)*(1-be.step/be.frameAmount)+be.b.z,(be.a.width-be.b.width)*(1-be.step/be.frameAmount)+be.b.width),be.step++,be.step>be.frameAmount&&(Pf(),be.state++);break;case 3:ai.addFrame($n.domElement,{delay:be.frameDelay,copy:!0}),is((be.b.x-be.c.x)*(1-be.step/be.frameAmount)+be.c.x,(be.b.y-be.c.y)*(1-be.step/be.frameAmount)+be.c.y,(be.b.z-be.c.z)*(1-be.step/be.frameAmount)+be.c.z,(be.b.width-be.c.width)*(1-be.step/be.frameAmount)+be.c.width),be.step++,be.step>be.frameAmount&&(Df(),be.state++);break;case 5:ai.addFrame($n.domElement,{delay:be.frameDelay,copy:!0}),is((be.c.x-be.a.x)*(1-be.step/be.frameAmount)+be.a.x,(be.c.y-be.a.y)*(1-be.step/be.frameAmount)+be.a.y,(be.c.z-be.a.z)*(1-be.step/be.frameAmount)+be.a.z,(be.c.width-be.a.width)*(1-be.step/be.frameAmount)+be.a.width),be.step++,be.step>be.frameAmount&&(za(),be.state++);break;case 6:ai.on("start",()=>{$("#gifText").text("Rendering... 0%")}),ai.on("progress",t=>{$("#gifText").text(`Rendering... ${Math.floor(t*100)}%`)}),ai.on("finished",t=>{saveAs(t,`${Oe.firstWord}${Oe.lastWord}Render.gif`),$("#gif").prop("disabled",!1),$("#gif").prop("hidden",!1),$("#gifText").text("Render GIF"),$("#gifText").prop("hidden",!0),$("#generate").prop("disabled",!1),be.state++}),hi.enabled=!0,ai.render(),be.state++;break;case 7:break;case 8:be=void 0,ai=void 0;break;default:console.error("Something happened, we should not be here")}}function is(t,e,n,i){var r=new oe;$n.getSize(r);const s=r.y/r.x;Dt.position.x=t,Dt.position.y=e,Dt.position.z=n,Dt.left=i/-2,Dt.right=i/2,Dt.top=(Dt.right-Dt.left)*s/2+10,Dt.bottom=(Dt.right-Dt.left)*s/-2+10,Dt.zoom=1,Dt.updateProjectionMatrix(),hi.update()}function za(){is(Math.max(Oe.firstWidth,Oe.lastWidth)*1.5,Math.max(Oe.firstWidth,Oe.lastWidth)*1.5,Math.max(Oe.firstWidth,Oe.lastWidth)*1.5,Math.hypot(Oe.firstWidth,Oe.lastWidth)*1.4)}function Pf(){is(0,0,Math.max(Oe.firstWidth,Oe.lastWidth)*1.5+Oe.lastWidth/2,Oe.firstWidth*1.2)}function Df(){is(Math.max(Oe.firstWidth,Oe.lastWidth)*1.5+Oe.firstWidth/2,0,0,Oe.lastWidth*1.2)}function If(){const t=document.querySelector("#c");t.height=window.innerHeight,t.width=window.innerWidth;const e=t.height/t.width;Dt.top=(Dt.right-Dt.left)*e/2,Dt.bottom=(Dt.right-Dt.left)*e/-2,Dt.updateProjectionMatrix(),$n.setSize(window.innerWidth,window.innerHeight,!1)}function I0(){const t=document.querySelector("#c");(window.innerWidth!==t.width||window.innerHeight!==t.height)&&If()}function Nf(){requestAnimationFrame(Nf),hi.update(),Of(),be&&D0()}function Of(){I0(),$n.render(rn,Dt)}$(document).ready(()=>{$(window).resize(If),$("#download").click(()=>{R0()}),$("#gif").click(()=>{hi.autoRotate=!1,hi.enabled=!1,$("#gif").prop("disabled",!0),$("#gif").prop("hidden",!0),$("#gifText").prop("hidden",!1),$("#gifText").text("Recording..."),$("#generate").prop("disabled",!0),P0()}),$("#generate").click(()=>{ci?(ci.terminate(),ci=void 0,$("#generate").text("Generate!")):Rf()}),$("#isoCam").click(()=>{za()}),$("#lastCam").click(()=>{Df()}),$("#firstCam").click(()=>{Pf()}),$("#rotate").change(()=>{console.log("Changed"),$("#rotate:checked").length>0?(console.log("Rotating"),hi.autoRotate=!0,hi.autoRotateSpeed=-4):(console.log("Not rotating"),hi.autoRotate=!1)})});C0();Nf()});export default N0();
